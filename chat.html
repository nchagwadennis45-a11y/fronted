<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kynecta - Advanced Mood-Based Chat</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-storage-compat.js"></script>
    
    <!-- Cloudinary -->
    <script src="https://upload-widget.cloudinary.com/global/all.js"></script>
    
    <style>
        :root {
            --kynecta-primary: #7C3AED;
            --kynecta-secondary: #10B981;
            --kynecta-accent: #F59E0B;
            --kynecta-dark: #1F2937;
            --kynecta-light: #F9FAFB;
            --kynecta-border: #E5E7EB;
        }

        [data-theme="dark"] {
            --kynecta-primary: #8B5CF6;
            --kynecta-secondary: #34D399;
            --kynecta-accent: #FBBF24;
            --kynecta-dark: #F9FAFB;
            --kynecta-light: #111827;
            --kynecta-border: #374151;
        }

        body {
            font-family: 'Inter', 'Segoe UI', system-ui, sans-serif;
            background-color: var(--kynecta-light);
            color: var(--kynecta-dark);
            height: 100vh;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .kynecta-header {
            background: linear-gradient(135deg, var(--kynecta-primary), var(--kynecta-secondary));
            color: white;
        }

        .message-sent {
            background: linear-gradient(135deg, var(--kynecta-primary), var(--kynecta-secondary));
            color: white;
            margin-left: auto;
            border-radius: 18px 18px 4px 18px;
        }

        .message-received {
            background-color: var(--kynecta-light);
            color: var(--kynecta-dark);
            border: 1px solid var(--kynecta-border);
            border-radius: 18px 18px 18px 4px;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }

        .tab-active {
            border-bottom: 3px solid var(--kynecta-primary);
            color: var(--kynecta-primary);
        }

        .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: transparent;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #cccccc;
            border-radius: 3px;
        }

        /* Toast Notifications */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 12px 20px;
            background: var(--kynecta-light);
            color: var(--kynecta-dark);
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 10000;
            transform: translateX(150%);
            transition: transform 0.3s ease;
            border-left: 4px solid var(--kynecta-primary);
        }
        .toast.show {
            transform: translateX(0);
        }
        .toast.error {
            border-left-color: #EF4444;
        }
        .toast.success {
            border-left-color: #10B981;
        }

        /* Typing Indicator */
        .typing-indicator {
            display: inline-flex;
            align-items: center;
            padding: 8px 12px;
            background: var(--kynecta-light);
            border-radius: 18px;
            font-size: 0.875rem;
            color: var(--kynecta-dark);
        }
        .typing-dots {
            display: flex;
            margin-left: 8px;
        }
        .typing-dot {
            width: 4px;
            height: 4px;
            border-radius: 50%;
            background-color: var(--kynecta-dark);
            margin: 0 1px;
            animation: typing 1.4s infinite ease-in-out;
        }
        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }

        @keyframes typing {
            0%, 80%, 100% { transform: scale(0); }
            40% { transform: scale(1); }
        }

        /* Dark mode improvements */
        [data-theme="dark"] .message-received {
            background-color: #374151;
            color: #F9FAFB;
        }

        [data-theme="dark"] .bg-white {
            background-color: #1F2937;
        }

        [data-theme="dark"] .bg-gray-50 {
            background-color: #374151;
        }

        [data-theme="dark"] .bg-gray-100 {
            background-color: #4B5563;
        }

        [data-theme="dark"] .text-gray-500 {
            color: #9CA3AF;
        }

        [data-theme="dark"] .text-gray-600 {
            color: #D1D5DB;
        }

        [data-theme="dark"] .border-gray-200 {
            border-color: #374151;
        }

        /* Animation classes */
        .fade-in {
            animation: fadeIn 0.3s ease-in;
        }

        .slide-up {
            animation: slideUp 0.3s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideUp {
            from { transform: translateY(10px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        /* New styles for enhanced functionality */
        .message-container {
            display: flex;
            margin-bottom: 16px;
            padding: 0 16px;
        }

        .message-container.sent {
            justify-content: flex-end;
        }

        .message-container.received {
            justify-content: flex-start;
        }

        .message-bubble {
            max-width: 70%;
            padding: 12px 16px;
            position: relative;
            word-wrap: break-word;
        }

        .message-time {
            font-size: 0.75rem;
            opacity: 0.7;
            margin-top: 4px;
            text-align: right;
        }

        .message-status {
            position: absolute;
            bottom: 4px;
            right: 8px;
            font-size: 0.75rem;
        }

        .date-separator {
            text-align: center;
            margin: 20px 0;
            position: relative;
        }

        .date-separator::before {
            content: "";
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 1px;
            background: var(--kynecta-border);
            z-index: 1;
        }

        .date-separator span {
            background: var(--kynecta-light);
            padding: 0 12px;
            position: relative;
            z-index: 2;
            color: var(--kynecta-dark);
            font-size: 0.875rem;
        }

        .scroll-to-bottom {
            position: absolute;
            bottom: 80px;
            right: 20px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--kynecta-primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            z-index: 10;
            transition: all 0.3s;
        }

        .scroll-to-bottom:hover {
            transform: scale(1.1);
        }

        .upload-progress {
            width: 100%;
            height: 4px;
            background: #e5e7eb;
            border-radius: 2px;
            overflow: hidden;
            margin-top: 8px;
        }

        .upload-progress-bar {
            height: 100%;
            background: var(--kynecta-primary);
            transition: width 0.3s;
        }

        .media-preview {
            max-width: 200px;
            border-radius: 12px;
            margin-top: 8px;
        }

        .online-indicator {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #10B981;
            position: absolute;
            bottom: 0;
            right: 0;
            border: 2px solid white;
        }

        .contact-item {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            cursor: pointer;
            transition: background 0.2s;
            border-bottom: 1px solid var(--kynecta-border);
        }

        .contact-item:hover {
            background: var(--kynecta-border);
        }

        .contact-item.active {
            background: rgba(124, 58, 237, 0.1);
        }

        .contact-avatar {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            margin-right: 12px;
            position: relative;
        }

        .contact-info {
            flex: 1;
        }

        .contact-name {
            font-weight: 600;
            margin-bottom: 4px;
        }

        .contact-status {
            font-size: 0.875rem;
            color: #6B7280;
        }

        .last-seen {
            font-size: 0.75rem;
            color: #9CA3AF;
        }

        /* Settings specific styles */
        .settings-section {
            padding: 16px;
            border-bottom: 1px solid var(--kynecta-border);
        }

        .settings-section:last-child {
            border-bottom: none;
        }

        .settings-item {
            display: flex;
            justify-content: between;
            align-items: center;
            padding: 12px 0;
            cursor: pointer;
        }

        .settings-item:not(:last-child) {
            border-bottom: 1px solid var(--kynecta-border);
        }

        .settings-item-content {
            flex: 1;
        }

        .settings-item-title {
            font-weight: 500;
            margin-bottom: 4px;
        }

        .settings-item-description {
            font-size: 0.875rem;
            color: #6B7280;
        }

        .settings-item-action {
            color: #6B7280;
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 44px;
            height: 24px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 24px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .toggle-slider {
            background-color: var(--kynecta-primary);
        }

        input:checked + .toggle-slider:before {
            transform: translateX(20px);
        }

        /* Status ring */
        .status-ring {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: conic-gradient(from 0deg, var(--kynecta-secondary) 0%, var(--kynecta-secondary) var(--progress, 0%), #E5E5E5 var(--progress, 0%), #E5E5E5 100%);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .status-ring-inner {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: var(--kynecta-light);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Video call container */
        .video-call-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            z-index: 1000;
            display: none;
        }
        .local-video {
            position: absolute;
            bottom: 20px;
            right: 20px;
            width: 200px;
            height: 150px;
            border: 2px solid var(--kynecta-primary);
            border-radius: 10px;
        }
        .remote-video {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .call-controls {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 15px;
        }
        .call-btn {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.3s;
        }
        .call-end {
            background: #EF4444;
            color: white;
        }
        .call-mute {
            background: #6B7280;
            color: white;
        }
        .call-video {
            background: var(--kynecta-primary);
            color: white;
        }

        /* Mood-based backgrounds */
        .mood-happy { 
            background: linear-gradient(135deg, #FFFBEB, #FEF3C7);
            border-left: 4px solid var(--kynecta-accent);
        }
        .mood-calm { 
            background: linear-gradient(135deg, #EFF6FF, #DBEAFE);
            border-left: 4px solid #3B82F6;
        }
        .mood-energetic { 
            background: linear-gradient(135deg, #FEF2F2, #FECACA);
            border-left: 4px solid #EF4444;
        }
        .mood-focused { 
            background: linear-gradient(135deg, #F0FDF4, #DCFCE7);
            border-left: 4px solid #16A34A;
        }
        .mood-creative { 
            background: linear-gradient(135deg, #FAF5FF, #E9D5FF);
            border-left: 4px solid var(--kynecta-primary);
        }

        .mood-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 5px;
        }
        .mood-happy-indicator { background-color: var(--kynecta-accent); }
        .mood-calm-indicator { background-color: #3B82F6; }
        .mood-energetic-indicator { background-color: #EF4444; }
        .mood-focused-indicator { background-color: #16A34A; }
        .mood-creative-indicator { background-color: var(--kynecta-primary); }

        /* Reaction picker */
        .reaction-picker {
            position: absolute;
            bottom: 100%;
            left: 0;
            background: var(--kynecta-light);
            border: 1px solid var(--kynecta-border);
            border-radius: 24px;
            padding: 8px;
            display: flex;
            gap: 4px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 100;
        }

        .reaction-option {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 1.2rem;
        }

        .reaction-option:hover {
            transform: scale(1.2);
            background: var(--kynecta-border);
        }

        /* Status creation styles */
        .status-creation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            display: none;
            align-items: center;
            justify-content: center;
        }

        .status-creation-content {
            background: white;
            border-radius: 16px;
            width: 90%;
            max-width: 500px;
            max-height: 80vh;
            overflow: hidden;
        }

        .status-options {
            display: flex;
            padding: 16px;
            gap: 16px;
            border-bottom: 1px solid #e5e7eb;
        }

        .status-option {
            flex: 1;
            text-align: center;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .status-option.active {
            background: #f3f4f6;
            color: var(--kynecta-primary);
        }

        .status-preview {
            padding: 20px;
            text-align: center;
            min-height: 300px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .status-emoji-input {
            font-size: 3rem;
            margin-bottom: 20px;
        }

        .status-media-preview {
            max-width: 100%;
            max-height: 300px;
            border-radius: 12px;
        }

        .status-text-input {
            width: 100%;
            padding: 12px;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            font-size: 1rem;
            margin-bottom: 16px;
        }

        .status-audio-preview {
            width: 100%;
            margin-bottom: 16px;
        }

        .status-video-preview {
            width: 100%;
            max-height: 300px;
            border-radius: 12px;
            margin-bottom: 16px;
        }

        /* Profile photo and cover upload */
        .profile-upload {
            position: relative;
            display: inline-block;
        }

        .profile-upload input {
            position: absolute;
            left: 0;
            top: 0;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }

        .profile-cover {
            height: 200px;
            background: linear-gradient(135deg, var(--kynecta-primary), var(--kynecta-secondary));
            position: relative;
            border-radius: 16px 16px 0 0;
        }

        .profile-cover-edit {
            position: absolute;
            bottom: 16px;
            right: 16px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 8px 12px;
            border-radius: 20px;
            cursor: pointer;
        }

        .profile-photo-edit {
            position: absolute;
            bottom: 8px;
            right: 8px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 6px;
            border-radius: 50%;
            cursor: pointer;
        }

        /* Color picker for notification light */
        .color-picker {
            display: flex;
            gap: 8px;
            margin-top: 8px;
        }

        .color-option {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid transparent;
        }

        .color-option.active {
            border-color: var(--kynecta-dark);
        }

        /* Video conference styles */
        .video-conference {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            z-index: 1000;
            display: none;
        }

        .conference-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 10px;
            padding: 20px;
            height: calc(100% - 80px);
        }

        .participant-video {
            background: #333;
            border-radius: 8px;
            position: relative;
        }

        .participant-name {
            position: absolute;
            bottom: 8px;
            left: 8px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.875rem;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .chat-list-container {
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                z-index: 20;
                transition: transform 0.3s;
            }

            .chat-list-container.hidden {
                transform: translateX(-100%);
            }

            .chat-area {
                width: 100%;
            }

            .message-bubble {
                max-width: 85%;
            }
        }

        @media (min-width: 769px) {
            .mobile-only {
                display: none;
            }
        }
    </style>
</head>
<body class="h-full overflow-hidden" data-theme="light">
    <!-- Toast Notifications -->
    <div id="toastContainer"></div>

    <!-- Loading Screen -->
    <div id="loadingScreen" class="fixed inset-0 bg-white z-50 flex items-center justify-center">
        <div class="text-center">
            <div class="w-16 h-16 bg-gradient-to-r from-purple-500 to-green-500 rounded-2xl flex items-center justify-center mx-auto mb-4 animate-pulse">
                <span class="text-white text-2xl">ðŸ§ </span>
            </div>
            <h2 class="text-xl font-semibold text-gray-700 mb-2">Kynecta</h2>
            <p class="text-gray-500">Initializing mood-aware chat...</p>
        </div>
    </div>

    <!-- Main Chat App -->
    <div id="chatApp" class="hidden h-full">
        <!-- Bottom Navigation Tabs -->
        <div class="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 flex justify-around py-3 z-30 md:hidden shadow-lg">
            <button class="tab-btn flex flex-col items-center text-purple-600 tab-active" data-tab="chats">
                <i class="fas fa-comments text-xl"></i>
                <span class="text-xs mt-1">Chats</span>
            </button>
            <button class="tab-btn flex flex-col items-center text-gray-500" data-tab="contacts">
                <i class="fas fa-user-friends text-xl"></i>
                <span class="text-xs mt-1">Contacts</span>
            </button>
            <button class="tab-btn flex flex-col items-center text-gray-500" data-tab="updates">
                <i class="fas fa-bell text-xl"></i>
                <span class="text-xs mt-1">Updates</span>
            </button>
            <button class="tab-btn flex flex-col items-center text-gray-500" data-tab="calls">
                <i class="fas fa-phone text-xl"></i>
                <span class="text-xs mt-1">Calls</span>
            </button>
            <button class="tab-btn flex flex-col items-center text-gray-500" data-tab="tools">
                <i class="fas fa-tools text-xl"></i>
                <span class="text-xs mt-1">Tools</span>
            </button>
        </div>

        <div class="flex h-full pb-16 md:pb-0">
            <!-- Sidebar/Contact List -->
            <div id="chatListContainer" class="chat-list-container w-full md:w-1/3 lg:w-1/4 bg-white flex flex-col border-r border-gray-200">
                <!-- User Profile Header -->
                <div class="kynecta-header p-4 flex justify-between items-center">
                    <div class="flex items-center">
                        <img id="userAvatar" class="w-12 h-12 rounded-2xl bg-white/20 flex items-center justify-center text-white font-semibold mr-3 object-cover border-2 border-white/30" src="" alt="Profile">
                        <div>
                            <span id="userName" class="font-semibold text-white block">Loading...</span>
                            <span id="userMood" class="text-white/80 text-sm">ðŸŸ¢ Online</span>
                        </div>
                    </div>
                    <div class="flex space-x-3 text-white">
                        <i class="fas fa-users text-xl cursor-pointer hover:scale-110 transition-transform" id="newGroupBtn"></i>
                        <i class="fas fa-cog text-xl cursor-pointer hover:scale-110 transition-transform" id="menuBtn"></i>
                        <button id="themeToggle" class="text-xl cursor-pointer hover:scale-110 transition-transform">
                            <i class="fas fa-moon" id="themeIcon"></i>
                        </button>
                    </div>
                </div>

                <!-- Tabs for Desktop -->
                <div class="hidden md:flex bg-white border-b border-gray-200">
                    <button class="tab-btn flex-1 py-4 text-center text-purple-600 tab-active font-semibold" data-tab="chats">
                        <i class="fas fa-comments mr-2"></i>Chats
                    </button>
                    <button class="tab-btn flex-1 py-4 text-center text-gray-500 font-semibold" data-tab="contacts">
                        <i class="fas fa-user-friends mr-2"></i>Contacts
                    </button>
                    <button class="tab-btn flex-1 py-4 text-center text-gray-500 font-semibold" data-tab="updates">
                        <i class="fas fa-bell mr-2"></i>Updates
                    </button>
                    <button class="tab-btn flex-1 py-4 text-center text-gray-500 font-semibold" data-tab="calls">
                        <i class="fas fa-phone mr-2"></i>Calls
                    </button>
                    <button class="tab-btn flex-1 py-4 text-center text-gray-500 font-semibold" data-tab="tools">
                        <i class="fas fa-tools mr-2"></i>Tools
                    </button>
                </div>

                <!-- Search -->
                <div class="bg-white p-3">
                    <div class="relative">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <i class="fas fa-search text-gray-400"></i>
                        </div>
                        <input type="text" id="searchInput" class="w-full bg-gray-100 rounded-xl py-3 pl-10 pr-4 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:bg-white transition-all" placeholder="Search connections...">
                    </div>
                </div>

                <!-- Tab Content -->
                <div id="tabContent" class="flex-1 overflow-y-auto custom-scrollbar">
                    <!-- Chats Tab -->
                    <div id="chatsTab" class="tab-panel active">
                        <div id="chatList">
                            <div id="noChatsMessage" class="p-8 text-center text-gray-500">
                                <i class="fas fa-comments text-4xl mb-3 text-gray-300 block"></i>
                                <p>No conversations yet</p>
                                <p class="text-sm mt-1">Start a conversation to begin</p>
                            </div>
                        </div>
                    </div>

                    <!-- Contacts Tab -->
                    <div id="contactsTab" class="tab-panel hidden">
                        <div class="p-4">
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="font-semibold text-lg">Contacts</h3>
                                <button id="addContactBtn" class="bg-purple-600 text-white px-4 py-2 rounded-xl hover:bg-purple-700 transition-colors">
                                    <i class="fas fa-user-plus mr-2"></i>Add Contact
                                </button>
                            </div>
                            
                            <div class="mb-4">
                                <div class="relative">
                                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                        <i class="fas fa-search text-gray-400"></i>
                                    </div>
                                    <input type="text" id="contactSearch" class="w-full bg-gray-100 rounded-xl py-3 pl-10 pr-4 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:bg-white transition-all" placeholder="Search contacts by name, email, or phone...">
                                </div>
                            </div>
                            
                            <div id="contactsList" class="space-y-2">
                                <!-- Contacts will be populated here -->
                            </div>
                            
                            <div id="noContactsMessage" class="p-8 text-center text-gray-500">
                                <i class="fas fa-user-friends text-4xl mb-3 text-gray-300 block"></i>
                                <p>No contacts yet</p>
                                <p class="text-sm mt-1">Add contacts to start messaging</p>
                            </div>
                        </div>
                    </div>

                    <!-- Updates Tab -->
                    <div id="updatesTab" class="tab-panel hidden">
                        <div class="p-4">
                            <div class="flex items-center space-x-4 mb-6 cursor-pointer p-3 rounded-2xl hover:bg-gray-50 transition-colors" id="myStatus">
                                <div class="status-ring" style="--progress: 0%">
                                    <div class="status-ring-inner">
                                        <i class="fas fa-plus text-green-500 text-xl"></i>
                                    </div>
                                </div>
                                <div>
                                    <p class="font-semibold">My Status</p>
                                    <p class="text-sm text-gray-500">Tap to share update</p>
                                </div>
                            </div>

                            <h3 class="text-sm font-semibold text-gray-500 mb-3 px-3">Recent Updates</h3>
                            <div id="statusUpdates" class="space-y-3">
                                <!-- Status updates will be populated here -->
                            </div>
                        </div>
                    </div>

                    <!-- Calls Tab -->
                    <div id="callsTab" class="tab-panel hidden">
                        <div class="p-4">
                            <!-- Favorites Section -->
                            <div class="mb-6">
                                <div class="flex justify-between items-center mb-3">
                                    <h3 class="font-semibold">Favorites</h3>
                                    <button class="text-purple-600 text-sm font-semibold" id="manageFavorites">Manage</button>
                                </div>
                                <div id="favoritesList" class="space-y-3">
                                    <div class="flex items-center space-x-3 p-3 rounded-xl bg-gray-50">
                                        <div class="w-12 h-12 rounded-full bg-gradient-to-r from-purple-500 to-pink-500 flex items-center justify-center text-white">
                                            <i class="fas fa-users"></i>
                                        </div>
                                        <div class="flex-1">
                                            <p class="font-medium">Group</p>
                                            <p class="text-sm text-gray-500">Add favorite</p>
                                        </div>
                                        <button class="text-purple-600">
                                            <i class="fas fa-plus"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- Recent Calls -->
                            <h3 class="font-semibold mb-3">Recent Calls</h3>
                            <div id="recentCalls" class="space-y-4">
                                <!-- Recent calls will be populated here -->
                            </div>
                        </div>
                    </div>

                    <!-- Tools Tab -->
                    <div id="toolsTab" class="tab-panel hidden">
                        <div class="p-4 space-y-4">
                            <!-- Mood Settings -->
                            <div class="bg-white rounded-2xl p-4 shadow-sm border border-gray-200">
                                <h3 class="font-semibold mb-3 flex items-center">
                                    <i class="fas fa-smile mr-2 text-purple-500"></i>
                                    Current Mood
                                </h3>
                                <div class="flex flex-wrap gap-2 mb-3">
                                    <button class="mood-option px-3 py-2 rounded-full text-sm border-2 border-gray-200 hover:border-purple-300 transition-colors" data-mood="happy">ðŸ˜Š Happy</button>
                                    <button class="mood-option px-3 py-2 rounded-full text-sm border-2 border-gray-200 hover:border-blue-300 transition-colors" data-mood="calm">ðŸ˜Œ Calm</button>
                                    <button class="mood-option px-3 py-2 rounded-full text-sm border-2 border-gray-200 hover:border-red-300 transition-colors" data-mood="energetic">âš¡ Energetic</button>
                                    <button class="mood-option px-3 py-2 rounded-full text-sm border-2 border-gray-200 hover:border-green-300 transition-colors" data-mood="focused">ðŸŽ¯ Focused</button>
                                    <button class="mood-option px-3 py-2 rounded-full text-sm border-2 border-gray-200 hover:border-purple-300 transition-colors" data-mood="creative">ðŸŽ¨ Creative</button>
                                </div>
                                <p class="text-xs text-gray-500">Your mood influences chat suggestions and themes</p>
                            </div>

                            <!-- Quick Actions -->
                            <div class="bg-white rounded-2xl p-4 shadow-sm border border-gray-200">
                                <h3 class="font-semibold mb-3">Quick Actions</h3>
                                <div class="grid grid-cols-2 gap-3">
                                    <button class="p-4 bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl text-center hover:shadow-md transition-all" id="privacyBtn">
                                        <i class="fas fa-shield-alt text-2xl mb-2 block text-purple-600"></i>
                                        <p class="text-sm font-medium">Privacy</p>
                                    </button>
                                    <button class="p-4 bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl text-center hover:shadow-md transition-all" id="settingsBtn">
                                        <i class="fas fa-cog text-2xl mb-2 block text-blue-600"></i>
                                        <p class="text-sm font-medium">Settings</p>
                                    </button>
                                    <button class="p-4 bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl text-center hover:shadow-md transition-all" id="storageBtn">
                                        <i class="fas fa-database text-2xl mb-2 block text-gray-600"></i>
                                        <p class="text-sm font-medium">Storage</p>
                                    </button>
                                    <button class="p-4 bg-gradient-to-br from-orange-50 to-orange-100 rounded-xl text-center hover:shadow-md transition-all" id="inviteBtn">
                                        <i class="fas fa-user-plus text-2xl mb-2 block text-orange-600"></i>
                                        <p class="text-sm font-medium">Invite</p>
                                    </button>
                                </div>
                            </div>

                            <!-- Business Tools -->
                            <div class="bg-white rounded-2xl p-4 shadow-sm border border-gray-200">
                                <h3 class="font-semibold mb-3 flex items-center">
                                    <i class="fas fa-briefcase mr-2 text-purple-500"></i>
                                    Business Tools
                                </h3>
                                <div class="space-y-3">
                                    <button class="w-full p-3 bg-gradient-to-r from-purple-50 to-blue-50 rounded-xl text-left hover:shadow-md transition-all flex items-center justify-between" id="catalogueBtn">
                                        <div>
                                            <p class="font-medium text-purple-700">Catalogue</p>
                                            <p class="text-sm text-purple-600">Manage your product catalogue</p>
                                        </div>
                                        <i class="fas fa-shopping-cart text-purple-500"></i>
                                    </button>
                                    <button class="w-full p-3 bg-gradient-to-r from-green-50 to-teal-50 rounded-xl text-left hover:shadow-md transition-all flex items-center justify-between" id="advertiseBtn">
                                        <div>
                                            <p class="font-medium text-green-700">Advertise</p>
                                            <p class="text-sm text-green-600">Create and manage ads</p>
                                        </div>
                                        <i class="fas fa-bullhorn text-green-500"></i>
                                    </button>
                                    <button class="w-full p-3 bg-gradient-to-r from-orange-50 to-amber-50 rounded-xl text-left hover:shadow-md transition-all flex items-center justify-between" id="labelsBtn">
                                        <div>
                                            <p class="font-medium text-orange-700">Labels</p>
                                            <p class="text-sm text-orange-600">Organize with labels</p>
                                        </div>
                                        <i class="fas fa-tags text-orange-500"></i>
                                    </button>
                                    <button class="w-full p-3 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl text-left hover:shadow-md transition-all flex items-center justify-between" id="greetingBtn">
                                        <div>
                                            <p class="font-medium text-blue-700">Greeting Message</p>
                                            <p class="text-sm text-blue-600">Set up welcome messages</p>
                                        </div>
                                        <i class="fas fa-comment-dots text-blue-500"></i>
                                    </button>
                                    <button class="w-full p-3 bg-gradient-to-r from-red-50 to-pink-50 rounded-xl text-left hover:shadow-md transition-all flex items-center justify-between" id="awayBtn">
                                        <div>
                                            <p class="font-medium text-red-700">Away Message</p>
                                            <p class="text-sm text-red-600">Set up away messages</p>
                                        </div>
                                        <i class="fas fa-clock text-red-500"></i>
                                    </button>
                                </div>
                            </div>

                            <!-- AI Features -->
                            <div class="bg-white rounded-2xl p-4 shadow-sm border border-gray-200">
                                <h3 class="font-semibold mb-3 flex items-center">
                                    <i class="fas fa-robot mr-2 text-purple-500"></i>
                                    AI Assistant
                                </h3>
                                <div class="space-y-3">
                                    <button class="w-full p-3 bg-gradient-to-r from-purple-50 to-blue-50 rounded-xl text-left hover:shadow-md transition-all flex items-center justify-between" id="aiSummarize">
                                        <div>
                                            <p class="font-medium text-purple-700">Summarize Conversation</p>
                                            <p class="text-sm text-purple-600">Get AI summary of recent messages</p>
                                        </div>
                                        <i class="fas fa-sparkles text-purple-500"></i>
                                    </button>
                                    <button class="w-full p-3 bg-gradient-to-r from-green-50 to-teal-50 rounded-xl text-left hover:shadow-md transition-all flex items-center justify-between" id="aiReply">
                                        <div>
                                            <p class="font-medium text-green-700">Smart Reply Suggestions</p>
                                            <p class="text-sm text-green-600">Get context-aware reply ideas</p>
                                        </div>
                                        <i class="fas fa-lightbulb text-green-500"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Chat Area -->
            <div class="chat-area flex-1 flex flex-col bg-gray-50">
                <!-- Chat Header -->
                <div id="chatHeader" class="kynecta-header p-4 flex justify-between items-center hidden">
                    <div class="flex items-center">
                        <div class="mobile-only mr-3">
                            <i class="fas fa-arrow-left text-white cursor-pointer hover:scale-110 transition-transform" id="backToChats"></i>
                        </div>
                        <img id="chatAvatar" class="w-12 h-12 rounded-2xl bg-white/20 flex items-center justify-center text-white font-semibold mr-3 object-cover border-2 border-white/30" src="" alt="Chat">
                        <div>
                            <h3 id="chatTitle" class="font-semibold text-white">Select a chat</h3>
                            <p id="chatStatus" class="text-white/80 text-sm flex items-center">
                                <span id="moodIndicator" class="mood-indicator mood-happy-indicator"></span>
                                <span id="statusText">Choose a conversation</span>
                                <span id="typingIndicator" class="typing-indicator hidden ml-2">
                                    typing
                                    <div class="typing-dots">
                                        <div class="typing-dot"></div>
                                        <div class="typing-dot"></div>
                                        <div class="typing-dot"></div>
                                    </div>
                                </span>
                            </p>
                        </div>
                    </div>
                    <div class="flex space-x-3 text-white">
                        <i class="fas fa-video text-xl cursor-pointer hover:scale-110 transition-transform" id="videoCallBtn"></i>
                        <i class="fas fa-phone text-xl cursor-pointer hover:scale-110 transition-transform" id="voiceCallBtn"></i>
                        <i class="fas fa-ellipsis-v text-xl cursor-pointer hover:scale-110 transition-transform" id="chatMenuBtn"></i>
                    </div>
                </div>

                <!-- Messages Area -->
                <div id="messagesContainer" class="flex-1 overflow-y-auto p-4 custom-scrollbar relative">
                    <div id="noMessagesMessage" class="text-center text-gray-500 py-10">
                        <i class="fas fa-comments text-4xl mb-3 text-gray-300 block"></i>
                        <p>No messages yet</p>
                        <p class="text-sm mt-1">Select a chat to start messaging</p>
                    </div>
                    <!-- Messages will be populated from Firebase -->
                    <div id="scrollToBottom" class="scroll-to-bottom hidden">
                        <i class="fas fa-chevron-down"></i>
                    </div>
                </div>

                <!-- Mood Suggestion -->
                <div id="moodSuggestion" class="hidden mx-4 mb-2 p-4 rounded-2xl bg-gradient-to-r from-purple-50 to-blue-50 border border-purple-200">
                    <div class="flex justify-between items-start">
                        <div>
                            <p class="text-sm font-semibold text-purple-800 flex items-center">
                                <i class="fas fa-smile mr-2"></i>
                                Mood-based Suggestion
                            </p>
                            <p id="suggestionText" class="text-sm text-purple-600 mt-1"></p>
                        </div>
                        <button id="dismissSuggestion" class="text-purple-400 hover:text-purple-600 transition-colors">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>

                <!-- Input Area -->
                <div id="inputArea" class="bg-white p-4 border-t border-gray-200 hidden">
                    <div class="flex items-center">
                        <div class="flex space-x-2 mr-3">
                            <button class="w-12 h-12 rounded-2xl flex items-center justify-center text-gray-500 hover:bg-purple-50 hover:text-purple-600 transition-all" id="attachBtn">
                                <i class="fas fa-plus"></i>
                            </button>
                            <button class="w-12 h-12 rounded-2xl flex items-center justify-center text-gray-500 hover:bg-purple-50 hover:text-purple-600 transition-all" id="cameraBtn">
                                <i class="fas fa-camera"></i>
                            </button>
                            <button class="w-12 h-12 rounded-2xl flex items-center justify-center text-gray-500 hover:bg-purple-50 hover:text-purple-600 transition-all" id="moodBtn">
                                <i class="fas fa-smile"></i>
                            </button>
                        </div>
                        <div class="flex-1 relative">
                            <input type="text" id="messageInput" class="w-full bg-gray-100 py-3 px-4 rounded-2xl focus:outline-none focus:ring-2 focus:ring-purple-500 focus:bg-white transition-all" placeholder="Type a message..." disabled>
                            <!-- Typing Indicator -->
                            <div id="isTyping" class="absolute -top-6 left-0 text-xs text-gray-500 hidden">
                                <span id="typingUsers"></span> is typing...
                            </div>
                        </div>
                        <div class="ml-3">
                            <button id="sendBtn" class="w-12 h-12 bg-gradient-to-r from-purple-500 to-green-500 text-white rounded-2xl flex items-center justify-center hover:opacity-90 transition-all shadow-lg" disabled>
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </div>
                    </div>

                    <!-- File Preview -->
                    <div id="filePreview" class="hidden mt-3 p-3 bg-gray-100 rounded-xl">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center">
                                <i class="fas fa-file text-gray-600 mr-3"></i>
                                <div>
                                    <p id="fileName" class="font-medium"></p>
                                    <p id="fileSize" class="text-sm text-gray-500"></p>
                                </div>
                            </div>
                            <div class="upload-progress">
                                <div id="uploadProgressBar" class="upload-progress-bar" style="width: 0%"></div>
                            </div>
                            <button id="removeFile" class="text-gray-500 hover:text-gray-700 ml-3">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Video Conference -->
    <div class="video-conference" id="videoConference">
        <div class="conference-grid" id="conferenceGrid">
            <!-- Participant videos will be added here -->
        </div>
        <div class="call-controls">
            <button class="call-btn call-mute" id="conferenceMuteBtn">
                <i class="fas fa-microphone"></i>
            </button>
            <button class="call-btn call-video" id="conferenceVideoBtn">
                <i class="fas fa-video"></i>
            </button>
            <button class="call-btn call-end" id="conferenceEndBtn">
                <i class="fas fa-phone"></i>
            </button>
        </div>
    </div>

    <!-- Video Call Container -->
    <div class="video-call-container" id="videoCallContainer">
        <video class="remote-video" id="remoteVideo" autoplay></video>
        <video class="local-video" id="localVideo" autoplay muted></video>
        <div class="call-controls">
            <button class="call-btn call-mute" id="muteBtn">
                <i class="fas fa-microphone"></i>
            </button>
            <button class="call-btn call-video" id="videoToggleBtn">
                <i class="fas fa-video"></i>
            </button>
            <button class="call-btn call-end" id="endCallBtn">
                <i class="fas fa-phone"></i>
            </button>
        </div>
    </div>

    <!-- Status Creation Modal -->
    <div id="statusCreation" class="status-creation">
        <div class="status-creation-content">
            <div class="kynecta-header p-4">
                <div class="flex items-center justify-between">
                    <h3 class="text-xl font-semibold text-white">Create Status Update</h3>
                    <button id="closeStatusCreation" class="text-white/80 hover:text-white transition-colors">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
            </div>
            
            <div class="status-options">
                <div class="status-option active" data-type="emoji">
                    <i class="fas fa-smile text-xl mb-2"></i>
                    <p>Emoji</p>
                </div>
                <div class="status-option" data-type="text">
                    <i class="fas fa-font text-xl mb-2"></i>
                    <p>Text</p>
                </div>
                <div class="status-option" data-type="image">
                    <i class="fas fa-image text-xl mb-2"></i>
                    <p>Image</p>
                </div>
                <div class="status-option" data-type="video">
                    <i class="fas fa-video text-xl mb-2"></i>
                    <p>Video</p>
                </div>
                <div class="status-option" data-type="audio">
                    <i class="fas fa-music text-xl mb-2"></i>
                    <p>Audio</p>
                </div>
            </div>
            
            <div class="status-preview">
                <div id="emojiPreview" class="status-emoji-input" contenteditable="true">ðŸ˜Š</div>
                <div id="textPreview" class="hidden">
                    <textarea id="statusTextInput" class="status-text-input" placeholder="What's on your mind?"></textarea>
                </div>
                <div id="imagePreview" class="hidden">
                    <img id="statusImagePreview" class="status-media-preview hidden" alt="Status image preview">
                    <button id="uploadImageBtn" class="bg-purple-600 text-white px-4 py-2 rounded-xl hover:bg-purple-700 transition-colors">
                        <i class="fas fa-upload mr-2"></i>Upload Image
                    </button>
                </div>
                <div id="videoPreview" class="hidden">
                    <video id="statusVideoPreview" class="status-video-preview hidden" controls></video>
                    <button id="uploadVideoBtn" class="bg-purple-600 text-white px-4 py-2 rounded-xl hover:bg-purple-700 transition-colors">
                        <i class="fas fa-upload mr-2"></i>Upload Video (6s max)
                    </button>
                </div>
                <div id="audioPreview" class="hidden">
                    <audio id="statusAudioPreview" class="status-audio-preview hidden" controls></audio>
                    <button id="uploadAudioBtn" class="bg-purple-600 text-white px-4 py-2 rounded-xl hover:bg-purple-700 transition-colors">
                        <i class="fas fa-upload mr-2"></i>Upload Audio (6s max)
                    </button>
                </div>
            </div>
            
            <div class="p-4 border-t border-gray-200">
                <button id="postStatus" class="w-full py-3 bg-gradient-to-r from-purple-500 to-green-500 text-white rounded-xl font-semibold hover:opacity-90 transition-opacity">
                    Post Status
                </button>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl w-full max-w-md max-h-[90vh] overflow-hidden">
            <div class="kynecta-header p-6">
                <div class="flex items-center justify-between">
                    <h3 class="text-xl font-semibold text-white">Settings</h3>
                    <button id="closeSettings" class="text-white/80 hover:text-white transition-colors">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
            </div>
            
            <div class="overflow-y-auto max-h-[60vh] custom-scrollbar">
                <!-- Profile Section -->
                <div class="p-6 border-b border-gray-200">
                    <div class="flex items-center space-x-4 mb-4">
                        <div class="w-16 h-16 rounded-full bg-gradient-to-r from-purple-500 to-green-500 flex items-center justify-center text-white text-xl font-bold">
                            DC
                        </div>
                        <div>
                            <h4 class="font-semibold text-lg">Denis Chacha</h4>
                            <p class="text-gray-500 text-sm">Life without Christ is motion without meaning</p>
                        </div>
                    </div>
                    
                    <div class="settings-item">
                        <div class="settings-item-content">
                            <div class="settings-item-title">k</div>
                            <div class="settings-item-description">Show that your profile is verified</div>
                        </div>
                        <div class="settings-item-action">
                            <i class="fas fa-chevron-right text-gray-400"></i>
                        </div>
                    </div>
                </div>

                <!-- Account Section -->
                <div class="settings-section">
                    <h4 class="font-semibold mb-4 text-lg text-gray-800">Account</h4>
                    <div class="space-y-1">
                        <div class="settings-item" id="securitySettingsBtn">
                            <div class="settings-item-content">
                                <div class="settings-item-title">Security notifications</div>
                                <div class="settings-item-description">Passkeys, two-step verification</div>
                            </div>
                            <div class="settings-item-action">
                                <i class="fas fa-chevron-right text-gray-400"></i>
                            </div>
                        </div>
                        
                        <div class="settings-item" id="privacySettingsBtn">
                            <div class="settings-item-content">
                                <div class="settings-item-title">Privacy</div>
                                <div class="settings-item-description">Block contacts, disappearing messages</div>
                            </div>
                            <div class="settings-item-action">
                                <i class="fas fa-chevron-right text-gray-400"></i>
                            </div>
                        </div>
                        
                        <div class="settings-item" id="avatarSettingsBtn">
                            <div class="settings-item-content">
                                <div class="settings-item-title">Avatar</div>
                                <div class="settings-item-description">Create, edit, profile photo</div>
                            </div>
                            <div class="settings-item-action">
                                <i class="fas fa-chevron-right text-gray-400"></i>
                            </div>
                        </div>
                        
                        <div class="settings-item" id="favoritesSettingsBtn">
                            <div class="settings-item-content">
                                <div class="settings-item-title">Favorites</div>
                                <div class="settings-item-description">Add, reorder, remove</div>
                            </div>
                            <div class="settings-item-action">
                                <i class="fas fa-chevron-right text-gray-400"></i>
                            </div>
                        </div>
                        
                        <div class="settings-item" id="accessibilityBtn">
                            <div class="settings-item-content">
                                <div class="settings-item-title">Accessibility</div>
                                <div class="settings-item-description">Customize for your needs</div>
                            </div>
                            <div class="settings-item-action">
                                <i class="fas fa-chevron-right text-gray-400"></i>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Notifications Section -->
                <div class="settings-section">
                    <h4 class="font-semibold mb-4 text-lg text-gray-800">Notifications</h4>
                    <div class="space-y-1">
                        <div class="settings-item" id="notificationsSettingsBtn">
                            <div class="settings-item-content">
                                <div class="settings-item-title">Notification Settings</div>
                                <div class="settings-item-description">Customize message, group & call notifications</div>
                            </div>
                            <div class="settings-item-action">
                                <i class="fas fa-chevron-right text-gray-400"></i>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Storage & Data Section -->
                <div class="settings-section">
                    <h4 class="font-semibold mb-4 text-lg text-gray-800">Storage & Data</h4>
                    <div class="space-y-1">
                        <div class="settings-item" id="storageSettingsBtn">
                            <div class="settings-item-content">
                                <div class="settings-item-title">Storage and data</div>
                                <div class="settings-item-description">Network usage, auto-download</div>
                            </div>
                            <div class="settings-item-action">
                                <i class="fas fa-chevron-right text-gray-400"></i>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- App Language Section -->
                <div class="settings-section">
                    <h4 class="font-semibold mb-4 text-lg text-gray-800">App Language</h4>
                    <div class="space-y-1">
                        <div class="settings-item" id="languageSettingsBtn">
                            <div class="settings-item-content">
                                <div class="settings-item-title">Language</div>
                                <div class="settings-item-description">Choose your preferred language</div>
                            </div>
                            <div class="settings-item-action">
                                <i class="fas fa-chevron-right text-gray-400"></i>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Chats Section -->
                <div class="settings-section">
                    <h4 class="font-semibold mb-4 text-lg text-gray-800">Chats</h4>
                    <div class="space-y-1">
                        <div class="settings-item" id="chatsSettingsBtn">
                            <div class="settings-item-content">
                                <div class="settings-item-title">Chat settings</div>
                                <div class="settings-item-description">Theme, wallpapers, chat history</div>
                            </div>
                            <div class="settings-item-action">
                                <i class="fas fa-chevron-right text-gray-400"></i>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Help Section -->
                <div class="settings-section">
                    <h4 class="font-semibold mb-4 text-lg text-gray-800">Help & Support</h4>
                    <div class="space-y-1">
                        <div class="settings-item" id="helpCenterBtn">
                            <div class="settings-item-content">
                                <div class="settings-item-title">Help Center</div>
                                <div class="settings-item-description">Get help and tutorials</div>
                            </div>
                            <div class="settings-item-action">
                                <i class="fas fa-chevron-right text-gray-400"></i>
                            </div>
                        </div>
                        
                        <div class="settings-item" id="contactUsBtn">
                            <div class="settings-item-content">
                                <div class="settings-item-title">Contact Us</div>
                                <div class="settings-item-description">Reach out for support</div>
                            </div>
                            <div class="settings-item-action">
                                <i class="fas fa-chevron-right text-gray-400"></i>
                            </div>
                        </div>
                        
                        <div class="settings-item" id="appInfoBtn">
                            <div class="settings-item-content">
                                <div class="settings-item-title">App Info</div>
                                <div class="settings-item-description">Version and about</div>
                            </div>
                            <div class="settings-item-action">
                                <i class="fas fa-chevron-right text-gray-400"></i>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Invite Section -->
                <div class="settings-section">
                    <h4 class="font-semibold mb-4 text-lg text-gray-800">Invite</h4>
                    <div class="space-y-1">
                        <div class="settings-item" id="inviteContactBtn">
                            <div class="settings-item-content">
                                <div class="settings-item-title">Invite a Contact</div>
                                <div class="settings-item-description">Share Kynecta with friends</div>
                            </div>
                            <div class="settings-item-action">
                                <i class="fas fa-chevron-right text-gray-400"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Logout -->
            <div class="p-6 border-t border-gray-200">
                <button id="logoutBtn" class="w-full py-4 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-xl font-semibold hover:opacity-90 transition-opacity">
                    Log Out
                </button>
            </div>
        </div>
    </div>

    <!-- Security Settings Modal -->
    <div id="securitySettingsModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl w-full max-w-md max-h-[80vh] overflow-hidden">
            <div class="kynecta-header p-6">
                <div class="flex items-center justify-between">
                    <h3 class="text-xl font-semibold text-white">Security Settings</h3>
                    <button id="closeSecuritySettings" class="text-white/80 hover:text-white transition-colors">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
            </div>
            
            <div class="p-6 space-y-6 overflow-y-auto max-h-[60vh] custom-scrollbar">
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Security Notifications</div>
                        <div class="settings-item-description">Get alerts about unusual activity</div>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="securityNotifications" checked>
                        <span class="toggle-slider"></span>
                    </label>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Passkeys</div>
                        <div class="settings-item-description">Use biometric authentication</div>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="passkeysEnabled">
                        <span class="toggle-slider"></span>
                    </label>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Two-Step Verification</div>
                        <div class="settings-item-description">Add an extra layer of security</div>
                    </div>
                    <div class="settings-item-action">
                        <i class="fas fa-chevron-right text-gray-400"></i>
                    </div>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Email Address</div>
                        <div class="settings-item-description">denis@example.com</div>
                    </div>
                    <div class="settings-item-action">
                        <i class="fas fa-chevron-right text-gray-400"></i>
                    </div>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Business Platform</div>
                        <div class="settings-item-description">Manage business account settings</div>
                    </div>
                    <div class="settings-item-action">
                        <i class="fas fa-chevron-right text-gray-400"></i>
                    </div>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Change Number</div>
                        <div class="settings-item-description">Transfer your account to a new number</div>
                    </div>
                    <div class="settings-item-action">
                        <i class="fas fa-chevron-right text-gray-400"></i>
                    </div>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Request Account Info</div>
                        <div class="settings-item-description">Download a report of your account data</div>
                    </div>
                    <div class="settings-item-action">
                        <i class="fas fa-chevron-right text-gray-400"></i>
                    </div>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Delete Account</div>
                        <div class="settings-item-description">Permanently delete your account</div>
                    </div>
                    <div class="settings-item-action">
                        <i class="fas fa-chevron-right text-gray-400"></i>
                    </div>
                </div>
            </div>
            
            <div class="p-6 border-t border-gray-200">
                <button class="w-full py-3 bg-gradient-to-r from-purple-500 to-green-500 text-white rounded-xl font-semibold hover:opacity-90 transition-opacity">
                    Save Changes
                </button>
            </div>
        </div>
    </div>

    <!-- Privacy Settings Modal -->
    <div id="privacySettingsModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl w-full max-w-md max-h-[80vh] overflow-hidden">
            <div class="kynecta-header p-6">
                <div class="flex items-center justify-between">
                    <h3 class="text-xl font-semibold text-white">Privacy Settings</h3>
                    <button id="closePrivacySettings" class="text-white/80 hover:text-white transition-colors">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
            </div>
            
            <div class="p-6 space-y-6 overflow-y-auto max-h-[60vh] custom-scrollbar">
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Last Seen & Online</div>
                        <div class="settings-item-description">Who can see when you were last online</div>
                    </div>
                    <select id="lastSeenPrivacy" class="border border-gray-300 rounded-lg px-3 py-1">
                        <option value="everyone">Everyone</option>
                        <option value="contacts">My Contacts</option>
                        <option value="nobody">Nobody</option>
                    </select>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Profile Photo</div>
                        <div class="settings-item-description">Who can see your profile photo</div>
                    </div>
                    <select id="profilePhotoPrivacy" class="border border-gray-300 rounded-lg px-3 py-1">
                        <option value="everyone">Everyone</option>
                        <option value="contacts">My Contacts</option>
                        <option value="nobody">Nobody</option>
                    </select>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">About</div>
                        <div class="settings-item-description">Who can see your about info</div>
                    </div>
                    <select id="aboutPrivacy" class="border border-gray-300 rounded-lg px-3 py-1">
                        <option value="everyone">Everyone</option>
                        <option value="contacts">My Contacts</option>
                        <option value="nobody">Nobody</option>
                    </select>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Status</div>
                        <div class="settings-item-description">Who can see your status updates</div>
                    </div>
                    <select id="statusPrivacy" class="border border-gray-300 rounded-lg px-3 py-1">
                        <option value="everyone">Everyone</option>
                        <option value="contacts">My Contacts</option>
                        <option value="nobody">Nobody</option>
                    </select>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Read Receipts</div>
                        <div class="settings-item-description">Send and receive read receipts</div>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="readReceipts" checked>
                        <span class="toggle-slider"></span>
                    </label>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Disappearing Messages</div>
                        <div class="settings-item-description">Default duration for new chats</div>
                    </div>
                    <select id="disappearingMessages" class="border border-gray-300 rounded-lg px-3 py-1">
                        <option value="off">Off</option>
                        <option value="24h">24 Hours</option>
                        <option value="7d">7 Days</option>
                        <option value="90d">90 Days</option>
                    </select>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Groups</div>
                        <div class="settings-item-description">Who can add you to groups</div>
                    </div>
                    <select id="groupsPrivacy" class="border border-gray-300 rounded-lg px-3 py-1">
                        <option value="everyone">Everyone</option>
                        <option value="contacts">My Contacts</option>
                        <option value="nobody">Nobody</option>
                    </select>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Avatar Stickers</div>
                        <div class="settings-item-description">Use your avatar as stickers</div>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="avatarStickers" checked>
                        <span class="toggle-slider"></span>
                    </label>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Live Location</div>
                        <div class="settings-item-description">Manage active location sharing</div>
                    </div>
                    <div class="settings-item-action">
                        <i class="fas fa-chevron-right text-gray-400"></i>
                    </div>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Calls</div>
                        <div class="settings-item-description">Who can call you</div>
                    </div>
                    <select id="callsPrivacy" class="border border-gray-300 rounded-lg px-3 py-1">
                        <option value="everyone">Everyone</option>
                        <option value="contacts">My Contacts</option>
                        <option value="nobody">Nobody</option>
                    </select>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Contact</div>
                        <div class="settings-item-description">Who can see your contact info</div>
                    </div>
                    <select id="contactPrivacy" class="border border-gray-300 rounded-lg px-3 py-1">
                        <option value="everyone">Everyone</option>
                        <option value="contacts">My Contacts</option>
                        <option value="nobody">Nobody</option>
                    </select>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">App Lock</div>
                        <div class="settings-item-description">Require authentication to open app</div>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="appLock">
                        <span class="toggle-slider"></span>
                    </label>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Chat Lock</div>
                        <div class="settings-item-description">Lock specific chats</div>
                    </div>
                    <div class="settings-item-action">
                        <i class="fas fa-chevron-right text-gray-400"></i>
                    </div>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Allow Camera Effects</div>
                        <div class="settings-item-description">Use AR effects in camera</div>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="cameraEffects" checked>
                        <span class="toggle-slider"></span>
                    </label>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Privacy Checkup</div>
                        <div class="settings-item-description">Review your privacy settings</div>
                    </div>
                    <div class="settings-item-action">
                        <i class="fas fa-chevron-right text-gray-400"></i>
                    </div>
                </div>
            </div>
            
            <div class="p-6 border-t border-gray-200">
                <button class="w-full py-3 bg-gradient-to-r from-purple-500 to-green-500 text-white rounded-xl font-semibold hover:opacity-90 transition-opacity">
                    Save Changes
                </button>
            </div>
        </div>
    </div>

    <!-- Avatar Settings Modal -->
    <div id="avatarSettingsModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl w-full max-w-md max-h-[80vh] overflow-hidden">
            <div class="kynecta-header p-6">
                <div class="flex items-center justify-between">
                    <h3 class="text-xl font-semibold text-white">Avatar Settings</h3>
                    <button id="closeAvatarSettings" class="text-white/80 hover:text-white transition-colors">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
            </div>
            
            <div class="p-6">
                <div class="text-center py-8">
                    <div class="w-32 h-32 rounded-full bg-gradient-to-r from-purple-500 to-green-500 flex items-center justify-center text-white text-4xl font-bold mx-auto mb-4">
                        DC
                    </div>
                    <h4 class="font-semibold text-lg mb-2">Denis Chacha</h4>
                    <p class="text-gray-500 text-sm">Your current profile picture</p>
                </div>
                
                <div class="space-y-4">
                    <button class="w-full p-4 bg-gradient-to-r from-purple-50 to-blue-50 rounded-xl text-left hover:shadow-md transition-all flex items-center justify-between" id="editAvatarBtn">
                        <div>
                            <p class="font-medium text-purple-700">Edit Avatar</p>
                            <p class="text-sm text-purple-600">Change your profile picture</p>
                        </div>
                        <i class="fas fa-edit text-purple-500"></i>
                    </button>
                    
                    <button class="w-full p-4 bg-gradient-to-r from-green-50 to-teal-50 rounded-xl text-left hover:shadow-md transition-all flex items-center justify-between" id="createAvatarBtn">
                        <div>
                            <p class="font-medium text-green-700">Create Avatar</p>
                            <p class="text-sm text-green-600">Design a personalized avatar</p>
                        </div>
                        <i class="fas fa-user-plus text-green-500"></i>
                    </button>
                    
                    <button class="w-full p-4 bg-gradient-to-r from-orange-50 to-amber-50 rounded-xl text-left hover:shadow-md transition-all flex items-center justify-between" id="removeAvatarBtn">
                        <div>
                            <p class="font-medium text-orange-700">Remove Avatar</p>
                            <p class="text-sm text-orange-600">Delete your current profile picture</p>
                        </div>
                        <i class="fas fa-trash text-orange-500"></i>
                    </button>
                </div>
            </div>
            
            <div class="p-6 border-t border-gray-200">
                <button class="w-full py-3 bg-gradient-to-r from-purple-500 to-green-500 text-white rounded-xl font-semibold hover:opacity-90 transition-opacity">
                    Done
                </button>
            </div>
        </div>
    </div>

    <!-- Profile Photo & Cover Modal -->
    <div id="profilePhotoModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl w-full max-w-md max-h-[80vh] overflow-hidden">
            <div class="kynecta-header p-6">
                <div class="flex items-center justify-between">
                    <h3 class="text-xl font-semibold text-white">Edit Profile</h3>
                    <button id="closeProfilePhoto" class="text-white/80 hover:text-white transition-colors">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
            </div>
            
            <div class="p-6">
                <div class="profile-cover mb-6">
                    <div class="profile-cover-edit">
                        <i class="fas fa-camera mr-2"></i>Edit Cover
                    </div>
                    <input type="file" id="coverUpload" accept="image/*">
                </div>
                
                <div class="flex justify-center -mt-16 mb-6">
                    <div class="relative">
                        <div class="w-32 h-32 rounded-full bg-gradient-to-r from-purple-500 to-green-500 flex items-center justify-center text-white text-4xl font-bold">
                            DC
                        </div>
                        <div class="profile-photo-edit">
                            <i class="fas fa-camera"></i>
                        </div>
                        <input type="file" id="profileUpload" accept="image/*">
                    </div>
                </div>
                
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Display Name</label>
                        <input type="text" id="displayName" class="w-full p-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:border-purple-500 transition-colors" value="Denis Chacha">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">About</label>
                        <textarea id="aboutText" class="w-full h-24 p-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:border-purple-500 transition-colors">Life without Christ is motion without meaning</textarea>
                    </div>
                </div>
            </div>
            
            <div class="p-6 border-t border-gray-200">
                <button class="w-full py-3 bg-gradient-to-r from-purple-500 to-green-500 text-white rounded-xl font-semibold hover:opacity-90 transition-opacity">
                    Save Changes
                </button>
            </div>
        </div>
    </div>

    <!-- Favorites Settings Modal -->
    <div id="favoritesSettingsModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl w-full max-w-md max-h-[80vh] overflow-hidden">
            <div class="kynecta-header p-6">
                <div class="flex items-center justify-between">
                    <h3 class="text-xl font-semibold text-white">Favorites</h3>
                    <button id="closeFavoritesSettings" class="text-white/80 hover:text-white transition-colors">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
            </div>
            
            <div class="p-6">
                <div class="text-center py-4 mb-4">
                    <h4 class="font-semibold text-lg mb-2">Manage Favorites</h4>
                    <p class="text-gray-500 text-sm">Add contacts or groups to favorites for quick access</p>
                </div>
                
                <div class="mb-4">
                    <div class="relative">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <i class="fas fa-search text-gray-400"></i>
                        </div>
                        <input type="text" id="favoritesSearch" class="w-full bg-gray-100 rounded-xl py-3 pl-10 pr-4 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:bg-white transition-all" placeholder="Search contacts or groups...">
                    </div>
                </div>
                
                <div id="favoritesListSettings" class="space-y-3 max-h-64 overflow-y-auto custom-scrollbar">
                    <!-- Favorites will be populated here -->
                </div>
                
                <div id="noFavoritesMessage" class="p-8 text-center text-gray-500">
                    <i class="fas fa-star text-4xl mb-3 text-gray-300 block"></i>
                    <p>No favorites yet</p>
                    <p class="text-sm mt-1">Add contacts or groups to favorites</p>
                </div>
            </div>
            
            <div class="p-6 border-t border-gray-200">
                <button class="w-full py-3 bg-gradient-to-r from-purple-500 to-green-500 text-white rounded-xl font-semibold hover:opacity-90 transition-opacity">
                    Done
                </button>
            </div>
        </div>
    </div>

    <!-- Chat Settings Modal -->
    <div id="chatSettingsModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl w-full max-w-md max-h-[80vh] overflow-hidden">
            <div class="kynecta-header p-6">
                <div class="flex items-center justify-between">
                    <h3 class="text-xl font-semibold text-white">Chat Settings</h3>
                    <button id="closeChatSettings" class="text-white/80 hover:text-white transition-colors">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
            </div>
            
            <div class="p-6 space-y-6 overflow-y-auto max-h-[60vh] custom-scrollbar">
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Display Theme</div>
                        <div class="settings-item-description">Choose your preferred theme</div>
                    </div>
                    <select id="displayTheme" class="border border-gray-300 rounded-lg px-3 py-1">
                        <option value="light">Light</option>
                        <option value="dark">Dark</option>
                        <option value="system">System Default</option>
                    </select>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Default Chat Theme</div>
                        <div class="settings-item-description">Theme for new chats</div>
                    </div>
                    <select id="defaultChatTheme" class="border border-gray-300 rounded-lg px-3 py-1">
                        <option value="purple">Purple</option>
                        <option value="blue">Blue</option>
                        <option value="green">Green</option>
                        <option value="red">Red</option>
                        <option value="orange">Orange</option>
                    </select>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Wallpaper</div>
                        <div class="settings-item-description">Set chat background</div>
                    </div>
                    <div class="settings-item-action">
                        <i class="fas fa-chevron-right text-gray-400"></i>
                    </div>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Chat History</div>
                        <div class="settings-item-description">Backup and restore chats</div>
                    </div>
                    <div class="settings-item-action">
                        <i class="fas fa-chevron-right text-gray-400"></i>
                    </div>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Export Chat</div>
                        <div class="settings-item-description">Save chat to your device</div>
                    </div>
                    <div class="settings-item-action">
                        <i class="fas fa-chevron-right text-gray-400"></i>
                    </div>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Font Size</div>
                        <div class="settings-item-description">Adjust text size in chats</div>
                    </div>
                    <select id="fontSize" class="border border-gray-300 rounded-lg px-3 py-1">
                        <option value="small">Small</option>
                        <option value="medium" selected>Medium</option>
                        <option value="large">Large</option>
                        <option value="x-large">Extra Large</option>
                    </select>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Enter Key Sends</div>
                        <div class="settings-item-description">Press Enter to send messages</div>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="enterKeySends" checked>
                        <span class="toggle-slider"></span>
                    </label>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Media Visibility</div>
                        <div class="settings-item-description">Show media in gallery</div>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="mediaVisibility" checked>
                        <span class="toggle-slider"></span>
                    </label>
                </div>
            </div>
            
            <div class="p-6 border-t border-gray-200">
                <button class="w-full py-3 bg-gradient-to-r from-purple-500 to-green-500 text-white rounded-xl font-semibold hover:opacity-90 transition-opacity">
                    Save Changes
                </button>
            </div>
        </div>
    </div>

    <!-- Notifications Settings Modal -->
    <div id="notificationsSettingsModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl w-full max-w-md max-h-[80vh] overflow-hidden">
            <div class="kynecta-header p-6">
                <div class="flex items-center justify-between">
                    <h3 class="text-xl font-semibold text-white">Notification Settings</h3>
                    <button id="closeNotificationsSettings" class="text-white/80 hover:text-white transition-colors">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
            </div>
            
            <div class="p-6 space-y-6 overflow-y-auto max-h-[60vh] custom-scrollbar">
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Conversation Tones</div>
                        <div class="settings-item-description">Play sounds for incoming and outgoing messages</div>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="conversationTones" checked>
                        <span class="toggle-slider"></span>
                    </label>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Reminders</div>
                        <div class="settings-item-description">Get occasional notifications about messages or status you haven't seen</div>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="reminders" checked>
                        <span class="toggle-slider"></span>
                    </label>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Message Notifications</div>
                        <div class="settings-item-description">Customize notification tone for messages</div>
                    </div>
                    <div class="settings-item-action">
                        <i class="fas fa-chevron-right text-gray-400"></i>
                    </div>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Group Notifications</div>
                        <div class="settings-item-description">Customize notification tone for groups</div>
                    </div>
                    <div class="settings-item-action">
                        <i class="fas fa-chevron-right text-gray-400"></i>
                    </div>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Call Notifications</div>
                        <div class="settings-item-description">Customize notification tone for calls</div>
                    </div>
                    <div class="settings-item-action">
                        <i class="fas fa-chevron-right text-gray-400"></i>
                    </div>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Vibrate</div>
                        <div class="settings-item-description">Vibrate on notifications</div>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="vibrate" checked>
                        <span class="toggle-slider"></span>
                    </label>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Notification Light</div>
                        <div class="settings-item-description">Show colored light for notifications</div>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="notificationLight" checked>
                        <span class="toggle-slider"></span>
                    </label>
                </div>
                
                <div class="mt-4">
                    <p class="text-sm font-medium text-gray-700 mb-2">Notification Light Color</p>
                    <div class="color-picker">
                        <div class="color-option active" style="background-color: #7C3AED;" data-color="#7C3AED"></div>
                        <div class="color-option" style="background-color: #10B981;" data-color="#10B981"></div>
                        <div class="color-option" style="background-color: #F59E0B;" data-color="#F59E0B"></div>
                        <div class="color-option" style="background-color: #EF4444;" data-color="#EF4444"></div>
                        <div class="color-option" style="background-color: #3B82F6;" data-color="#3B82F6"></div>
                    </div>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">High Priority Notifications</div>
                        <div class="settings-item-description">Show previews of notifications at the top of the screen</div>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="highPriorityNotifications" checked>
                        <span class="toggle-slider"></span>
                    </label>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Reaction Notifications</div>
                        <div class="settings-item-description">Show notifications for reactions to messages you send</div>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="reactionNotifications" checked>
                        <span class="toggle-slider"></span>
                    </label>
                </div>
            </div>
            
            <div class="p-6 border-t border-gray-200">
                <button class="w-full py-3 bg-gradient-to-r from-purple-500 to-green-500 text-white rounded-xl font-semibold hover:opacity-90 transition-opacity">
                    Save Changes
                </button>
            </div>
        </div>
    </div>

    <!-- Storage & Data Settings Modal -->
    <div id="storageSettingsModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl w-full max-w-md max-h-[80vh] overflow-hidden">
            <div class="kynecta-header p-6">
                <div class="flex items-center justify-between">
                    <h3 class="text-xl font-semibold text-white">Storage & Data</h3>
                    <button id="closeStorageSettings" class="text-white/80 hover:text-white transition-colors">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
            </div>
            
            <div class="p-6 space-y-6 overflow-y-auto max-h-[60vh] custom-scrollbar">
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Manage Storage</div>
                        <div class="settings-item-description">Manage storage for internal apps and Kynecta</div>
                    </div>
                    <div class="settings-item-action">
                        <i class="fas fa-chevron-right text-gray-400"></i>
                    </div>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Network Usage</div>
                        <div class="settings-item-description">See data usage for calls, media, messages, and status</div>
                    </div>
                    <div class="settings-item-action">
                        <i class="fas fa-chevron-right text-gray-400"></i>
                    </div>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Use Less Data for Calls</div>
                        <div class="settings-item-description">Reduce data usage during calls</div>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="lessDataCalls">
                        <span class="toggle-slider"></span>
                    </label>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Proxy</div>
                        <div class="settings-item-description">Use proxy server for connection</div>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="proxyEnabled">
                        <span class="toggle-slider"></span>
                    </label>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Media Upload Quality</div>
                        <div class="settings-item-description">Choose quality for media uploads</div>
                    </div>
                    <select id="mediaUploadQuality" class="border border-gray-300 rounded-lg px-3 py-1">
                        <option value="auto">Auto</option>
                        <option value="standard">Standard</option>
                        <option value="hd">HD</option>
                    </select>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Auto-Download Quality</div>
                        <div class="settings-item-description">Choose quality for auto-downloaded media</div>
                    </div>
                    <select id="autoDownloadQuality" class="border border-gray-300 rounded-lg px-3 py-1">
                        <option value="standard">Standard</option>
                        <option value="hd">HD</option>
                    </select>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Media Auto-Download</div>
                        <div class="settings-item-description">Configure auto-download settings</div>
                    </div>
                    <div class="settings-item-action">
                        <i class="fas fa-chevron-right text-gray-400"></i>
                    </div>
                </div>
            </div>
            
            <div class="p-6 border-t border-gray-200">
                <button class="w-full py-3 bg-gradient-to-r from-purple-500 to-green-500 text-white rounded-xl font-semibold hover:opacity-90 transition-opacity">
                    Save Changes
                </button>
            </div>
        </div>
    </div>

    <!-- Accessibility Modal -->
    <div id="accessibilityModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl w-full max-w-md max-h-[80vh] overflow-hidden">
            <div class="kynecta-header p-6">
                <div class="flex items-center justify-between">
                    <h3 class="text-xl font-semibold text-white">Accessibility</h3>
                    <button id="closeAccessibility" class="text-white/80 hover:text-white transition-colors">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
            </div>
            
            <div class="p-6 space-y-6 overflow-y-auto max-h-[60vh] custom-scrollbar">
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Large Text</div>
                        <div class="settings-item-description">Increase text size throughout the app</div>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="largeText">
                        <span class="toggle-slider"></span>
                    </label>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">High Contrast</div>
                        <div class="settings-item-description">Increase contrast for better visibility</div>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="highContrast">
                        <span class="toggle-slider"></span>
                    </label>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Screen Reader Support</div>
                        <div class="settings-item-description">Optimize for screen readers</div>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="screenReader" checked>
                        <span class="toggle-slider"></span>
                    </label>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Reduced Motion</div>
                        <div class="settings-item-description">Minimize animations and transitions</div>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="reducedMotion">
                        <span class="toggle-slider"></span>
                    </label>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Voice Control</div>
                        <div class="settings-item-description">Enable voice commands</div>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="voiceControl">
                        <span class="toggle-slider"></span>
                    </label>
                </div>
            </div>
            
            <div class="p-6 border-t border-gray-200">
                <button class="w-full py-3 bg-gradient-to-r from-purple-500 to-green-500 text-white rounded-xl font-semibold hover:opacity-90 transition-opacity">
                    Save Changes
                </button>
            </div>
        </div>
    </div>

    <!-- Language Settings Modal -->
    <div id="languageSettingsModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl w-full max-w-md max-h-[80vh] overflow-hidden">
            <div class="kynecta-header p-6">
                <div class="flex items-center justify-between">
                    <h3 class="text-xl font-semibold text-white">App Language</h3>
                    <button id="closeLanguageSettings" class="text-white/80 hover:text-white transition-colors">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
            </div>
            
            <div class="p-6 space-y-6 overflow-y-auto max-h-[60vh] custom-scrollbar">
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Language</div>
                        <div class="settings-item-description">Choose your preferred language</div>
                    </div>
                    <select id="appLanguage" class="border border-gray-300 rounded-lg px-3 py-1">
                        <option value="en">English</option>
                        <option value="es">EspaÃ±ol</option>
                        <option value="fr">FranÃ§ais</option>
                        <option value="de">Deutsch</option>
                        <option value="it">Italiano</option>
                        <option value="pt">PortuguÃªs</option>
                        <option value="ru">Ð ÑƒÑÑÐºÐ¸Ð¹</option>
                        <option value="zh">ä¸­æ–‡</option>
                        <option value="ja">æ—¥æœ¬èªž</option>
                        <option value="ko">í•œêµ­ì–´</option>
                        <option value="ar">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
                        <option value="hi">à¤¹à¤¿à¤¨à¥à¤¦à¥€</option>
                    </select>
                </div>
            </div>
            
            <div class="p-6 border-t border-gray-200">
                <button class="w-full py-3 bg-gradient-to-r from-purple-500 to-green-500 text-white rounded-xl font-semibold hover:opacity-90 transition-opacity">
                    Save Changes
                </button>
            </div>
        </div>
    </div>

    <!-- Help & Support Modal -->
    <div id="helpSupportModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl w-full max-w-md max-h-[80vh] overflow-hidden">
            <div class="kynecta-header p-6">
                <div class="flex items-center justify-between">
                    <h3 class="text-xl font-semibold text-white">Help & Support</h3>
                    <button id="closeHelpSupport" class="text-white/80 hover:text-white transition-colors">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
            </div>
            
            <div class="p-6 space-y-6 overflow-y-auto max-h-[60vh] custom-scrollbar">
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Help Center</div>
                        <div class="settings-item-description">Get help and tutorials</div>
                    </div>
                    <div class="settings-item-action">
                        <i class="fas fa-chevron-right text-gray-400"></i>
                    </div>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Contact Us</div>
                        <div class="settings-item-description">Reach out for support</div>
                    </div>
                    <div class="settings-item-action">
                        <i class="fas fa-chevron-right text-gray-400"></i>
                    </div>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Send Feedback</div>
                        <div class="settings-item-description">Report technical issues</div>
                    </div>
                    <div class="settings-item-action">
                        <i class="fas fa-chevron-right text-gray-400"></i>
                    </div>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Terms and Privacy Policy</div>
                        <div class="settings-item-description">Read our terms and conditions</div>
                    </div>
                    <div class="settings-item-action">
                        <i class="fas fa-chevron-right text-gray-400"></i>
                    </div>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">Channel Report</div>
                        <div class="settings-item-description">Report issues with channels</div>
                    </div>
                    <div class="settings-item-action">
                        <i class="fas fa-chevron-right text-gray-400"></i>
                    </div>
                </div>
                
                <div class="settings-item">
                    <div class="settings-item-content">
                        <div class="settings-item-title">App Info</div>
                        <div class="settings-item-description">Version and about</div>
                    </div>
                    <div class="settings-item-action">
                        <i class="fas fa-chevron-right text-gray-400"></i>
                    </div>
                </div>
            </div>
            
            <div class="p-6 border-t border-gray-200">
                <button class="w-full py-3 bg-gradient-to-r from-purple-500 to-green-500 text-white rounded-xl font-semibold hover:opacity-90 transition-opacity">
                    Done
                </button>
            </div>
        </div>
    </div>

    <!-- Invite Contact Modal -->
    <div id="inviteContactModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl w-full max-w-md max-h-[80vh] overflow-hidden">
            <div class="kynecta-header p-6">
                <div class="flex items-center justify-between">
                    <h3 class="text-xl font-semibold text-white">Invite a Contact</h3>
                    <button id="closeInviteContact" class="text-white/80 hover:text-white transition-colors">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
            </div>
            
            <div class="p-6">
                <div class="text-center py-8">
                    <div class="w-16 h-16 rounded-full bg-gradient-to-r from-purple-500 to-green-500 flex items-center justify-center text-white mx-auto mb-4">
                        <i class="fas fa-user-plus"></i>
                    </div>
                    <h4 class="font-semibold text-lg mb-2">Share Kynecta</h4>
                    <p class="text-gray-500 text-sm">Invite friends to join Kynecta and connect with them</p>
                </div>
                
                <div class="space-y-4">
                    <button class="w-full p-4 bg-gradient-to-r from-purple-50 to-blue-50 rounded-xl text-left hover:shadow-md transition-all flex items-center justify-between" id="shareLinkBtn">
                        <div>
                            <p class="font-medium text-purple-700">Share Invite Link</p>
                            <p class="text-sm text-purple-600">Copy and share your personal invite link</p>
                        </div>
                        <i class="fas fa-link text-purple-500"></i>
                    </button>
                    
                    <button class="w-full p-4 bg-gradient-to-r from-green-50 to-teal-50 rounded-xl text-left hover:shadow-md transition-all flex items-center justify-between" id="shareContactsBtn">
                        <div>
                            <p class="font-medium text-green-700">Invite from Contacts</p>
                            <p class="text-sm text-green-600">Invite contacts from your address book</p>
                        </div>
                        <i class="fas fa-address-book text-green-500"></i>
                    </button>
                    
                    <button class="w-full p-4 bg-gradient-to-r from-orange-50 to-amber-50 rounded-xl text-left hover:shadow-md transition-all flex items-center justify-between" id="shareSocialBtn">
                        <div>
                            <p class="font-medium text-orange-700">Share on Social Media</p>
                            <p class="text-sm text-orange-600">Share Kynecta on your social networks</p>
                        </div>
                        <i class="fas fa-share-alt text-orange-500"></i>
                    </button>
                </div>
            </div>
            
            <div class="p-6 border-t border-gray-200">
                <button class="w-full py-3 bg-gradient-to-r from-purple-500 to-green-500 text-white rounded-xl font-semibold hover:opacity-90 transition-opacity">
                    Done
                </button>
            </div>
        </div>
    </div>

    <!-- Add Contact Modal -->
    <div id="addContactModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl w-full max-w-md max-h-[80vh] overflow-hidden">
            <div class="kynecta-header p-6">
                <h3 class="text-xl font-semibold text-white text-center">Add New Contact</h3>
            </div>
            
            <div class="p-6">
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Name</label>
                    <input type="text" id="contactName" class="w-full p-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:border-purple-500 transition-colors" placeholder="Enter contact name">
                </div>
                
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Email</label>
                    <input type="email" id="contactEmail" class="w-full p-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:border-purple-500 transition-colors" placeholder="Enter email address">
                </div>
                
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Phone Number</label>
                    <input type="tel" id="contactPhone" class="w-full p-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:border-purple-500 transition-colors" placeholder="Enter phone number">
                </div>
                
                <div class="flex space-x-3">
                    <button id="saveContact" class="flex-1 py-3 bg-gradient-to-r from-purple-500 to-green-500 text-white rounded-xl font-semibold hover:opacity-90 transition-opacity">
                        Save Contact
                    </button>
                    <button id="cancelContact" class="flex-1 py-3 bg-gray-500 text-white rounded-xl font-semibold hover:opacity-90 transition-opacity">
                        Cancel
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Business Tools Modals -->
    <div id="catalogueModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl w-full max-w-md max-h-[80vh] overflow-hidden">
            <div class="kynecta-header p-6">
                <div class="flex items-center justify-between">
                    <h3 class="text-xl font-semibold text-white">Product Catalogue</h3>
                    <button id="closeCatalogue" class="text-white/80 hover:text-white transition-colors">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
            </div>
            
            <div class="p-6">
                <div class="text-center py-8">
                    <div class="w-16 h-16 rounded-full bg-gradient-to-r from-purple-500 to-green-500 flex items-center justify-center text-white mx-auto mb-4">
                        <i class="fas fa-shopping-cart"></i>
                    </div>
                    <h4 class="font-semibold text-lg mb-2">Manage Your Products</h4>
                    <p class="text-gray-500 text-sm">Add, edit, and organize your product catalogue for easy sharing with customers.</p>
                </div>
                
                <div class="space-y-4">
                    <button class="w-full p-4 bg-gradient-to-r from-purple-50 to-blue-50 rounded-xl text-left hover:shadow-md transition-all flex items-center justify-between">
                        <div>
                            <p class="font-medium text-purple-700">Add New Product</p>
                            <p class="text-sm text-purple-600">Create a new product listing</p>
                        </div>
                        <i class="fas fa-plus text-purple-500"></i>
                    </button>
                    
                    <button class="w-full p-4 bg-gradient-to-r from-green-50 to-teal-50 rounded-xl text-left hover:shadow-md transition-all flex items-center justify-between">
                        <div>
                            <p class="font-medium text-green-700">View Catalogue</p>
                            <p class="text-sm text-green-600">Browse your product catalogue</p>
                        </div>
                        <i class="fas fa-eye text-green-500"></i>
                    </button>
                    
                    <button class="w-full p-4 bg-gradient-to-r from-orange-50 to-amber-50 rounded-xl text-left hover:shadow-md transition-all flex items-center justify-between">
                        <div>
                            <p class="font-medium text-orange-700">Organize Categories</p>
                            <p class="text-sm text-orange-600">Manage product categories</p>
                        </div>
                        <i class="fas fa-folder text-orange-500"></i>
                    </button>
                </div>
            </div>
            
            <div class="p-6 border-t border-gray-200">
                <button class="w-full py-3 bg-gradient-to-r from-purple-500 to-green-500 text-white rounded-xl font-semibold hover:opacity-90 transition-opacity">
                    Done
                </button>
            </div>
        </div>
    </div>

    <div id="advertiseModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl w-full max-w-md max-h-[80vh] overflow-hidden">
            <div class="kynecta-header p-6">
                <div class="flex items-center justify-between">
                    <h3 class="text-xl font-semibold text-white">Advertise</h3>
                    <button id="closeAdvertise" class="text-white/80 hover:text-white transition-colors">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
            </div>
            
            <div class="p-6">
                <div class="text-center py-8">
                    <div class="w-16 h-16 rounded-full bg-gradient-to-r from-green-500 to-teal-500 flex items-center justify-center text-white mx-auto mb-4">
                        <i class="fas fa-bullhorn"></i>
                    </div>
                    <h4 class="font-semibold text-lg mb-2">Create and Manage Ads</h4>
                    <p class="text-gray-500 text-sm">Reach more customers with targeted advertising campaigns.</p>
                </div>
                
                <div class="space-y-4">
                    <button class="w-full p-4 bg-gradient-to-r from-green-50 to-teal-50 rounded-xl text-left hover:shadow-md transition-all flex items-center justify-between">
                        <div>
                            <p class="font-medium text-green-700">Create New Ad</p>
                            <p class="text-sm text-green-600">Set up a new advertising campaign</p>
                        </div>
                        <i class="fas fa-plus text-green-500"></i>
                    </button>
                    
                    <button class="w-full p-4 bg-gradient-to-r from-purple-50 to-blue-50 rounded-xl text-left hover:shadow-md transition-all flex items-center justify-between">
                        <div>
                            <p class="font-medium text-purple-700">Ad Performance</p>
                            <p class="text-sm text-purple-600">View analytics and performance</p>
                        </div>
                        <i class="fas fa-chart-line text-purple-500"></i>
                    </button>
                    
                    <button class="w-full p-4 bg-gradient-to-r from-orange-50 to-amber-50 rounded-xl text-left hover:shadow-md transition-all flex items-center justify-between">
                        <div>
                            <p class="font-medium text-orange-700">Ad Budget</p>
                            <p class="text-sm text-orange-600">Manage your advertising budget</p>
                        </div>
                        <i class="fas fa-dollar-sign text-orange-500"></i>
                    </button>
                </div>
            </div>
            
            <div class="p-6 border-t border-gray-200">
                <button class="w-full py-3 bg-gradient-to-r from-purple-500 to-green-500 text-white rounded-xl font-semibold hover:opacity-90 transition-opacity">
                    Done
                </button>
            </div>
        </div>
    </div>

    <div id="labelsModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl w-full max-w-md max-h-[80vh] overflow-hidden">
            <div class="kynecta-header p-6">
                <div class="flex items-center justify-between">
                    <h3 class="text-xl font-semibold text-white">Labels</h3>
                    <button id="closeLabels" class="text-white/80 hover:text-white transition-colors">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
            </div>
            
            <div class="p-6">
                <div class="text-center py-8">
                    <div class="w-16 h-16 rounded-full bg-gradient-to-r from-orange-500 to-amber-500 flex items-center justify-center text-white mx-auto mb-4">
                        <i class="fas fa-tags"></i>
                    </div>
                    <h4 class="font-semibold text-lg mb-2">Organize with Labels</h4>
                    <p class="text-gray-500 text-sm">Create and manage labels to organize your contacts and conversations.</p>
                </div>
                
                <div class="space-y-4">
                    <button class="w-full p-4 bg-gradient-to-r from-orange-50 to-amber-50 rounded-xl text-left hover:shadow-md transition-all flex items-center justify-between">
                        <div>
                            <p class="font-medium text-orange-700">Create New Label</p>
                            <p class="text-sm text-orange-600">Add a new label for organization</p>
                        </div>
                        <i class="fas fa-plus text-orange-500"></i>
                    </button>
                    
                    <button class="w-full p-4 bg-gradient-to-r from-purple-50 to-blue-50 rounded-xl text-left hover:shadow-md transition-all flex items-center justify-between">
                        <div>
                            <p class="font-medium text-purple-700">Manage Labels</p>
                            <p class="text-sm text-purple-600">Edit or delete existing labels</p>
                        </div>
                        <i class="fas fa-edit text-purple-500"></i>
                    </button>
                    
                    <button class="w-full p-4 bg-gradient-to-r from-green-50 to-teal-50 rounded-xl text-left hover:shadow-md transition-all flex items-center justify-between">
                        <div>
                            <p class="font-medium text-green-700">Apply Labels</p>
                            <p class="text-sm text-green-600">Assign labels to contacts or chats</p>
                        </div>
                        <i class="fas fa-tag text-green-500"></i>
                    </button>
                </div>
            </div>
            
            <div class="p-6 border-t border-gray-200">
                <button class="w-full py-3 bg-gradient-to-r from-purple-500 to-green-500 text-white rounded-xl font-semibold hover:opacity-90 transition-opacity">
                    Done
                </button>
            </div>
        </div>
    </div>

    <div id="greetingModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl w-full max-w-md max-h-[80vh] overflow-hidden">
            <div class="kynecta-header p-6">
                <div class="flex items-center justify-between">
                    <h3 class="text-xl font-semibold text-white">Greeting Message</h3>
                    <button id="closeGreeting" class="text-white/80 hover:text-white transition-colors">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
            </div>
            
            <div class="p-6">
                <div class="text-center py-8">
                    <div class="w-16 h-16 rounded-full bg-gradient-to-r from-blue-500 to-indigo-500 flex items-center justify-center text-white mx-auto mb-4">
                        <i class="fas fa-comment-dots"></i>
                    </div>
                    <h4 class="font-semibold text-lg mb-2">Welcome Messages</h4>
                    <p class="text-gray-500 text-sm">Set up automatic greeting messages for new contacts.</p>
                </div>
                
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Greeting Message</label>
                    <textarea class="w-full h-32 p-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:border-purple-500 transition-colors" placeholder="Enter your greeting message...">Hello! Thanks for reaching out. How can I help you today?</textarea>
                </div>
                
                <div class="flex items-center justify-between p-4 bg-gray-50 rounded-xl mb-4">
                    <div>
                        <p class="font-medium">Enable Greeting Message</p>
                        <p class="text-sm text-gray-500">Automatically send to new contacts</p>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" checked>
                        <span class="toggle-slider"></span>
                    </label>
                </div>
            </div>
            
            <div class="p-6 border-t border-gray-200">
                <button class="w-full py-3 bg-gradient-to-r from-purple-500 to-green-500 text-white rounded-xl font-semibold hover:opacity-90 transition-opacity">
                    Save Changes
                </button>
            </div>
        </div>
    </div>

    <div id="awayModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl w-full max-w-md max-h-[80vh] overflow-hidden">
            <div class="kynecta-header p-6">
                <div class="flex items-center justify-between">
                    <h3 class="text-xl font-semibold text-white">Away Message</h3>
                    <button id="closeAway" class="text-white/80 hover:text-white transition-colors">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
            </div>
            
            <div class="p-6">
                <div class="text-center py-8">
                    <div class="w-16 h-16 rounded-full bg-gradient-to-r from-red-500 to-pink-500 flex items-center justify-center text-white mx-auto mb-4">
                        <i class="fas fa-clock"></i>
                    </div>
                    <h4 class="font-semibold text-lg mb-2">Away Messages</h4>
                    <p class="text-gray-500 text-sm">Set up automatic responses when you're unavailable.</p>
                </div>
                
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Away Message</label>
                    <textarea class="w-full h-32 p-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:border-purple-500 transition-colors" placeholder="Enter your away message...">I'm currently unavailable but will respond as soon as possible. Thank you for your message!</textarea>
                </div>
                
                <div class="flex items-center justify-between p-4 bg-gray-50 rounded-xl mb-4">
                    <div>
                        <p class="font-medium">Enable Away Message</p>
                        <p class="text-sm text-gray-500">Automatically send when you're away</p>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox">
                        <span class="toggle-slider"></span>
                    </label>
                </div>
                
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Schedule</label>
                    <select class="w-full p-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:border-purple-500 transition-colors">
                        <option>Always active when enabled</option>
                        <option>Specific days and times</option>
                        <option>When I'm inactive for more than 30 minutes</option>
                    </select>
                </div>
            </div>
            
            <div class="p-6 border-t border-gray-200">
                <button class="w-full py-3 bg-gradient-to-r from-purple-500 to-green-500 text-white rounded-xl font-semibold hover:opacity-90 transition-opacity">
                    Save Changes
                </button>
            </div>
        </div>
    </div>

    <!-- Existing modals for calls, groups, etc. -->
    <div id="callModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl w-full max-w-md max-h-[80vh] overflow-hidden">
            <div class="kynecta-header p-6">
                <h3 class="text-xl font-semibold text-white text-center">Start a Call</h3>
                <p class="text-white/80 text-center mt-1">Choose who to call</p>
            </div>
            
            <div class="p-4">
                <div class="flex space-x-3 mb-6">
                    <button class="flex-1 py-4 bg-gradient-to-r from-purple-500 to-purple-600 text-white rounded-xl font-semibold hover:opacity-90 transition-opacity" id="startVideoCall">
                        <i class="fas fa-video mr-2"></i>Video Call
                    </button>
                    <button class="flex-1 py-4 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-xl font-semibold hover:opacity-90 transition-opacity" id="startVoiceCall">
                        <i class="fas fa-phone mr-2"></i>Voice Call
                    </button>
                </div>
                
                <h4 class="font-semibold mb-3 text-gray-700">Recent Contacts</h4>
                <div id="callContacts" class="space-y-3 max-h-64 overflow-y-auto">
                    <!-- Call contacts will be populated here -->
                </div>
            </div>
            
            <div class="p-4 border-t border-gray-200">
                <button id="closeCallModal" class="w-full py-3 text-gray-600 hover:text-gray-800 font-semibold transition-colors">
                    Cancel
                </button>
            </div>
        </div>
    </div>

    <div id="newGroupModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl w-full max-w-md max-h-[80vh] overflow-hidden">
            <div class="kynecta-header p-6">
                <h3 class="text-xl font-semibold text-white text-center">Create New Group</h3>
            </div>
            
            <div class="p-6">
                <input type="text" id="groupName" placeholder="Group name" class="w-full p-4 border-2 border-gray-200 rounded-xl mb-4 focus:outline-none focus:border-purple-500 transition-colors">
                
                <h4 class="font-semibold mb-3 text-gray-700">Select Participants</h4>
                <div id="groupParticipants" class="space-y-3 max-h-64 overflow-y-auto mb-4">
                    <!-- Group participants will be populated here -->
                </div>
                
                <div class="flex space-x-3">
                    <button id="createGroup" class="flex-1 py-3 bg-gradient-to-r from-purple-500 to-green-500 text-white rounded-xl font-semibold hover:opacity-90 transition-opacity">
                        Create Group
                    </button>
                    <button id="cancelGroup" class="flex-1 py-3 bg-gray-500 text-white rounded-xl font-semibold hover:opacity-90 transition-opacity">
                        Cancel
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Video Conference Modal -->
    <div id="videoConferenceModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl w-full max-w-md max-h-[80vh] overflow-hidden">
            <div class="kynecta-header p-6">
                <h3 class="text-xl font-semibold text-white text-center">Start Video Conference</h3>
            </div>
            
            <div class="p-6">
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Conference Name</label>
                    <input type="text" id="conferenceName" class="w-full p-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:border-purple-500 transition-colors" placeholder="Enter conference name">
                </div>
                
                <h4 class="font-semibold mb-3 text-gray-700">Select Participants</h4>
                <div id="conferenceParticipants" class="space-y-3 max-h-64 overflow-y-auto mb-4">
                    <!-- Conference participants will be populated here -->
                </div>
                
                <div class="flex space-x-3">
                    <button id="startConference" class="flex-1 py-3 bg-gradient-to-r from-purple-500 to-green-500 text-white rounded-xl font-semibold hover:opacity-90 transition-opacity">
                        Start Conference
                    </button>
                    <button id="cancelConference" class="flex-1 py-3 bg-gray-500 text-white rounded-xl font-semibold hover:opacity-90 transition-opacity">
                        Cancel
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Reaction Picker (Dynamic) -->
    <div id="reactionPicker" class="reaction-picker hidden">
        <div class="reaction-option" data-reaction="ðŸ‘">ðŸ‘</div>
        <div class="reaction-option" data-reaction="â¤ï¸">â¤ï¸</div>
        <div class="reaction-option" data-reaction="ðŸ˜‚">ðŸ˜‚</div>
        <div class="reaction-option" data-reaction="ðŸ˜®">ðŸ˜®</div>
        <div class="reaction-option" data-reaction="ðŸ˜¢">ðŸ˜¢</div>
        <div class="reaction-option" data-reaction="ðŸŽ‰">ðŸŽ‰</div>
    </div>

    <script>
        // Firebase configuration - Replace with your actual Firebase config
        const firebaseConfig = {
            apiKey: "your-api-key",
            authDomain: "your-auth-domain",
            projectId: "your-project-id",
            storageBucket: "your-storage-bucket",
            messagingSenderId: "your-sender-id",
            appId: "your-app-id"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();
        const storage = firebase.storage();

        // Cloudinary configuration
        const cloudinaryConfig = {
            cloudName: 'dhjnxa5rh',
            apiKey: '817591969559894',
            uploadPreset: 'kynecta_uploads' // You need to create this in Cloudinary
        };

        // Global Variables
        let currentUser = null;
        let currentUserData = null;
        let currentChat = null;
        let isInCall = false;
        let contacts = [];
        let userSettings = {
            security: {
                notifications: true,
                passkeys: false,
                twoStepVerification: false
            },
            privacy: {
                lastSeen: 'everyone',
                profilePhoto: 'everyone',
                about: 'everyone',
                status: 'everyone',
                readReceipts: true,
                disappearingMessages: 'off',
                groups: 'everyone',
                avatarStickers: true,
                calls: 'everyone',
                contact: 'everyone',
                appLock: false,
                cameraEffects: true
            },
            notifications: {
                conversationTones: true,
                reminders: true,
                vibrate: true,
                notificationLight: true,
                lightColor: '#7C3AED',
                highPriorityNotifications: true,
                reactionNotifications: true
            },
            storage: {
                lessDataCalls: false,
                proxyEnabled: false,
                mediaUploadQuality: 'auto',
                autoDownloadQuality: 'standard'
            },
            chat: {
                displayTheme: 'light',
                defaultChatTheme: 'purple',
                fontSize: 'medium',
                enterKeySends: true,
                mediaVisibility: true
            },
            accessibility: {
                largeText: false,
                highContrast: false,
                screenReader: true,
                reducedMotion: false,
                voiceControl: false
            },
            language: {
                appLanguage: 'en'
            },
            favorites: []
        };
        let userStatuses = [];
        let unsubscribeMessages = null;

        // DOM Elements
        const loadingScreen = document.getElementById('loadingScreen');
        const chatApp = document.getElementById('chatApp');
        const settingsModal = document.getElementById('settingsModal');
        const securitySettingsModal = document.getElementById('securitySettingsModal');
        const privacySettingsModal = document.getElementById('privacySettingsModal');
        const avatarSettingsModal = document.getElementById('avatarSettingsModal');
        const profilePhotoModal = document.getElementById('profilePhotoModal');
        const favoritesSettingsModal = document.getElementById('favoritesSettingsModal');
        const chatSettingsModal = document.getElementById('chatSettingsModal');
        const notificationsSettingsModal = document.getElementById('notificationsSettingsModal');
        const storageSettingsModal = document.getElementById('storageSettingsModal');
        const accessibilityModal = document.getElementById('accessibilityModal');
        const languageSettingsModal = document.getElementById('languageSettingsModal');
        const helpSupportModal = document.getElementById('helpSupportModal');
        const inviteContactModal = document.getElementById('inviteContactModal');
        const addContactModal = document.getElementById('addContactModal');
        const statusCreation = document.getElementById('statusCreation');
        const videoConferenceModal = document.getElementById('videoConferenceModal');
        const catalogueModal = document.getElementById('catalogueModal');
        const advertiseModal = document.getElementById('advertiseModal');
        const labelsModal = document.getElementById('labelsModal');
        const greetingModal = document.getElementById('greetingModal');
        const awayModal = document.getElementById('awayModal');

        // Initialize the application
        document.addEventListener('DOMContentLoaded', initApp);

        function initApp() {
            // Check if user is logged in
            auth.onAuthStateChanged(user => {
                if (user) {
                    currentUser = user;
                    loadUserData();
                } else {
                    // Redirect to login page
                    window.location.href = 'login.html';
                }
            });
        }

        async function loadUserData() {
            try {
                // Get user document from Firestore
                const userDoc = await db.collection('users').doc(currentUser.uid).get();
                
                if (userDoc.exists) {
                    currentUserData = userDoc.data();
                    initializeUserData();
                } else {
                    // Create user document if it doesn't exist
                    currentUserData = {
                        uid: currentUser.uid,
                        email: currentUser.email,
                        displayName: currentUser.displayName || currentUser.email.split('@')[0],
                        photoURL: currentUser.photoURL || `https://ui-avatars.com/api/?name=${encodeURIComponent(currentUser.displayName || currentUser.email)}&background=7C3AED&color=fff`,
                        createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                        lastSeen: firebase.firestore.FieldValue.serverTimestamp(),
                        status: 'online',
                        mood: 'happy'
                    };
                    
                    await db.collection('users').doc(currentUser.uid).set(currentUserData);
                    initializeUserData();
                }
                
                showChatApp();
                setupEventListeners();
                loadUserSettings();
                loadStatusUpdates();
                loadContacts();
            } catch (error) {
                console.error('Error loading user data:', error);
                showToast('Error loading user data', 'error');
            }
        }

        function initializeUserData() {
            // Set user info in UI
            document.getElementById('userName').textContent = currentUserData.displayName;
            document.getElementById('userAvatar').src = currentUserData.photoURL;
            
            // Update settings modal with user data
            const settingsName = document.querySelector('#settingsModal .font-semibold.text-lg');
            if (settingsName) {
                settingsName.textContent = currentUserData.displayName;
            }
            
            // Load user preferences
            loadUserPreferences();
        }

        function showChatApp() {
            loadingScreen.classList.add('hidden');
            chatApp.classList.remove('hidden');
        }

        function loadUserPreferences() {
            const theme = localStorage.getItem('kynecta-theme') || 'light';
            setTheme(theme);
        }

        function setTheme(theme) {
            document.body.setAttribute('data-theme', theme);
            localStorage.setItem('kynecta-theme', theme);
            
            // Update theme icon
            const themeIcon = document.getElementById('themeIcon');
            if (theme === 'dark') {
                themeIcon.className = 'fas fa-sun';
            } else {
                themeIcon.className = 'fas fa-moon';
            }
        }

        function showToast(message, type = 'info') {
            const toastContainer = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.textContent = message;
            
            toastContainer.appendChild(toast);
            
            // Trigger animation
            setTimeout(() => toast.classList.add('show'), 10);
            
            // Remove after delay
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => {
                    if (toast.parentNode) {
                        toast.parentNode.removeChild(toast);
                    }
                }, 300);
            }, 3000);
        }

        function loadUserSettings() {
            // Load settings from localStorage or use defaults
            const savedSettings = localStorage.getItem('kynecta-settings');
            if (savedSettings) {
                userSettings = JSON.parse(savedSettings);
            }
            
            // Apply settings to UI
            applyUserSettings();
        }

        function saveUserSettings() {
            localStorage.setItem('kynecta-settings', JSON.stringify(userSettings));
        }

        function applyUserSettings() {
            // Apply theme
            setTheme(userSettings.chat.displayTheme);
            
            // Apply chat settings
            document.getElementById('displayTheme').value = userSettings.chat.displayTheme;
            document.getElementById('defaultChatTheme').value = userSettings.chat.defaultChatTheme;
            document.getElementById('fontSize').value = userSettings.chat.fontSize;
            document.getElementById('enterKeySends').checked = userSettings.chat.enterKeySends;
            document.getElementById('mediaVisibility').checked = userSettings.chat.mediaVisibility;
            
            // Apply security settings
            document.getElementById('securityNotifications').checked = userSettings.security.notifications;
            document.getElementById('passkeysEnabled').checked = userSettings.security.passkeys;
            
            // Apply privacy settings
            document.getElementById('lastSeenPrivacy').value = userSettings.privacy.lastSeen;
            document.getElementById('profilePhotoPrivacy').value = userSettings.privacy.profilePhoto;
            document.getElementById('aboutPrivacy').value = userSettings.privacy.about;
            document.getElementById('statusPrivacy').value = userSettings.privacy.status;
            document.getElementById('readReceipts').checked = userSettings.privacy.readReceipts;
            document.getElementById('disappearingMessages').value = userSettings.privacy.disappearingMessages;
            document.getElementById('groupsPrivacy').value = userSettings.privacy.groups;
            document.getElementById('avatarStickers').checked = userSettings.privacy.avatarStickers;
            document.getElementById('callsPrivacy').value = userSettings.privacy.calls;
            document.getElementById('contactPrivacy').value = userSettings.privacy.contact;
            document.getElementById('appLock').checked = userSettings.privacy.appLock;
            document.getElementById('cameraEffects').checked = userSettings.privacy.cameraEffects;
            
            // Apply notification settings
            document.getElementById('conversationTones').checked = userSettings.notifications.conversationTones;
            document.getElementById('reminders').checked = userSettings.notifications.reminders;
            document.getElementById('vibrate').checked = userSettings.notifications.vibrate;
            document.getElementById('notificationLight').checked = userSettings.notifications.notificationLight;
            document.getElementById('highPriorityNotifications').checked = userSettings.notifications.highPriorityNotifications;
            document.getElementById('reactionNotifications').checked = userSettings.notifications.reactionNotifications;
            
            // Apply storage settings
            document.getElementById('lessDataCalls').checked = userSettings.storage.lessDataCalls;
            document.getElementById('proxyEnabled').checked = userSettings.storage.proxyEnabled;
            document.getElementById('mediaUploadQuality').value = userSettings.storage.mediaUploadQuality;
            document.getElementById('autoDownloadQuality').value = userSettings.storage.autoDownloadQuality;
            
            // Apply accessibility settings
            document.getElementById('largeText').checked = userSettings.accessibility.largeText;
            document.getElementById('highContrast').checked = userSettings.accessibility.highContrast;
            document.getElementById('screenReader').checked = userSettings.accessibility.screenReader;
            document.getElementById('reducedMotion').checked = userSettings.accessibility.reducedMotion;
            document.getElementById('voiceControl').checked = userSettings.accessibility.voiceControl;
            
            // Apply language settings
            document.getElementById('appLanguage').value = userSettings.language.appLanguage;
            
            // Apply notification light color
            document.querySelectorAll('.color-option').forEach(option => {
                option.classList.remove('active');
                if (option.dataset.color === userSettings.notifications.lightColor) {
                    option.classList.add('active');
                }
            });
        }

        function loadStatusUpdates() {
            const statusUpdates = document.getElementById('statusUpdates');
            const userStatuses = JSON.parse(localStorage.getItem('kynecta-statuses') || '[]');
            
            if (userStatuses.length === 0) {
                statusUpdates.innerHTML = `
                    <div class="text-center text-gray-500 py-8">
                        <i class="fas fa-images text-4xl mb-3 text-gray-300 block"></i>
                        <p>No status updates yet</p>
                        <p class="text-sm mt-1">Share a photo, video, or text update</p>
                    </div>
                `;
            } else {
                statusUpdates.innerHTML = '';
                userStatuses.forEach(status => {
                    const statusElement = document.createElement('div');
                    statusElement.className = 'flex items-center space-x-3 p-3 rounded-xl hover:bg-gray-50 transition-colors cursor-pointer';
                    
                    let statusContent = '';
                    if (status.type === 'emoji') {
                        statusContent = `<div class="w-12 h-12 rounded-full bg-gradient-to-r from-purple-500 to-green-500 flex items-center justify-center text-white text-xl">${status.content}</div>`;
                    } else if (status.type === 'text') {
                        statusContent = `<div class="w-12 h-12 rounded-full bg-gradient-to-r from-blue-500 to-teal-500 flex items-center justify-center text-white"><i class="fas fa-font"></i></div>`;
                    } else if (status.type === 'image') {
                        statusContent = `<div class="w-12 h-12 rounded-full bg-cover bg-center" style="background-image: url('${status.content}')"></div>`;
                    } else if (status.type === 'video') {
                        statusContent = `<div class="w-12 h-12 rounded-full bg-gradient-to-r from-red-500 to-pink-500 flex items-center justify-center text-white"><i class="fas fa-video"></i></div>`;
                    } else if (status.type === 'audio') {
                        statusContent = `<div class="w-12 h-12 rounded-full bg-gradient-to-r from-orange-500 to-amber-500 flex items-center justify-center text-white"><i class="fas fa-music"></i></div>`;
                    }
                    
                    statusElement.innerHTML = `
                        ${statusContent}
                        <div>
                            <p class="font-medium">${currentUserData.displayName}</p>
                            <p class="text-sm text-gray-500">${formatTimeAgo(status.timestamp)}</p>
                        </div>
                    `;
                    
                    statusUpdates.appendChild(statusElement);
                });
            }
        }

        function formatTimeAgo(timestamp) {
            const now = new Date();
            const diffMs = now - new Date(timestamp);
            const diffMins = Math.floor(diffMs / 60000);
            const diffHours = Math.floor(diffMs / 3600000);
            const diffDays = Math.floor(diffMs / 86400000);
            
            if (diffMins < 1) return 'Just now';
            if (diffMins < 60) return `${diffMins}m ago`;
            if (diffHours < 24) return `${diffHours}h ago`;
            if (diffDays < 7) return `${diffDays}d ago`;
            return new Date(timestamp).toLocaleDateString();
        }

        function openStatusCreation() {
            statusCreation.style.display = 'flex';
            resetStatusCreation();
        }

        function resetStatusCreation() {
            // Reset all previews
            document.getElementById('emojiPreview').classList.remove('hidden');
            document.getElementById('textPreview').classList.add('hidden');
            document.getElementById('imagePreview').classList.add('hidden');
            document.getElementById('videoPreview').classList.add('hidden');
            document.getElementById('audioPreview').classList.add('hidden');
            
            // Reset active option
            document.querySelectorAll('.status-option').forEach(option => {
                option.classList.remove('active');
            });
            document.querySelector('.status-option[data-type="emoji"]').classList.add('active');
            
            // Reset content
            document.getElementById('emojiPreview').textContent = 'ðŸ˜Š';
            document.getElementById('statusTextInput').value = '';
            document.getElementById('statusImagePreview').classList.add('hidden');
            document.getElementById('statusVideoPreview').classList.add('hidden');
            document.getElementById('statusAudioPreview').classList.add('hidden');
        }

        async function uploadToCloudinary(file, resourceType = 'image') {
            return new Promise((resolve, reject) => {
                const formData = new FormData();
                formData.append('file', file);
                formData.append('upload_preset', cloudinaryConfig.uploadPreset);
                formData.append('cloud_name', cloudinaryConfig.cloudName);
                
                fetch(`https://api.cloudinary.com/v1_1/${cloudinaryConfig.cloudName}/${resourceType}/upload`, {
                    method: 'POST',
                    body: formData
                })
                .then(response => response.json())
                .then(data => {
                    if (data.secure_url) {
                        resolve(data.secure_url);
                    } else {
                        reject(new Error('Upload failed'));
                    }
                })
                .catch(error => {
                    reject(error);
                });
            });
        }

        async function postStatus(type, content) {
            try {
                let finalContent = content;
                
                // Handle file uploads to Cloudinary
                if (type === 'image' || type === 'video' || type === 'audio') {
                    showToast('Uploading media...', 'info');
                    
                    // For demo purposes, we'll use a placeholder
                    // In a real app, you would get the file and upload it
                    if (type === 'image') {
                        finalContent = 'https://res.cloudinary.com/dhjnxa5rh/image/upload/v1621234567/placeholder.jpg';
                    } else if (type === 'video') {
                        finalContent = 'https://res.cloudinary.com/dhjnxa5rh/video/upload/v1621234567/placeholder.mp4';
                    } else if (type === 'audio') {
                        finalContent = 'https://res.cloudinary.com/dhjnxa5rh/audio/upload/v1621234567/placeholder.mp3';
                    }
                }
                
                const newStatus = {
                    type: type,
                    content: finalContent,
                    timestamp: new Date().toISOString(),
                    userId: currentUser.uid,
                    userDisplayName: currentUserData.displayName,
                    userPhotoURL: currentUserData.photoURL
                };
                
                // Save to Firestore
                await db.collection('statuses').add(newStatus);
                
                // Save to localStorage for offline viewing
                const userStatuses = JSON.parse(localStorage.getItem('kynecta-statuses') || '[]');
                userStatuses.unshift(newStatus);
                localStorage.setItem('kynecta-statuses', JSON.stringify(userStatuses));
                
                // Update UI
                loadStatusUpdates();
                showToast('Status posted successfully', 'success');
            } catch (error) {
                console.error('Error posting status:', error);
                showToast('Error posting status', 'error');
            }
        }

        function loadContacts() {
            // Load contacts from Firebase
            db.collection('contacts')
                .where('userId', '==', currentUser.uid)
                .onSnapshot(snapshot => {
                    contacts = [];
                    snapshot.forEach(doc => {
                        contacts.push({ id: doc.id, ...doc.data() });
                    });
                    renderContacts(contacts);
                    
                    if (contacts.length === 0) {
                        document.getElementById('noContactsMessage').classList.remove('hidden');
                    } else {
                        document.getElementById('noContactsMessage').classList.add('hidden');
                    }
                });
        }

        function addNewContact(name, email, phone) {
            const newContact = {
                userId: currentUser.uid,
                name: name,
                email: email,
                phone: phone,
                status: "Online",
                createdAt: firebase.firestore.FieldValue.serverTimestamp()
            };
            
            // Add to Firebase
            db.collection('contacts').add(newContact)
                .then(() => {
                    showToast(`Contact ${name} added successfully`, 'success');
                })
                .catch(error => {
                    console.error('Error adding contact: ', error);
                    showToast('Error adding contact', 'error');
                });
        }

        function renderContacts(contactsToRender) {
            const contactsList = document.getElementById('contactsList');
            contactsList.innerHTML = '';
            
            contactsToRender.forEach(contact => {
                const contactItem = document.createElement('div');
                contactItem.className = 'contact-item';
                contactItem.dataset.contactId = contact.id;
                contactItem.innerHTML = `
                    <div class="contact-avatar">
                        <div class="w-12 h-12 rounded-full bg-gradient-to-r from-purple-500 to-green-500 flex items-center justify-center text-white font-bold">
                            ${contact.name.charAt(0)}
                        </div>
                        ${contact.status === 'Online' ? '<div class="online-indicator"></div>' : ''}
                    </div>
                    <div class="contact-info">
                        <div class="contact-name">${contact.name}</div>
                        <div class="contact-status">${contact.status}</div>
                    </div>
                    <div class="flex space-x-2">
                        <button class="w-10 h-10 rounded-full bg-purple-100 text-purple-600 flex items-center justify-center hover:bg-purple-200 transition-colors message-contact" data-name="${contact.name}" data-id="${contact.id}">
                            <i class="fas fa-comment"></i>
                        </button>
                        <button class="w-10 h-10 rounded-full bg-green-100 text-green-600 flex items-center justify-center hover:bg-green-200 transition-colors call-contact" data-name="${contact.name}" data-id="${contact.id}">
                            <i class="fas fa-phone"></i>
                        </button>
                    </div>
                `;
                
                contactsList.appendChild(contactItem);
            });

            // Add event listeners to message and call buttons
            document.querySelectorAll('.message-contact').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const contactId = e.currentTarget.dataset.id;
                    const contactName = e.currentTarget.dataset.name;
                    startChat(contactId, contactName);
                });
            });

            document.querySelectorAll('.call-contact').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const contactId = e.currentTarget.dataset.id;
                    const contactName = e.currentTarget.dataset.name;
                    startCall(contactId, contactName);
                });
            });
        }

        function searchContacts(query) {
            if (!query) {
                renderContacts(contacts);
                return;
            }
            
            const filteredContacts = contacts.filter(contact => 
                contact.name.toLowerCase().includes(query.toLowerCase()) ||
                contact.email.toLowerCase().includes(query.toLowerCase()) ||
                contact.phone.includes(query)
            );
            
            renderContacts(filteredContacts);
            
            if (filteredContacts.length === 0) {
                document.getElementById('noContactsMessage').classList.remove('hidden');
                document.getElementById('noContactsMessage').innerHTML = `
                    <i class="fas fa-search text-4xl mb-3 text-gray-300 block"></i>
                    <p>No contacts found</p>
                    <p class="text-sm mt-1">Try a different search term</p>
                `;
            } else {
                document.getElementById('noContactsMessage').classList.add('hidden');
            }
        }

        function startChat(contactId, contactName) {
            // Create or get chat ID
            const chatId = [currentUser.uid, contactId].sort().join('_');
            
            // Set current chat
            currentChat = {
                id: chatId,
                contactId: contactId,
                name: contactName
            };
            
            // Update UI
            document.getElementById('chatHeader').classList.remove('hidden');
            document.getElementById('inputArea').classList.remove('hidden');
            document.getElementById('noMessagesMessage').classList.add('hidden');
            document.getElementById('chatTitle').textContent = contactName;
            document.getElementById('chatAvatar').src = `https://ui-avatars.com/api/?name=${encodeURIComponent(contactName)}&background=7C3AED&color=fff`;
            
            // Enable message input
            document.getElementById('messageInput').disabled = false;
            document.getElementById('sendBtn').disabled = false;
            
            // Load messages
            loadMessages(chatId);
            
            // Hide contact list on mobile
            if (window.innerWidth < 768) {
                document.getElementById('chatListContainer').classList.add('hidden');
            }
        }

        function loadMessages(chatId) {
            // Unsubscribe from previous listener
            if (unsubscribeMessages) {
                unsubscribeMessages();
            }
            
            const messagesContainer = document.getElementById('messagesContainer');
            messagesContainer.innerHTML = '';
            
            // Subscribe to messages
            unsubscribeMessages = db.collection('chats')
                .doc(chatId)
                .collection('messages')
                .orderBy('timestamp', 'asc')
                .onSnapshot(snapshot => {
                    messagesContainer.innerHTML = '';
                    
                    if (snapshot.empty) {
                        messagesContainer.innerHTML = `
                            <div class="text-center text-gray-500 py-10">
                                <i class="fas fa-comments text-4xl mb-3 text-gray-300 block"></i>
                                <p>No messages yet</p>
                                <p class="text-sm mt-1">Send a message to start the conversation</p>
                            </div>
                        `;
                        return;
                    }
                    
                    snapshot.forEach(doc => {
                        const message = doc.data();
                        addMessageToUI(message, doc.id);
                    });
                    
                    // Scroll to bottom
                    setTimeout(() => {
                        messagesContainer.scrollTop = messagesContainer.scrollHeight;
                    }, 100);
                });
        }

        function addMessageToUI(message, messageId) {
            const messagesContainer = document.getElementById('messagesContainer');
            const messageElement = document.createElement('div');
            
            const isSent = message.senderId === currentUser.uid;
            const messageTime = message.timestamp ? message.timestamp.toDate().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }) : 'Just now';
            
            messageElement.className = `message-container ${isSent ? 'sent' : 'received'}`;
            messageElement.innerHTML = `
                <div class="message-bubble ${isSent ? 'message-sent' : 'message-received'}">
                    <div class="message-text">${message.text}</div>
                    <div class="message-time">${messageTime}</div>
                    ${isSent ? `<div class="message-status">${message.status || 'sent'}</div>` : ''}
                </div>
            `;
            
            messagesContainer.appendChild(messageElement);
        }

        function sendMessage() {
            const messageInput = document.getElementById('messageInput');
            const text = messageInput.value.trim();
            
            if (!text || !currentChat) return;
            
            const message = {
                text: text,
                senderId: currentUser.uid,
                senderName: currentUserData.displayName,
                timestamp: firebase.firestore.FieldValue.serverTimestamp(),
                status: 'sent'
            };
            
            // Add message to Firebase
            db.collection('chats')
                .doc(currentChat.id)
                .collection('messages')
                .add(message)
                .then(docRef => {
                    // Update message status to delivered
                    db.collection('chats')
                        .doc(currentChat.id)
                        .collection('messages')
                        .doc(docRef.id)
                        .update({
                            status: 'delivered'
                        });
                    
                    // Clear input
                    messageInput.value = '';
                    
                    // Update last message in chat
                    updateLastMessage(currentChat.id, text);
                })
                .catch(error => {
                    console.error('Error sending message: ', error);
                    showToast('Error sending message', 'error');
                });
        }

        function updateLastMessage(chatId, text) {
            db.collection('chats')
                .doc(chatId)
                .set({
                    lastMessage: text,
                    lastMessageTime: firebase.firestore.FieldValue.serverTimestamp(),
                    participants: [currentUser.uid, currentChat.contactId]
                }, { merge: true });
        }

        function startCall(contactId, contactName) {
            // For now, just show a toast notification
            showToast(`Calling ${contactName}...`, 'info');
            
            // In a real implementation, you would integrate with a WebRTC service
            // and show the call interface
        }

        function setupEventListeners() {
            // Settings button
            document.getElementById('menuBtn').addEventListener('click', () => {
                settingsModal.classList.remove('hidden');
            });

            // Close settings
            document.getElementById('closeSettings').addEventListener('click', () => {
                settingsModal.classList.add('hidden');
            });

            // Security settings
            document.getElementById('securitySettingsBtn').addEventListener('click', () => {
                settingsModal.classList.add('hidden');
                securitySettingsModal.classList.remove('hidden');
            });

            document.getElementById('closeSecuritySettings').addEventListener('click', () => {
                securitySettingsModal.classList.add('hidden');
                settingsModal.classList.remove('hidden');
                
                // Save security settings
                userSettings.security.notifications = document.getElementById('securityNotifications').checked;
                userSettings.security.passkeys = document.getElementById('passkeysEnabled').checked;
                saveUserSettings();
            });

            // Privacy settings
            document.getElementById('privacySettingsBtn').addEventListener('click', () => {
                settingsModal.classList.add('hidden');
                privacySettingsModal.classList.remove('hidden');
            });

            document.getElementById('closePrivacySettings').addEventListener('click', () => {
                privacySettingsModal.classList.add('hidden');
                settingsModal.classList.remove('hidden');
                
                // Save privacy settings
                userSettings.privacy.lastSeen = document.getElementById('lastSeenPrivacy').value;
                userSettings.privacy.profilePhoto = document.getElementById('profilePhotoPrivacy').value;
                userSettings.privacy.about = document.getElementById('aboutPrivacy').value;
                userSettings.privacy.status = document.getElementById('statusPrivacy').value;
                userSettings.privacy.readReceipts = document.getElementById('readReceipts').checked;
                userSettings.privacy.disappearingMessages = document.getElementById('disappearingMessages').value;
                userSettings.privacy.groups = document.getElementById('groupsPrivacy').value;
                userSettings.privacy.avatarStickers = document.getElementById('avatarStickers').checked;
                userSettings.privacy.calls = document.getElementById('callsPrivacy').value;
                userSettings.privacy.contact = document.getElementById('contactPrivacy').value;
                userSettings.privacy.appLock = document.getElementById('appLock').checked;
                userSettings.privacy.cameraEffects = document.getElementById('cameraEffects').checked;
                saveUserSettings();
            });

            // Avatar settings
            document.getElementById('avatarSettingsBtn').addEventListener('click', () => {
                settingsModal.classList.add('hidden');
                avatarSettingsModal.classList.remove('hidden');
            });

            document.getElementById('closeAvatarSettings').addEventListener('click', () => {
                avatarSettingsModal.classList.add('hidden');
                settingsModal.classList.remove('hidden');
            });

            // Profile photo edit
            document.getElementById('editAvatarBtn').addEventListener('click', () => {
                avatarSettingsModal.classList.add('hidden');
                profilePhotoModal.classList.remove('hidden');
            });

            document.getElementById('closeProfilePhoto').addEventListener('click', () => {
                profilePhotoModal.classList.add('hidden');
                avatarSettingsModal.classList.remove('hidden');
            });

            // Profile photo upload
            document.getElementById('profileUpload').addEventListener('change', async (e) => {
                const file = e.target.files[0];
                if (file) {
                    try {
                        showToast('Uploading profile photo...', 'info');
                        
                        // Upload to Cloudinary
                        const imageUrl = await uploadToCloudinary(file, 'image');
                        
                        // Update Firebase user profile
                        await updateUserProfile({ photoURL: imageUrl });
                        
                        // Update UI
                        document.getElementById('userAvatar').src = imageUrl;
                        currentUserData.photoURL = imageUrl;
                        
                        showToast('Profile photo updated successfully', 'success');
                    } catch (error) {
                        console.error('Error uploading profile photo:', error);
                        showToast('Error uploading profile photo', 'error');
                    }
                }
            });

            // Cover photo upload
            document.getElementById('coverUpload').addEventListener('change', async (e) => {
                const file = e.target.files[0];
                if (file) {
                    try {
                        showToast('Uploading cover photo...', 'info');
                        
                        // Upload to Cloudinary
                        const imageUrl = await uploadToCloudinary(file, 'image');
                        
                        // Update UI
                        document.querySelector('.profile-cover').style.backgroundImage = `url(${imageUrl})`;
                        
                        showToast('Cover photo updated successfully', 'success');
                    } catch (error) {
                        console.error('Error uploading cover photo:', error);
                        showToast('Error uploading cover photo', 'error');
                    }
                }
            });

            // Favorites settings
            document.getElementById('favoritesSettingsBtn').addEventListener('click', () => {
                settingsModal.classList.add('hidden');
                favoritesSettingsModal.classList.remove('hidden');
                loadFavoritesSettings();
            });

            document.getElementById('closeFavoritesSettings').addEventListener('click', () => {
                favoritesSettingsModal.classList.add('hidden');
                settingsModal.classList.remove('hidden');
            });

            // Chat settings
            document.getElementById('chatsSettingsBtn').addEventListener('click', () => {
                settingsModal.classList.add('hidden');
                chatSettingsModal.classList.remove('hidden');
            });

            document.getElementById('closeChatSettings').addEventListener('click', () => {
                chatSettingsModal.classList.add('hidden');
                settingsModal.classList.remove('hidden');
                
                // Save chat settings
                userSettings.chat.displayTheme = document.getElementById('displayTheme').value;
                userSettings.chat.defaultChatTheme = document.getElementById('defaultChatTheme').value;
                userSettings.chat.fontSize = document.getElementById('fontSize').value;
                userSettings.chat.enterKeySends = document.getElementById('enterKeySends').checked;
                userSettings.chat.mediaVisibility = document.getElementById('mediaVisibility').checked;
                saveUserSettings();
                applyUserSettings();
            });

            // Notifications settings
            document.getElementById('notificationsSettingsBtn').addEventListener('click', () => {
                settingsModal.classList.add('hidden');
                notificationsSettingsModal.classList.remove('hidden');
            });

            document.getElementById('closeNotificationsSettings').addEventListener('click', () => {
                notificationsSettingsModal.classList.add('hidden');
                settingsModal.classList.remove('hidden');
                
                // Save notification settings
                userSettings.notifications.conversationTones = document.getElementById('conversationTones').checked;
                userSettings.notifications.reminders = document.getElementById('reminders').checked;
                userSettings.notifications.vibrate = document.getElementById('vibrate').checked;
                userSettings.notifications.notificationLight = document.getElementById('notificationLight').checked;
                userSettings.notifications.highPriorityNotifications = document.getElementById('highPriorityNotifications').checked;
                userSettings.notifications.reactionNotifications = document.getElementById('reactionNotifications').checked;
                
                // Save notification light color
                const activeColor = document.querySelector('.color-option.active');
                if (activeColor) {
                    userSettings.notifications.lightColor = activeColor.dataset.color;
                }
                
                saveUserSettings();
            });

            // Storage settings
            document.getElementById('storageSettingsBtn').addEventListener('click', () => {
                settingsModal.classList.add('hidden');
                storageSettingsModal.classList.remove('hidden');
            });

            document.getElementById('closeStorageSettings').addEventListener('click', () => {
                storageSettingsModal.classList.add('hidden');
                settingsModal.classList.remove('hidden');
                
                // Save storage settings
                userSettings.storage.lessDataCalls = document.getElementById('lessDataCalls').checked;
                userSettings.storage.proxyEnabled = document.getElementById('proxyEnabled').checked;
                userSettings.storage.mediaUploadQuality = document.getElementById('mediaUploadQuality').value;
                userSettings.storage.autoDownloadQuality = document.getElementById('autoDownloadQuality').value;
                saveUserSettings();
            });

            // Accessibility settings
            document.getElementById('accessibilityBtn').addEventListener('click', () => {
                settingsModal.classList.add('hidden');
                accessibilityModal.classList.remove('hidden');
            });

            document.getElementById('closeAccessibility').addEventListener('click', () => {
                accessibilityModal.classList.add('hidden');
                settingsModal.classList.remove('hidden');
                
                // Save accessibility settings
                userSettings.accessibility.largeText = document.getElementById('largeText').checked;
                userSettings.accessibility.highContrast = document.getElementById('highContrast').checked;
                userSettings.accessibility.screenReader = document.getElementById('screenReader').checked;
                userSettings.accessibility.reducedMotion = document.getElementById('reducedMotion').checked;
                userSettings.accessibility.voiceControl = document.getElementById('voiceControl').checked;
                saveUserSettings();
            });

            // Language settings
            document.getElementById('languageSettingsBtn').addEventListener('click', () => {
                settingsModal.classList.add('hidden');
                languageSettingsModal.classList.remove('hidden');
            });

            document.getElementById('closeLanguageSettings').addEventListener('click', () => {
                languageSettingsModal.classList.add('hidden');
                settingsModal.classList.remove('hidden');
                
                // Save language settings
                userSettings.language.appLanguage = document.getElementById('appLanguage').value;
                saveUserSettings();
                showToast('Language settings saved. App restart required for changes to take effect.', 'success');
            });

            // Help & Support
            document.getElementById('helpCenterBtn').addEventListener('click', () => {
                settingsModal.classList.add('hidden');
                helpSupportModal.classList.remove('hidden');
            });

            document.getElementById('contactUsBtn').addEventListener('click', () => {
                settingsModal.classList.add('hidden');
                helpSupportModal.classList.remove('hidden');
            });

            document.getElementById('appInfoBtn').addEventListener('click', () => {
                settingsModal.classList.add('hidden');
                helpSupportModal.classList.remove('hidden');
            });

            document.getElementById('closeHelpSupport').addEventListener('click', () => {
                helpSupportModal.classList.add('hidden');
                settingsModal.classList.remove('hidden');
            });

            // Invite contact
            document.getElementById('inviteContactBtn').addEventListener('click', () => {
                settingsModal.classList.add('hidden');
                inviteContactModal.classList.remove('hidden');
            });

            document.getElementById('closeInviteContact').addEventListener('click', () => {
                inviteContactModal.classList.add('hidden');
                settingsModal.classList.remove('hidden');
            });

            // Share invite link
            document.getElementById('shareLinkBtn').addEventListener('click', () => {
                navigator.clipboard.writeText('https://kynecta.app/invite/denis-chacha');
                showToast('Invite link copied to clipboard', 'success');
            });

            // Add contact button
            document.getElementById('addContactBtn').addEventListener('click', () => {
                addContactModal.classList.remove('hidden');
            });

            // Save contact
            document.getElementById('saveContact').addEventListener('click', () => {
                const name = document.getElementById('contactName').value.trim();
                const email = document.getElementById('contactEmail').value.trim();
                const phone = document.getElementById('contactPhone').value.trim();
                
                if (name && (email || phone)) {
                    addNewContact(name, email, phone);
                    addContactModal.classList.add('hidden');
                    // Clear form
                    document.getElementById('contactName').value = '';
                    document.getElementById('contactEmail').value = '';
                    document.getElementById('contactPhone').value = '';
                } else {
                    showToast('Please enter at least a name and either email or phone number', 'error');
                }
            });

            // Cancel contact
            document.getElementById('cancelContact').addEventListener('click', () => {
                addContactModal.classList.add('hidden');
                // Clear form
                document.getElementById('contactName').value = '';
                document.getElementById('contactEmail').value = '';
                document.getElementById('contactPhone').value = '';
            });

            // Contact search
            document.getElementById('contactSearch').addEventListener('input', (e) => {
                searchContacts(e.target.value);
            });

            // Status creation
            document.getElementById('myStatus').addEventListener('click', openStatusCreation);

            document.getElementById('closeStatusCreation').addEventListener('click', () => {
                statusCreation.style.display = 'none';
            });

            // Status type selection
            document.querySelectorAll('.status-option').forEach(option => {
                option.addEventListener('click', (e) => {
                    const type = e.currentTarget.dataset.type;
                    
                    // Update active option
                    document.querySelectorAll('.status-option').forEach(opt => {
                        opt.classList.remove('active');
                    });
                    e.currentTarget.classList.add('active');
                    
                    // Show corresponding preview
                    document.getElementById('emojiPreview').classList.add('hidden');
                    document.getElementById('textPreview').classList.add('hidden');
                    document.getElementById('imagePreview').classList.add('hidden');
                    document.getElementById('videoPreview').classList.add('hidden');
                    document.getElementById('audioPreview').classList.add('hidden');
                    
                    document.getElementById(`${type}Preview`).classList.remove('hidden');
                });
            });

            // Post status
            document.getElementById('postStatus').addEventListener('click', () => {
                const activeType = document.querySelector('.status-option.active').dataset.type;
                let content = '';
                
                if (activeType === 'emoji') {
                    content = document.getElementById('emojiPreview').textContent;
                } else if (activeType === 'text') {
                    content = document.getElementById('statusTextInput').value.trim();
                    if (!content) {
                        showToast('Please enter some text for your status', 'error');
                        return;
                    }
                } else if (activeType === 'image') {
                    if (document.getElementById('statusImagePreview').classList.contains('hidden')) {
                        showToast('Please upload an image for your status', 'error');
                        return;
                    }
                    content = document.getElementById('statusImagePreview').src;
                } else if (activeType === 'video') {
                    if (document.getElementById('statusVideoPreview').classList.contains('hidden')) {
                        showToast('Please upload a video for your status', 'error');
                        return;
                    }
                    content = document.getElementById('statusVideoPreview').src;
                } else if (activeType === 'audio') {
                    if (document.getElementById('statusAudioPreview').classList.contains('hidden')) {
                        showToast('Please upload an audio for your status', 'error');
                        return;
                    }
                    content = document.getElementById('statusAudioPreview').src;
                }
                
                postStatus(activeType, content);
                statusCreation.style.display = 'none';
            });

            // Upload image for status
            document.getElementById('uploadImageBtn').addEventListener('click', () => {
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = 'image/*';
                
                input.onchange = (e) => {
                    const file = e.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = (event) => {
                            document.getElementById('statusImagePreview').src = event.target.result;
                            document.getElementById('statusImagePreview').classList.remove('hidden');
                        };
                        reader.readAsDataURL(file);
                    }
                };
                
                input.click();
            });

            // Upload video for status
            document.getElementById('uploadVideoBtn').addEventListener('click', () => {
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = 'video/*';
                
                input.onchange = (e) => {
                    const file = e.target.files[0];
                    if (file) {
                        // Check if video is longer than 6 seconds
                        const video = document.createElement('video');
                        video.preload = 'metadata';
                        
                        video.onloadedmetadata = () => {
                            if (video.duration > 6) {
                                showToast('Video must be 6 seconds or shorter', 'error');
                                return;
                            }
                            
                            const reader = new FileReader();
                            reader.onload = (event) => {
                                document.getElementById('statusVideoPreview').src = event.target.result;
                                document.getElementById('statusVideoPreview').classList.remove('hidden');
                            };
                            reader.readAsDataURL(file);
                        };
                        
                        video.src = URL.createObjectURL(file);
                    }
                };
                
                input.click();
            });

            // Upload audio for status
            document.getElementById('uploadAudioBtn').addEventListener('click', () => {
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = 'audio/*';
                
                input.onchange = (e) => {
                    const file = e.target.files[0];
                    if (file) {
                        // Check if audio is longer than 6 seconds
                        const audio = document.createElement('audio');
                        audio.preload = 'metadata';
                        
                        audio.onloadedmetadata = () => {
                            if (audio.duration > 6) {
                                showToast('Audio must be 6 seconds or shorter', 'error');
                                return;
                            }
                            
                            const reader = new FileReader();
                            reader.onload = (event) => {
                                document.getElementById('statusAudioPreview').src = event.target.result;
                                document.getElementById('statusAudioPreview').classList.remove('hidden');
                            };
                            reader.readAsDataURL(file);
                        };
                        
                        audio.src = URL.createObjectURL(file);
                    }
                };
                
                input.click();
            });

            // Color picker for notification light
            document.querySelectorAll('.color-option').forEach(option => {
                option.addEventListener('click', (e) => {
                    document.querySelectorAll('.color-option').forEach(opt => {
                        opt.classList.remove('active');
                    });
                    e.currentTarget.classList.add('active');
                });
            });

            // Business tools
            document.getElementById('catalogueBtn').addEventListener('click', () => {
                catalogueModal.classList.remove('hidden');
            });

            document.getElementById('closeCatalogue').addEventListener('click', () => {
                catalogueModal.classList.add('hidden');
            });

            document.getElementById('advertiseBtn').addEventListener('click', () => {
                advertiseModal.classList.remove('hidden');
            });

            document.getElementById('closeAdvertise').addEventListener('click', () => {
                advertiseModal.classList.add('hidden');
            });

            document.getElementById('labelsBtn').addEventListener('click', () => {
                labelsModal.classList.remove('hidden');
            });

            document.getElementById('closeLabels').addEventListener('click', () => {
                labelsModal.classList.add('hidden');
            });

            document.getElementById('greetingBtn').addEventListener('click', () => {
                greetingModal.classList.remove('hidden');
            });

            document.getElementById('closeGreeting').addEventListener('click', () => {
                greetingModal.classList.add('hidden');
            });

            document.getElementById('awayBtn').addEventListener('click', () => {
                awayModal.classList.remove('hidden');
            });

            document.getElementById('closeAway').addEventListener('click', () => {
                awayModal.classList.add('hidden');
            });

            // Quick actions
            document.getElementById('privacyBtn').addEventListener('click', () => {
                settingsModal.classList.remove('hidden');
                setTimeout(() => {
                    document.getElementById('privacySettingsBtn').click();
                }, 100);
            });

            document.getElementById('settingsBtn').addEventListener('click', () => {
                settingsModal.classList.remove('hidden');
            });

            document.getElementById('storageBtn').addEventListener('click', () => {
                settingsModal.classList.remove('hidden');
                setTimeout(() => {
                    document.getElementById('storageSettingsBtn').click();
                }, 100);
            });

            document.getElementById('inviteBtn').addEventListener('click', () => {
                settingsModal.classList.remove('hidden');
                setTimeout(() => {
                    document.getElementById('inviteContactBtn').click();
                }, 100);
            });

            // AI features
            document.getElementById('aiSummarize').addEventListener('click', () => {
                if (currentChat) {
                    showToast('Generating conversation summary...', 'info');
                    // In a real app, this would call an AI service
                    setTimeout(() => {
                        showToast('Conversation summary ready', 'success');
                    }, 2000);
                } else {
                    showToast('Please select a chat first', 'error');
                }
            });

            document.getElementById('aiReply').addEventListener('click', () => {
                if (currentChat) {
                    showToast('Generating smart reply suggestions...', 'info');
                    // In a real app, this would call an AI service
                    setTimeout(() => {
                        showToast('Smart reply suggestions ready', 'success');
                    }, 2000);
                } else {
                    showToast('Please select a chat first', 'error');
                }
            });

            // Theme toggle
            document.getElementById('themeToggle').addEventListener('click', () => {
                const currentTheme = document.body.getAttribute('data-theme');
                setTheme(currentTheme === 'light' ? 'dark' : 'light');
            });

            // Tab switching
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const tab = e.currentTarget.dataset.tab;
                    
                    // Update active tab
                    document.querySelectorAll('.tab-btn').forEach(b => {
                        b.classList.remove('tab-active', 'text-purple-600');
                        b.classList.add('text-gray-500');
                    });
                    
                    e.currentTarget.classList.add('tab-active', 'text-purple-600');
                    e.currentTarget.classList.remove('text-gray-500');
                    
                    // Show corresponding tab content
                    document.querySelectorAll('.tab-panel').forEach(panel => {
                        panel.classList.add('hidden');
                    });
                    
                    document.getElementById(`${tab}Tab`).classList.remove('hidden');
                });
            });

            // Video conference
            document.getElementById('newGroupBtn').addEventListener('click', () => {
                videoConferenceModal.classList.remove('hidden');
            });

            document.getElementById('cancelConference').addEventListener('click', () => {
                videoConferenceModal.classList.add('hidden');
            });

            document.getElementById('startConference').addEventListener('click', () => {
                const conferenceName = document.getElementById('conferenceName').value;
                if (conferenceName.trim()) {
                    videoConferenceModal.classList.add('hidden');
                    startVideoConference(conferenceName);
                } else {
                    showToast('Please enter a conference name', 'error');
                }
            });

            // Logout
            document.getElementById('logoutBtn').addEventListener('click', () => {
                showToast('Logging out...', 'info');
                auth.signOut().then(() => {
                    window.location.href = 'login.html';
                });
            });

            // Back to chats on mobile
            document.getElementById('backToChats').addEventListener('click', () => {
                document.getElementById('chatListContainer').classList.remove('hidden');
            });

            // Mood options
            document.querySelectorAll('.mood-option').forEach(option => {
                option.addEventListener('click', (e) => {
                    const mood = e.currentTarget.dataset.mood;
                    const moodNames = {
                        happy: 'Happy',
                        calm: 'Calm',
                        energetic: 'Energetic',
                        focused: 'Focused',
                        creative: 'Creative'
                    };
                    
                    // Update all mood options
                    document.querySelectorAll('.mood-option').forEach(opt => {
                        opt.classList.remove('border-purple-500', 'text-purple-600', 'bg-purple-50');
                    });
                    
                    // Highlight selected mood
                    e.currentTarget.classList.add('border-purple-500', 'text-purple-600', 'bg-purple-50');
                    
                    showToast(`Mood set to ${moodNames[mood]}`, 'success');
                    
                    // Show mood suggestion
                    const suggestion = document.getElementById('moodSuggestion');
                    const suggestionText = document.getElementById('suggestionText');
                    
                    const suggestions = {
                        happy: "Your positive mood might be perfect for sharing exciting news or planning fun activities!",
                        calm: "Your calm demeanor is great for having deep, meaningful conversations.",
                        energetic: "Your energetic vibe could help motivate others or brainstorm new ideas!",
                        focused: "Your focused mindset is perfect for discussing important topics or making decisions.",
                        creative: "Your creative mood is ideal for sharing ideas or working on projects together!"
                    };
                    
                    suggestionText.textContent = suggestions[mood];
                    suggestion.classList.remove('hidden');
                });
            });

            // Dismiss suggestion
            document.getElementById('dismissSuggestion').addEventListener('click', () => {
                document.getElementById('moodSuggestion').classList.add('hidden');
            });

            // File attachment
            document.getElementById('attachBtn').addEventListener('click', () => {
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = 'image/*,video/*,.pdf,.doc,.docx,.txt';
                
                input.onchange = (e) => {
                    const file = e.target.files[0];
                    if (file) {
                        showToast(`"${file.name}" selected for sharing`, 'info');
                        // In a real app, you would handle the file upload here
                    }
                };
                
                input.click();
            });

            // Send message on Enter key
            document.getElementById('messageInput').addEventListener('keypress', (e) => {
                if (e.key === 'Enter' && userSettings.chat.enterKeySends) {
                    sendMessage();
                }
            });

            // Send message on button click
            document.getElementById('sendBtn').addEventListener('click', sendMessage);

            // Responsive behavior
            window.addEventListener('resize', () => {
                if (window.innerWidth >= 768 && currentChat) {
                    document.getElementById('chatListContainer').classList.remove('hidden');
                }
            });
        }

        function loadFavoritesSettings() {
            const favoritesList = document.getElementById('favoritesListSettings');
            const noFavoritesMessage = document.getElementById('noFavoritesMessage');
            
            if (userSettings.favorites.length === 0) {
                favoritesList.classList.add('hidden');
                noFavoritesMessage.classList.remove('hidden');
            } else {
                favoritesList.classList.remove('hidden');
                noFavoritesMessage.classList.add('hidden');
                
                favoritesList.innerHTML = '';
                userSettings.favorites.forEach(favorite => {
                    const favoriteItem = document.createElement('div');
                    favoriteItem.className = 'flex items-center justify-between p-3 rounded-xl hover:bg-gray-50 transition-colors';
                    
                    favoriteItem.innerHTML = `
                        <div class="flex items-center space-x-3">
                            <div class="w-10 h-10 rounded-full bg-gradient-to-r from-purple-500 to-green-500 flex items-center justify-center text-white font-bold">
                                ${favorite.name.charAt(0)}
                            </div>
                            <div>
                                <p class="font-medium">${favorite.name}</p>
                                <p class="text-sm text-gray-500">${favorite.type}</p>
                            </div>
                        </div>
                        <button class="text-red-500 remove-favorite" data-id="${favorite.id}">
                            <i class="fas fa-trash"></i>
                        </button>
                    `;
                    
                    favoritesList.appendChild(favoriteItem);
                });
                
                // Add event listeners to remove buttons
                document.querySelectorAll('.remove-favorite').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const id = e.currentTarget.dataset.id;
                        userSettings.favorites = userSettings.favorites.filter(f => f.id !== id);
                        saveUserSettings();
                        loadFavoritesSettings();
                        showToast('Favorite removed', 'success');
                    });
                });
            }
        }

        function startVideoConference(name) {
            document.getElementById('videoConference').style.display = 'block';
            
            // Add current user to conference
            const conferenceGrid = document.getElementById('conferenceGrid');
            conferenceGrid.innerHTML = '';
            
            const userVideo = document.createElement('div');
            userVideo.className = 'participant-video';
            userVideo.innerHTML = `
                <video autoplay muted class="w-full h-full object-cover rounded-lg"></video>
                <div class="participant-name">${currentUserData.displayName} (You)</div>
            `;
            conferenceGrid.appendChild(userVideo);
            
            showToast(`Starting video conference: ${name}`, 'info');
            
            // Simulate adding participants after a delay
            setTimeout(() => {
                const participants = ['Alex Johnson', 'Sam Wilson', 'Taylor Swift'];
                
                participants.forEach(participant => {
                    const participantVideo = document.createElement('div');
                    participantVideo.className = 'participant-video';
                    participantVideo.innerHTML = `
                        <div class="w-full h-full bg-gray-800 rounded-lg flex items-center justify-center">
                            <div class="w-16 h-16 rounded-full bg-gradient-to-r from-purple-500 to-green-500 flex items-center justify-center text-white text-xl font-bold">
                                ${participant.charAt(0)}
                            </div>
                        </div>
                        <div class="participant-name">${participant}</div>
                    `;
                    conferenceGrid.appendChild(participantVideo);
                });
                
                showToast('Participants joined the conference', 'success');
            }, 2000);
        }

        async function updateUserProfile(updates) {
            try {
                // Update Firebase Authentication profile
                await currentUser.updateProfile(updates);
                
                // Update Firestore user document
                await db.collection('users').doc(currentUser.uid).update(updates);
                
                // Update local user data
                currentUserData = { ...currentUserData, ...updates };
                
                return true;
            } catch (error) {
                console.error('Error updating profile:', error);
                showToast('Error updating profile', 'error');
                return false;
            }
        }

        // End conference
        document.getElementById('conferenceEndBtn').addEventListener('click', () => {
            document.getElementById('videoConference').style.display = 'none';
            showToast('Conference ended', 'info');
        });
    </script>
</body>
</html>