[file name]: marketplace.html
[file content begin]
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UniConnect Marketplace</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-storage-compat.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #8b5cf6;
            --accent: #06d6a0;
            --background: #f8fafc;
            --surface: #ffffff;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --border: #e2e8f0;
        }
        
        [data-theme="dark"] {
            --primary: #818cf8;
            --primary-dark: #6366f1;
            --secondary: #a78bfa;
            --accent: #34d399;
            --background: #0f172a;
            --surface: #1e293b;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --border: #334155;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--background);
            color: var(--text-primary);
            transition: all 0.3s ease;
        }
        
        .glass-card {
            background: var(--surface);
            border: 1px solid var(--border);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            border-radius: 12px;
        }
        
        .hover-lift {
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        
        .hover-lift:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .notification {
            position: fixed;
            top: 1rem;
            right: 1rem;
            padding: 1rem 1.5rem;
            border-radius: 0.75rem;
            z-index: 1000;
            max-width: 300px;
            transform: translateX(400px);
            transition: transform 0.3s ease;
            background: var(--surface);
            border: 1px solid var(--border);
            color: var(--text-primary);
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .modal.active {
            opacity: 1;
            visibility: visible;
        }
        
        .modal-content {
            background: var(--surface);
            border-radius: 1rem;
            padding: 2rem;
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            transform: scale(0.9);
            transition: transform 0.3s ease;
            color: var(--text-primary);
        }
        
        .modal.active .modal-content {
            transform: scale(1);
        }
        
        .tab-button {
            padding: 0.75rem 1.5rem;
            border-radius: 0.75rem;
            font-weight: 600;
            transition: all 0.3s ease;
            cursor: pointer;
            color: var(--text-secondary);
        }
        
        .tab-button.active {
            background: var(--primary);
            color: white;
        }
        
        .content-area {
            display: none;
        }
        
        .content-area.active {
            display: block;
        }
        
        .auction-timer {
            font-family: monospace;
            font-size: 1.25rem;
            font-weight: bold;
            color: #ef4444;
        }
        
        .hot-deal-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #ef4444;
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 1rem;
            font-size: 0.75rem;
            font-weight: bold;
            z-index: 10;
        }
        
        .discount-badge {
            position: absolute;
            top: 10px;
            left: 10px;
            background: #10b981;
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 1rem;
            font-size: 0.75rem;
            font-weight: bold;
            z-index: 10;
        }
        
        .image-upload-area {
            border: 2px dashed var(--border);
            border-radius: 0.75rem;
            padding: 2rem;
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .image-upload-area.dragover {
            border-color: var(--primary);
            background: rgba(99, 102, 241, 0.05);
        }
        
        .image-preview {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 0.5rem;
            margin-top: 1rem;
        }
        
        .image-preview-item {
            position: relative;
            border-radius: 0.5rem;
            overflow: hidden;
        }
        
        .image-preview-item img {
            width: 100%;
            height: 100px;
            object-fit: cover;
        }
        
        .image-preview-item .remove {
            position: absolute;
            top: 5px;
            right: 5px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 0.75rem;
        }
        
        .verified-badge {
            display: inline-flex;
            align-items: center;
            background: var(--accent);
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 1rem;
            font-size: 0.75rem;
            font-weight: 600;
            margin-left: 0.5rem;
        }
        
        .countdown-timer {
            font-family: monospace;
            font-weight: bold;
            color: #ef4444;
            background: rgba(239, 68, 68, 0.1);
            padding: 0.5rem;
            border-radius: 0.5rem;
            display: inline-block;
        }
        
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--surface);
            border-top: 1px solid var(--border);
            display: flex;
            justify-content: space-around;
            padding: 0.75rem 0;
            z-index: 100;
        }
        
        .bottom-nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            color: var(--text-secondary);
            font-size: 0.75rem;
        }
        
        .bottom-nav-item.active {
            color: var(--primary);
        }
        
        .bottom-nav-item i {
            font-size: 1.25rem;
            margin-bottom: 0.25rem;
        }
        
        .product-card {
            transition: all 0.3s ease;
        }
        
        .product-card:hover .secondary-image {
            opacity: 1;
        }
        
        .secondary-image {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .quick-actions {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .product-card:hover .quick-actions {
            opacity: 1;
        }
        
        .quick-action-btn {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 50%;
            width: 2rem;
            height: 2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-primary);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            transition: all 0.2s ease;
        }
        
        .quick-action-btn:hover {
            background: white;
            transform: scale(1.1);
        }
        
        .quick-action-btn.active {
            color: #ef4444;
        }
        
        .carousel {
            position: relative;
            overflow: hidden;
            border-radius: 1rem;
        }
        
        .carousel-inner {
            display: flex;
            transition: transform 0.5s ease;
        }
        
        .carousel-item {
            min-width: 100%;
            position: relative;
        }
        
        .carousel-item img {
            width: 100%;
            height: 300px;
            object-fit: cover;
        }
        
        .carousel-caption {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(transparent, rgba(0,0,0,0.7));
            color: white;
            padding: 1.5rem;
        }
        
        .carousel-control {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(0,0,0,0.5);
            color: white;
            border: none;
            width: 3rem;
            height: 3rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 10;
        }
        
        .carousel-control.prev {
            left: 1rem;
        }
        
        .carousel-control.next {
            right: 1rem;
        }
        
        .theme-toggle {
            position: relative;
            width: 60px;
            height: 30px;
            background: var(--border);
            border-radius: 15px;
            cursor: pointer;
            display: flex;
            align-items: center;
            padding: 0 5px;
            transition: background 0.3s ease;
        }
        
        .theme-toggle.active {
            background: var(--primary);
        }
        
        .theme-toggle-handle {
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            transition: transform 0.3s ease;
        }
        
        .theme-toggle.active .theme-toggle-handle {
            transform: translateX(30px);
        }
        
        .suggestion-tag {
            display: inline-block;
            background: var(--primary);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 1rem;
            font-size: 0.75rem;
            margin-right: 0.5rem;
            margin-bottom: 0.5rem;
            cursor: pointer;
        }
        
        .list-view .product-card {
            display: flex;
            gap: 1rem;
        }
        
        .list-view .product-image {
            width: 150px;
            height: 150px;
            flex-shrink: 0;
        }
        
        .list-view .product-details {
            flex: 1;
        }
        
        @media (max-width: 768px) {
            .list-view .product-card {
                flex-direction: column;
            }
            
            .list-view .product-image {
                width: 100%;
                height: 200px;
            }
        }

        .loading-spinner {
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top: 2px solid #3B82F6;
            width: 16px;
            height: 16px;
            animation: spin 1s linear infinite;
            display: inline-block;
            margin-left: 8px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="min-h-screen pb-16">
    <!-- Navigation -->
    <nav class="bg-white shadow-sm border-b dark:bg-slate-800 dark:border-slate-700">
        <div class="container mx-auto px-4">
            <div class="flex justify-between items-center py-4">
                <div class="flex items-center space-x-2">
                    <div class="bg-indigo-600 p-2 rounded-lg">
                        <i class="fas fa-store text-white text-xl"></i>
                    </div>
                    <h1 class="text-xl font-bold text-gray-900 dark:text-white">UniConnect Marketplace</h1>
                </div>
                
                <div class="hidden md:flex space-x-6">
                    <a href="#" class="text-gray-700 hover:text-indigo-600 dark:text-gray-300 dark:hover:text-white font-medium transition">Home</a>
                    <a href="#" id="discoverLink" class="text-gray-700 hover:text-indigo-600 dark:text-gray-300 dark:hover:text-white font-medium transition">Discover</a>
                    <a href="#" id="categoriesLink" class="text-gray-700 hover:text-indigo-600 dark:text-gray-300 dark:hover:text-white font-medium transition">Categories</a>
                    <a href="#" id="sellersLink" class="text-gray-700 hover:text-indigo-600 dark:text-gray-300 dark:hover:text-white font-medium transition">Sellers</a>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="relative hidden md:block">
                        <input type="text" id="searchInput" placeholder="Search products..." class="pl-10 pr-4 py-2 border border-gray-300 dark:border-slate-600 dark:bg-slate-700 dark:text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent w-64">
                        <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
                        <div id="searchSuggestions" class="absolute top-full left-0 right-0 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 rounded-lg mt-1 shadow-lg z-10 hidden">
                            <!-- Search suggestions will appear here -->
                        </div>
                    </div>
                    
                    <div class="flex items-center space-x-2">
                        <div class="theme-toggle" id="themeToggle">
                            <div class="theme-toggle-handle"></div>
                        </div>
                        
                        <button id="createListingBtn" class="bg-indigo-600 text-white px-4 py-2 rounded-lg font-semibold hover:bg-indigo-700 transition flex items-center space-x-2">
                            <i class="fas fa-plus"></i>
                            <span>List Item</span>
                        </button>
                        
                        <div class="relative">
                            <button id="cartBtn" class="p-2 text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white rounded-full hover:bg-gray-100 dark:hover:bg-slate-700 transition">
                                <i class="fas fa-shopping-cart"></i>
                            </button>
                            <span id="cartCount" class="absolute -top-1 -right-1 bg-indigo-600 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center hidden">0</span>
                        </div>
                        
                        <div class="relative">
                            <button id="notificationBtn" class="p-2 text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white rounded-full hover:bg-gray-100 dark:hover:bg-slate-700 transition">
                                <i class="far fa-bell"></i>
                            </button>
                            <span id="notificationCount" class="absolute -top-1 -right-1 bg-indigo-600 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center hidden">0</span>
                        </div>
                        
                        <div class="flex items-center space-x-2 ml-2">
                            <img id="userAvatar" src="https://ui-avatars.com/api/?name=User&background=6366f1&color=fff&size=40" alt="User" class="w-10 h-10 rounded-full object-cover">
                            <div class="hidden md:block">
                                <p id="userName" class="text-sm font-medium text-gray-900 dark:text-white">Loading...</p>
                                <p id="userStatus" class="text-xs text-gray-500 dark:text-gray-400">Student</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8">
        <!-- Hero Section with Carousel -->
        <section class="mb-8">
            <div class="carousel rounded-xl overflow-hidden">
                <div class="carousel-inner">
                    <div class="carousel-item">
                        <img src="https://images.unsplash.com/photo-1563013544-824ae1b704d3?ixlib=rb-1.2.1&auto=format&fit=crop&w=1200&q=80" alt="Marketplace Banner">
                        <div class="carousel-caption">
                            <h2 class="text-2xl font-bold">Welcome to UniConnect Marketplace</h2>
                            <p class="text-lg">Buy and sell within your university community</p>
                        </div>
                    </div>
                    <div class="carousel-item">
                        <img src="https://images.unsplash.com/photo-1556742049-0cfed4f6a45d?ixlib=rb-1.2.1&auto=format&fit=crop&w=1200&q=80" alt="Hot Deals">
                        <div class="carousel-caption">
                            <h2 class="text-2xl font-bold">Hot Deals</h2>
                            <p class="text-lg">Check out our trending items with special discounts</p>
                        </div>
                    </div>
                    <div class="carousel-item">
                        <img src="https://images.unsplash.com/photo-1560472354-b33ff0c44a43?ixlib=rb-1.2.1&auto=format&fit=crop&w=1200&q=80" alt="Flash Sale">
                        <div class="carousel-caption">
                            <h2 class="text-2xl font-bold">Flash Sale</h2>
                            <p class="text-lg">Limited time offers with countdown timer</p>
                            <div class="countdown-timer mt-2" id="flashSaleTimer">24:00:00</div>
                        </div>
                    </div>
                </div>
                <button class="carousel-control prev">
                    <i class="fas fa-chevron-left"></i>
                </button>
                <button class="carousel-control next">
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>
        </section>

        <!-- Stats Section -->
        <section class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
            <div class="glass-card p-4 text-center">
                <div class="text-indigo-600 text-xl font-bold mb-1" id="activeListingsCount">0</div>
                <div class="text-gray-600 dark:text-gray-400 text-sm">Active Listings</div>
            </div>
            <div class="glass-card p-4 text-center">
                <div class="text-indigo-600 text-xl font-bold mb-1" id="totalUsersCount">0</div>
                <div class="text-gray-600 dark:text-gray-400 text-sm">Users</div>
            </div>
            <div class="glass-card p-4 text-center">
                <div class="text-indigo-600 text-xl font-bold mb-1" id="successfulSalesCount">0</div>
                <div class="text-gray-600 dark:text-gray-400 text-sm">Successful Sales</div>
            </div>
            <div class="glass-card p-4 text-center">
                <div class="text-indigo-600 text-xl font-bold mb-1" id="averageRatingCount">0.0</div>
                <div class="text-gray-600 dark:text-gray-400 text-sm">Avg. Rating</div>
            </div>
        </section>

        <!-- Trending Items Section -->
        <section class="mb-8">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-2xl font-bold text-gray-900 dark:text-white">Trending Items</h2>
                <a href="#" class="text-indigo-600 hover:text-indigo-800 dark:text-indigo-400 font-medium">View All</a>
            </div>
            <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4" id="trendingItemsContainer">
                <div class="col-span-full text-center py-12">
                    <div class="loading-spinner mx-auto mb-4" style="width: 40px; height: 40px;"></div>
                    <p class="text-gray-500 dark:text-gray-400">Loading trending items...</p>
                </div>
            </div>
        </section>

        <!-- Marketplace Tabs -->
        <section class="mb-8">
            <div class="flex flex-wrap justify-between items-center mb-6">
                <div class="flex flex-wrap gap-2 mb-4 md:mb-0">
                    <button class="tab-button active" data-category="all">All Listings</button>
                    <button class="tab-button" data-category="electronics">Electronics</button>
                    <button class="tab-button" data-category="textbooks">Textbooks</button>
                    <button class="tab-button" data-category="furniture">Furniture</button>
                    <button class="tab-button" data-category="clothing">Clothing</button>
                    <button class="tab-button" data-category="services">Services</button>
                </div>

                <div class="flex items-center space-x-4">
                    <div class="flex items-center space-x-2">
                        <button id="gridViewBtn" class="p-2 border border-gray-300 dark:border-slate-600 rounded-lg text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white bg-indigo-50 dark:bg-indigo-900/20">
                            <i class="fas fa-th-large"></i>
                        </button>
                        <button id="listViewBtn" class="p-2 border border-gray-300 dark:border-slate-600 rounded-lg text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white">
                            <i class="fas fa-list"></i>
                        </button>
                    </div>
                    
                    <select id="sortFilter" class="border border-gray-300 dark:border-slate-600 dark:bg-slate-700 dark:text-white rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                        <option value="newest">Newest First</option>
                        <option value="oldest">Oldest First</option>
                        <option value="price-low">Price: Low to High</option>
                        <option value="price-high">Price: High to Low</option>
                        <option value="popular">Most Popular</option>
                    </select>
                </div>
            </div>

            <!-- Filters -->
            <div class="glass-card p-4 mb-6">
                <div class="flex flex-wrap gap-4 items-center">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Price Range</label>
                        <div class="flex items-center space-x-2">
                            <input type="number" id="minPrice" placeholder="Min" class="w-20 border border-gray-300 dark:border-slate-600 dark:bg-slate-700 dark:text-white rounded-lg px-3 py-1 focus:outline-none focus:ring-1 focus:ring-indigo-500">
                            <span class="text-gray-500">-</span>
                            <input type="number" id="maxPrice" placeholder="Max" class="w-20 border border-gray-300 dark:border-slate-600 dark:bg-slate-700 dark:text-white rounded-lg px-3 py-1 focus:outline-none focus:ring-1 focus:ring-indigo-500">
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Seller Rating</label>
                        <select id="sellerRatingFilter" class="border border-gray-300 dark:border-slate-600 dark:bg-slate-700 dark:text-white rounded-lg px-3 py-1 focus:outline-none focus:ring-1 focus:ring-indigo-500">
                            <option value="any">Any Rating</option>
                            <option value="4.5">4.5+ Stars</option>
                            <option value="4.0">4.0+ Stars</option>
                            <option value="3.5">3.5+ Stars</option>
                            <option value="3.0">3.0+ Stars</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Location</label>
                        <select id="locationFilter" class="border border-gray-300 dark:border-slate-600 dark:bg-slate-700 dark:text-white rounded-lg px-3 py-1 focus:outline-none focus:ring-1 focus:ring-indigo-500">
                            <option value="any">Any Location</option>
                            <option value="campus">On Campus</option>
                            <option value="downtown">Downtown</option>
                            <option value="suburbs">Suburbs</option>
                        </select>
                    </div>
                    
                    <button id="applyFilters" class="bg-indigo-600 text-white px-4 py-2 rounded-lg font-semibold hover:bg-indigo-700 transition mt-5">Apply Filters</button>
                    <button id="clearFilters" class="bg-gray-300 dark:bg-slate-600 text-gray-700 dark:text-gray-300 px-4 py-2 rounded-lg font-semibold hover:bg-gray-400 dark:hover:bg-slate-500 transition mt-5">Clear</button>
                </div>
            </div>

            <!-- Product Grid/List -->
            <div id="listingsContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                <div class="col-span-full text-center py-12">
                    <div class="loading-spinner mx-auto mb-4" style="width: 40px; height: 40px;"></div>
                    <p class="text-gray-500 dark:text-gray-400">Loading listings...</p>
                </div>
            </div>

            <!-- Load More Button -->
            <div class="text-center mt-8">
                <button id="loadMoreBtn" class="bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 text-gray-700 dark:text-gray-300 px-6 py-3 rounded-lg font-semibold hover:bg-gray-50 dark:hover:bg-slate-700 transition hidden">
                    Load More Listings
                </button>
            </div>
        </section>

        <!-- Recommended For You -->
        <section class="mb-8">
            <h2 class="text-2xl font-bold text-gray-900 dark:text-white mb-4">Recommended For You</h2>
            <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4" id="recommendedContainer">
                <div class="col-span-full text-center py-12">
                    <div class="loading-spinner mx-auto mb-4" style="width: 40px; height: 40px;"></div>
                    <p class="text-gray-500 dark:text-gray-400">Loading recommendations...</p>
                </div>
            </div>
        </section>
    </main>

    <!-- Bottom Navigation -->
    <div class="bottom-nav">
        <a href="index.html" class="bottom-nav-item">
            <i class="fas fa-home"></i>
            <span>Home</span>
        </a>
        <a href="chat.html" class="bottom-nav-item">
            <i class="fas fa-comments"></i>
            <span>Chat</span>
        </a>
        <a href="games.html" class="bottom-nav-item">
            <i class="fas fa-gamepad"></i>
            <span>Games</span>
        </a>
        <a href="profile.html" class="bottom-nav-item active">
            <i class="fas fa-user"></i>
            <span>Profile</span>
        </a>
    </div>

    <!-- Create Listing Modal -->
    <div id="createListingModal" class="modal">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-gray-900 dark:text-white">Create New Listing</h2>
                <button id="closeCreateModal" class="text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <form id="createListingForm">
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Product Title *</label>
                    <input type="text" id="listingTitle" class="w-full border border-gray-300 dark:border-slate-600 dark:bg-slate-700 dark:text-white rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent" placeholder="e.g. Calculus Textbook 8th Edition" required>
                </div>
                
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Description *</label>
                    <textarea rows="4" id="listingDescription" class="w-full border border-gray-300 dark:border-slate-600 dark:bg-slate-700 dark:text-white rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent" placeholder="Describe your item..." required></textarea>
                </div>
                
                <div class="grid grid-cols-2 gap-4 mb-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Price ($) *</label>
                        <input type="number" id="listingPrice" class="w-full border border-gray-300 dark:border-slate-600 dark:bg-slate-700 dark:text-white rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent" placeholder="0.00" min="0" step="0.01" required>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Category *</label>
                        <select id="listingCategory" class="w-full border border-gray-300 dark:border-slate-600 dark:bg-slate-700 dark:text-white rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                            <option value="electronics">Electronics</option>
                            <option value="textbooks">Textbooks</option>
                            <option value="furniture">Furniture</option>
                            <option value="clothing">Clothing</option>
                            <option value="services">Services</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                </div>
                
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Condition *</label>
                    <div class="flex flex-wrap gap-4">
                        <label class="flex items-center">
                            <input type="radio" name="condition" value="new" class="h-4 w-4 text-indigo-600 focus:ring-indigo-500" checked>
                            <span class="ml-2 text-gray-700 dark:text-gray-300">New</span>
                        </label>
                        <label class="flex items-center">
                            <input type="radio" name="condition" value="like-new" class="h-4 w-4 text-indigo-600 focus:ring-indigo-500">
                            <span class="ml-2 text-gray-700 dark:text-gray-300">Like New</span>
                        </label>
                        <label class="flex items-center">
                            <input type="radio" name="condition" value="good" class="h-4 w-4 text-indigo-600 focus:ring-indigo-500">
                            <span class="ml-2 text-gray-700 dark:text-gray-300">Good</span>
                        </label>
                        <label class="flex items-center">
                            <input type="radio" name="condition" value="fair" class="h-4 w-4 text-indigo-600 focus:ring-indigo-500">
                            <span class="ml-2 text-gray-700 dark:text-gray-300">Fair</span>
                        </label>
                    </div>
                </div>
                
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Tags</label>
                    <input type="text" id="listingTags" class="w-full border border-gray-300 dark:border-slate-600 dark:bg-slate-700 dark:text-white rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent" placeholder="Add tags (comma separated)">
                    <div id="tagSuggestions" class="mt-2">
                        <!-- Tag suggestions will appear here -->
                    </div>
                </div>
                
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Product Images</label>
                    <div class="image-upload-area" id="imageUploadArea">
                        <i class="fas fa-cloud-upload-alt text-3xl text-gray-400 mb-2"></i>
                        <p class="text-gray-600 dark:text-gray-400 mb-2">Drag & drop images here or click to browse</p>
                        <button type="button" id="browseImagesBtn" class="bg-indigo-600 text-white px-4 py-2 rounded-lg font-semibold hover:bg-indigo-700 transition">Browse Files</button>
                        <input type="file" id="listingImages" multiple accept="image/*" class="hidden">
                        <p class="text-xs text-gray-500 dark:text-gray-400 mt-2">JPEG, PNG up to 5MB each. Max 8 images.</p>
                    </div>
                    <div id="imagePreview" class="image-preview mt-4">
                        <!-- Image previews will appear here -->
                    </div>
                </div>
                
                <div class="flex justify-end space-x-4">
                    <button type="button" id="cancelCreateListing" class="bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 text-gray-700 dark:text-gray-300 px-6 py-3 rounded-lg font-semibold hover:bg-gray-50 dark:hover:bg-slate-700 transition">Cancel</button>
                    <button type="submit" class="bg-indigo-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-indigo-700 transition flex items-center space-x-2">
                        <i class="fas fa-plus"></i>
                        <span id="createListingBtnText">Create Listing</span>
                        <div id="createListingSpinner" class="loading-spinner hidden"></div>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Cart Modal -->
    <div id="cartModal" class="modal">
        <div class="modal-content max-w-2xl">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-gray-900 dark:text-white">Your Cart</h2>
                <button id="closeCartModal" class="text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <div id="cartContent">
                <div class="text-center py-12">
                    <i class="fas fa-shopping-cart text-4xl text-gray-400 mb-4"></i>
                    <h3 class="text-xl font-bold text-gray-700 dark:text-gray-300 mb-2">Your cart is empty</h3>
                    <p class="text-gray-500 dark:text-gray-400">Add some items to get started</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Notifications Modal -->
    <div id="notificationsModal" class="modal">
        <div class="modal-content max-w-2xl">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-gray-900 dark:text-white">Notifications</h2>
                <button id="closeNotificationsModal" class="text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <div id="notificationsContent">
                <div class="text-center py-12">
                    <i class="far fa-bell text-4xl text-gray-400 mb-4"></i>
                    <h3 class="text-xl font-bold text-gray-700 dark:text-gray-300 mb-2">No notifications</h3>
                    <p class="text-gray-500 dark:text-gray-400">You're all caught up!</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Notification Toast -->
    <div id="notificationToast" class="notification">
        <div class="flex justify-between items-start">
            <div>
                <div id="notificationToastTitle" class="font-semibold"></div>
                <div id="notificationToastMessage" class="text-sm mt-1"></div>
            </div>
            <button id="closeNotificationToast" class="text-gray-500 hover:text-gray-700 ml-4">
                <i class="fas fa-times"></i>
            </button>
        </div>
    </div>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDHHyGgsSV18BcXrGgzi4C8frzDAE1C1zo",
            authDomain: "uniconnect-ee95c.firebaseapp.com",
            projectId: "uniconnect-ee95c",
            storageBucket: "uniconnect-ee95c.firebasestorage.app",
            messagingSenderId: "1003264444309",
            appId: "1:1003264444309:web:9f0307516e44d21e97d89c"
        };

        // Clear cached data
        localStorage.removeItem('marketplaceListings');
        sessionStorage.clear();

        // Initialize Firebase
        try {
            firebase.initializeApp(firebaseConfig);
            console.log("‚úÖ Firebase initialized successfully");
        } catch (error) {
            console.error("‚ùå Firebase initialization error:", error);
        }

        // Firebase services
        const auth = firebase.auth();
        const db = firebase.firestore();
        const storage = firebase.storage();

        // Global variables
        let currentUser = null;
        let userData = null;
        let selectedImages = [];
        let currentView = 'grid';
        let currentCategory = 'all';
        let currentSort = 'newest';
        let allListings = [];
        let filteredListings = [];
        let displayedCount = 0;
        const listingsPerPage = 12;
        let lastVisible = null;
        let hasMoreListings = true;

        // DOM Elements
        const listingsContainer = document.getElementById('listingsContainer');
        const trendingItemsContainer = document.getElementById('trendingItemsContainer');
        const recommendedContainer = document.getElementById('recommendedContainer');
        const createListingBtn = document.getElementById('createListingBtn');
        const createListingModal = document.getElementById('createListingModal');
        const closeCreateModal = document.getElementById('closeCreateModal');
        const cancelCreateListing = document.getElementById('cancelCreateListing');
        const createListingForm = document.getElementById('createListingForm');
        const browseImagesBtn = document.getElementById('browseImagesBtn');
        const listingImages = document.getElementById('listingImages');
        const imagePreview = document.getElementById('imagePreview');
        const imageUploadArea = document.getElementById('imageUploadArea');
        const searchInput = document.getElementById('searchInput');
        const searchSuggestions = document.getElementById('searchSuggestions');
        const gridViewBtn = document.getElementById('gridViewBtn');
        const listViewBtn = document.getElementById('listViewBtn');
        const sortFilter = document.getElementById('sortFilter');
        const minPrice = document.getElementById('minPrice');
        const maxPrice = document.getElementById('maxPrice');
        const sellerRatingFilter = document.getElementById('sellerRatingFilter');
        const locationFilter = document.getElementById('locationFilter');
        const applyFilters = document.getElementById('applyFilters');
        const clearFilters = document.getElementById('clearFilters');
        const loadMoreBtn = document.getElementById('loadMoreBtn');
        const themeToggle = document.getElementById('themeToggle');
        const userAvatar = document.getElementById('userAvatar');
        const userName = document.getElementById('userName');
        const userStatus = document.getElementById('userStatus');
        const activeListingsCount = document.getElementById('activeListingsCount');
        const totalUsersCount = document.getElementById('totalUsersCount');
        const successfulSalesCount = document.getElementById('successfulSalesCount');
        const averageRatingCount = document.getElementById('averageRatingCount');
        const flashSaleTimer = document.getElementById('flashSaleTimer');
        const tagSuggestions = document.getElementById('tagSuggestions');
        const listingTitle = document.getElementById('listingTitle');
        const listingTags = document.getElementById('listingTags');
        const cartBtn = document.getElementById('cartBtn');
        const cartModal = document.getElementById('cartModal');
        const closeCartModal = document.getElementById('closeCartModal');
        const cartContent = document.getElementById('cartContent');
        const cartCount = document.getElementById('cartCount');
        const notificationBtn = document.getElementById('notificationBtn');
        const notificationsModal = document.getElementById('notificationsModal');
        const closeNotificationsModal = document.getElementById('closeNotificationsModal');
        const notificationsContent = document.getElementById('notificationsContent');
        const notificationCount = document.getElementById('notificationCount');
        const notificationToast = document.getElementById('notificationToast');
        const closeNotificationToast = document.getElementById('closeNotificationToast');
        const notificationToastTitle = document.getElementById('notificationToastTitle');
        const notificationToastMessage = document.getElementById('notificationToastMessage');
        const createListingBtnText = document.getElementById('createListingBtnText');
        const createListingSpinner = document.getElementById('createListingSpinner');
        const discoverLink = document.getElementById('discoverLink');
        const categoriesLink = document.getElementById('categoriesLink');
        const sellersLink = document.getElementById('sellersLink');

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üè™ UniConnect Marketplace loaded');
            
            // Check authentication
            auth.onAuthStateChanged(handleAuthStateChange);
            
            // Setup event listeners
            setupEventListeners();
            
            // Initialize carousel
            initCarousel();
            
            // Initialize theme
            initTheme();
            
            // Start flash sale timer
            startFlashSaleTimer();
        });

        // Handle authentication state changes
        async function handleAuthStateChange(user) {
            if (user) {
                currentUser = user;
                console.log('‚úÖ User authenticated:', user.uid);
                await loadUserData(user.uid);
                await loadMarketplaceData();
                updateUserUI();
                loadCartCount();
                loadNotificationCount();
            } else {
                console.log('‚ùå No user signed in');
                window.location.href = 'index.html';
            }
        }

        // Load current user's data from Firestore
        async function loadUserData(uid) {
            try {
                const userDoc = await db.collection('users').doc(uid).get();
                if (userDoc.exists) {
                    userData = userDoc.data();
                    console.log('‚úÖ User data loaded:', userData);
                } else {
                    // Create user document if it doesn't exist
                    userData = {
                        name: currentUser.displayName || 'User',
                        email: currentUser.email,
                        avatar: currentUser.photoURL || `https://ui-avatars.com/api/?name=${encodeURIComponent(currentUser.displayName || 'User')}&background=6366f1&color=fff&size=150`,
                        status: 'student',
                        university: 'Unknown University',
                        joined: new Date(),
                        rating: 5.0,
                        listings: 0,
                        sales: 0,
                        verified: false
                    };
                    await db.collection('users').doc(uid).set(userData);
                }
            } catch (error) {
                console.error('‚ùå Error loading user data:', error);
                showToast('Error loading user data', 'error');
            }
        }

        // Load marketplace data
        async function loadMarketplaceData() {
            try {
                await loadStats();
                await loadListings();
                await loadTrendingItems();
                await loadRecommendedItems();
            } catch (error) {
                console.error('‚ùå Error loading marketplace data:', error);
                showToast('Error loading marketplace data', 'error');
            }
        }

        // Load marketplace stats
        async function loadStats() {
            try {
                // Active listings count
                const activeListingsQuery = await db.collection('listings')
                    .where('status', '==', 'active')
                    .get();
                activeListingsCount.textContent = activeListingsQuery.size;
                
                // Total users count
                const usersQuery = await db.collection('users').get();
                totalUsersCount.textContent = usersQuery.size;
                
                // Successful sales count
                const salesQuery = await db.collection('transactions')
                    .where('status', '==', 'completed')
                    .get();
                successfulSalesCount.textContent = salesQuery.size;
                
                // Average rating (calculate from users)
                let totalRating = 0;
                let userCount = 0;
                usersQuery.forEach(doc => {
                    const user = doc.data();
                    if (user.rating) {
                        totalRating += user.rating;
                        userCount++;
                    }
                });
                const avgRating = userCount > 0 ? (totalRating / userCount).toFixed(1) : '0.0';
                averageRatingCount.textContent = avgRating;
                
            } catch (error) {
                console.error('‚ùå Error loading stats:', error);
            }
        }

        // Load listings from Firestore
        async function loadListings() {
            try {
                listingsContainer.innerHTML = `
                    <div class="col-span-full text-center py-12">
                        <div class="loading-spinner mx-auto mb-4" style="width: 40px; height: 40px;"></div>
                        <p class="text-gray-500 dark:text-gray-400">Loading listings...</p>
                    </div>
                `;

                const query = db.collection('listings')
                    .where('status', '==', 'active')
                    .orderBy('createdAt', 'desc')
                    .limit(listingsPerPage);

                const querySnapshot = await query.get();
                
                allListings = [];
                querySnapshot.forEach(doc => {
                    const listing = doc.data();
                    listing.id = doc.id;
                    allListings.push(listing);
                });

                lastVisible = querySnapshot.docs[querySnapshot.docs.length - 1];
                hasMoreListings = querySnapshot.docs.length === listingsPerPage;

                console.log(`‚úÖ Loaded ${allListings.length} listings`);
                
                filteredListings = [...allListings];
                displayedCount = 0;
                displayListings();

            } catch (error) {
                console.error('‚ùå Error loading listings:', error);
                listingsContainer.innerHTML = `
                    <div class="col-span-full text-center py-12">
                        <i class="fas fa-exclamation-triangle text-4xl text-red-400 mb-4"></i>
                        <h3 class="text-xl font-bold text-gray-700 dark:text-gray-300 mb-2">Error Loading Listings</h3>
                        <p class="text-gray-500 dark:text-gray-400">Please try refreshing the page</p>
                    </div>
                `;
            }
        }

        // Load more listings
        async function loadMoreListings() {
            if (!hasMoreListings) return;

            loadMoreBtn.disabled = true;
            loadMoreBtn.innerHTML = '<div class="loading-spinner mx-auto"></div>';

            try {
                const query = db.collection('listings')
                    .where('status', '==', 'active')
                    .orderBy('createdAt', 'desc')
                    .startAfter(lastVisible)
                    .limit(listingsPerPage);

                const querySnapshot = await query.get();
                
                const newListings = [];
                querySnapshot.forEach(doc => {
                    const listing = doc.data();
                    listing.id = doc.id;
                    newListings.push(listing);
                });

                allListings = [...allListings, ...newListings];
                lastVisible = querySnapshot.docs[querySnapshot.docs.length - 1];
                hasMoreListings = querySnapshot.docs.length === listingsPerPage;

                filteredListings = [...allListings];
                displayListings(true);

            } catch (error) {
                console.error('‚ùå Error loading more listings:', error);
                showToast('Error loading more listings', 'error');
            }

            loadMoreBtn.disabled = false;
            loadMoreBtn.textContent = 'Load More Listings';
        }

        // Load trending items (most viewed listings)
        async function loadTrendingItems() {
            try {
                const querySnapshot = await db.collection('listings')
                    .where('status', '==', 'active')
                    .orderBy('views', 'desc')
                    .limit(4)
                    .get();

                trendingItemsContainer.innerHTML = '';

                if (querySnapshot.empty) {
                    trendingItemsContainer.innerHTML = `
                        <div class="col-span-full text-center py-8">
                            <i class="fas fa-chart-line text-4xl text-gray-400 mb-4"></i>
                            <p class="text-gray-500 dark:text-gray-400">No trending items yet</p>
                        </div>
                    `;
                    return;
                }

                querySnapshot.forEach(doc => {
                    const listing = doc.data();
                    listing.id = doc.id;
                    const productCard = createProductCard(listing, true);
                    trendingItemsContainer.appendChild(productCard);
                });

            } catch (error) {
                console.error('‚ùå Error loading trending items:', error);
                trendingItemsContainer.innerHTML = `
                    <div class="col-span-full text-center py-8">
                        <i class="fas fa-exclamation-triangle text-4xl text-red-400 mb-4"></i>
                        <p class="text-gray-500 dark:text-gray-400">Error loading trending items</p>
                    </div>
                `;
            }
        }

        // Load recommended items (based on user preferences)
        async function loadRecommendedItems() {
            try {
                // For now, show random active listings
                const querySnapshot = await db.collection('listings')
                    .where('status', '==', 'active')
                    .limit(4)
                    .get();

                recommendedContainer.innerHTML = '';

                if (querySnapshot.empty) {
                    recommendedContainer.innerHTML = `
                        <div class="col-span-full text-center py-8">
                            <i class="fas fa-star text-4xl text-gray-400 mb-4"></i>
                            <p class="text-gray-500 dark:text-gray-400">No recommendations available</p>
                        </div>
                    `;
                    return;
                }

                const listings = [];
                querySnapshot.forEach(doc => {
                    const listing = doc.data();
                    listing.id = doc.id;
                    listings.push(listing);
                });

                // Shuffle array for random recommendations
                const shuffled = listings.sort(() => 0.5 - Math.random());
                shuffled.slice(0, 4).forEach(listing => {
                    const productCard = createProductCard(listing, true);
                    recommendedContainer.appendChild(productCard);
                });

            } catch (error) {
                console.error('‚ùå Error loading recommended items:', error);
                recommendedContainer.innerHTML = `
                    <div class="col-span-full text-center py-8">
                        <i class="fas fa-exclamation-triangle text-4xl text-red-400 mb-4"></i>
                        <p class="text-gray-500 dark:text-gray-400">Error loading recommendations</p>
                    </div>
                `;
            }
        }

        // Display listings in the container
        function displayListings(append = false) {
            const listingsToShow = filteredListings.slice(displayedCount, displayedCount + listingsPerPage);
            
            if (!append) {
                listingsContainer.innerHTML = '';
            }
            
            if (listingsToShow.length === 0 && !append) {
                listingsContainer.innerHTML = `
                    <div class="col-span-full text-center py-12">
                        <i class="fas fa-search text-4xl text-gray-400 mb-4"></i>
                        <h3 class="text-xl font-bold text-gray-700 dark:text-gray-300 mb-2">No listings found</h3>
                        <p class="text-gray-500 dark:text-gray-400">Try adjusting your filters or search terms</p>
                    </div>
                `;
                loadMoreBtn.classList.add('hidden');
                return;
            }
            
            listingsToShow.forEach(listing => {
                const productCard = createProductCard(listing);
                listingsContainer.appendChild(productCard);
            });
            
            displayedCount += listingsToShow.length;
            
            // Show/hide load more button
            if (displayedCount >= filteredListings.length || !hasMoreListings) {
                loadMoreBtn.classList.add('hidden');
            } else {
                loadMoreBtn.classList.remove('hidden');
            }
        }

        // Create product card HTML
        function createProductCard(listing, isSmall = false) {
            const listingDate = listing.createdAt ? new Date(listing.createdAt.seconds * 1000).toLocaleDateString() : 'Recently';
            const imageUrl = listing.images && listing.images.length > 0 
                ? listing.images[0] 
                : 'https://images.unsplash.com/photo-1560472354-b33ff0c44a43?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80';
            
            const card = document.createElement('div');
            card.className = `product-card glass-card rounded-xl overflow-hidden hover-lift fade-in ${currentView === 'list' ? 'list-view' : ''}`;
            card.setAttribute('data-listing-id', listing.id);
            
            card.innerHTML = `
                <div class="relative ${isSmall ? 'h-40' : 'h-48'} overflow-hidden">
                    <img src="${imageUrl}" alt="${listing.title}" class="w-full h-full object-cover primary-image">
                    
                    ${listing.isHotDeal ? `<div class="hot-deal-badge">HOT DEAL</div>` : ''}
                    
                    <div class="quick-actions">
                        <button class="quick-action-btn favorite-btn" data-listing-id="${listing.id}">
                            <i class="far fa-heart"></i>
                        </button>
                        <button class="quick-action-btn view-btn" data-listing-id="${listing.id}">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                </div>
                
                <div class="p-4 product-details">
                    <div class="flex justify-between items-start mb-2">
                        <h3 class="font-semibold text-gray-900 dark:text-white line-clamp-2 flex-1">${listing.title}</h3>
                        <span class="text-indigo-600 dark:text-indigo-400 font-bold ml-2">$${listing.price.toFixed(2)}</span>
                    </div>
                    
                    <div class="flex items-center mb-2">
                        <img src="${listing.sellerAvatar || 'https://ui-avatars.com/api/?name=Seller&background=6366f1&color=fff&size=32'}" 
                             alt="${listing.sellerName}" 
                             class="w-6 h-6 rounded-full object-cover mr-2">
                        <span class="text-sm text-gray-600 dark:text-gray-400">${listing.sellerName}</span>
                        ${listing.sellerVerified ? '<span class="verified-badge"><i class="fas fa-check mr-1"></i>Verified</span>' : ''}
                    </div>
                    
                    <p class="text-gray-600 dark:text-gray-400 text-sm mb-4 line-clamp-2">${listing.description || 'No description available'}</p>
                    
                    <div class="flex justify-between items-center">
                        <div class="flex items-center space-x-1">
                            <i class="fas fa-star text-yellow-400 text-sm"></i>
                            <span class="text-sm text-gray-600 dark:text-gray-400">${listing.rating || '4.5'}</span>
                            <span class="text-sm text-gray-400 dark:text-gray-500">(${listing.reviewCount || '0'})</span>
                        </div>
                        <span class="text-xs text-gray-500 dark:text-gray-400">${listingDate}</span>
                    </div>
                    
                    ${!isSmall ? `
                        <div class="flex justify-between mt-4">
                            <button class="bg-indigo-600 text-white px-4 py-2 rounded-lg font-semibold hover:bg-indigo-700 transition flex-1 mr-2 contact-seller-btn" data-listing-id="${listing.id}">
                                Contact
                            </button>
                            <button class="bg-gray-200 dark:bg-slate-600 text-gray-700 dark:text-gray-300 px-4 py-2 rounded-lg font-semibold hover:bg-gray-300 dark:hover:bg-slate-500 transition add-to-cart-btn" data-listing-id="${listing.id}">
                                <i class="fas fa-shopping-cart"></i>
                            </button>
                        </div>
                    ` : ''}
                </div>
            `;
            
            // Add event listeners
            setTimeout(() => {
                const favoriteBtn = card.querySelector('.favorite-btn');
                const viewBtn = card.querySelector('.view-btn');
                const contactBtn = card.querySelector('.contact-seller-btn');
                const cartBtn = card.querySelector('.add-to-cart-btn');
                
                if (favoriteBtn) favoriteBtn.addEventListener('click', () => toggleFavorite(listing.id));
                if (viewBtn) viewBtn.addEventListener('click', () => viewListing(listing.id));
                if (contactBtn) contactBtn.addEventListener('click', () => contactSeller(listing.id));
                if (cartBtn) cartBtn.addEventListener('click', () => addToCart(listing.id));
            }, 100);
            
            return card;
        }

        // Setup event listeners
        function setupEventListeners() {
            // Create listing modal
            createListingBtn.addEventListener('click', openCreateListingModal);
            closeCreateModal.addEventListener('click', closeCreateListingModal);
            cancelCreateListing.addEventListener('click', closeCreateListingModal);
            createListingForm.addEventListener('submit', handleCreateListing);
            
            // Image upload
            browseImagesBtn.addEventListener('click', () => listingImages.click());
            listingImages.addEventListener('change', handleImageSelection);
            
            imageUploadArea.addEventListener('dragover', function(e) {
                e.preventDefault();
                this.classList.add('dragover');
            });
            
            imageUploadArea.addEventListener('dragleave', function() {
                this.classList.remove('dragover');
            });
            
            imageUploadArea.addEventListener('drop', function(e) {
                e.preventDefault();
                this.classList.remove('dragover');
                listingImages.files = e.dataTransfer.files;
                handleImageSelection({ target: listingImages });
            });
            
            // Search
            searchInput.addEventListener('input', debounce(handleSearch, 300));
            
            // View toggle
            gridViewBtn.addEventListener('click', () => switchView('grid'));
            listViewBtn.addEventListener('click', () => switchView('list'));
            
            // Sorting and filtering
            sortFilter.addEventListener('change', function() {
                currentSort = this.value;
                filterAndDisplayListings();
            });
            
            applyFilters.addEventListener('click', filterAndDisplayListings);
            clearFilters.addEventListener('click', clearAllFilters);
            
            // Load more
            loadMoreBtn.addEventListener('click', loadMoreListings);
            
            // Theme toggle
            themeToggle.addEventListener('click', toggleTheme);
            
            // Category tabs
            document.querySelectorAll('.tab-button').forEach(button => {
                button.addEventListener('click', function() {
                    document.querySelectorAll('.tab-button').forEach(btn => {
                        btn.classList.remove('active');
                    });
                    this.classList.add('active');
                    currentCategory = this.getAttribute('data-category');
                    filterAndDisplayListings();
                });
            });
            
            // Cart and notifications
            cartBtn.addEventListener('click', openCartModal);
            closeCartModal.addEventListener('click', closeCartModalFunc);
            notificationBtn.addEventListener('click', openNotificationsModal);
            closeNotificationsModal.addEventListener('click', closeNotificationsModalFunc);
            closeNotificationToast.addEventListener('click', () => {
                notificationToast.classList.remove('show');
            });
            
            // Navigation links
            discoverLink.addEventListener('click', (e) => {
                e.preventDefault();
                showToast('Discover feature coming soon!', 'info');
            });
            
            categoriesLink.addEventListener('click', (e) => {
                e.preventDefault();
                showToast('Categories feature coming soon!', 'info');
            });
            
            sellersLink.addEventListener('click', (e) => {
                e.preventDefault();
                showToast('Sellers directory coming soon!', 'info');
            });
            
            // Close modals when clicking outside
            document.addEventListener('click', function(e) {
                if (e.target === createListingModal) closeCreateListingModal();
                if (e.target === cartModal) closeCartModalFunc();
                if (e.target === notificationsModal) closeNotificationsModalFunc();
            });
        }

        // Filter and display listings based on current filters
        function filterAndDisplayListings() {
            // Apply category filter
            if (currentCategory === 'all') {
                filteredListings = [...allListings];
            } else {
                filteredListings = allListings.filter(listing => listing.category === currentCategory);
            }
            
            // Apply price filter
            const minPriceValue = parseFloat(minPrice.value) || 0;
            const maxPriceValue = parseFloat(maxPrice.value) || Infinity;
            
            filteredListings = filteredListings.filter(listing => {
                return listing.price >= minPriceValue && listing.price <= maxPriceValue;
            });
            
            // Apply sort
            switch (currentSort) {
                case 'newest':
                    filteredListings.sort((a, b) => b.createdAt - a.createdAt);
                    break;
                case 'oldest':
                    filteredListings.sort((a, b) => a.createdAt - b.createdAt);
                    break;
                case 'price-low':
                    filteredListings.sort((a, b) => a.price - b.price);
                    break;
                case 'price-high':
                    filteredListings.sort((a, b) => b.price - a.price);
                    break;
                case 'popular':
                    filteredListings.sort((a, b) => (b.views || 0) - (a.views || 0));
                    break;
            }
            
            displayedCount = 0;
            displayListings();
        }

        // Clear all filters
        function clearAllFilters() {
            minPrice.value = '';
            maxPrice.value = '';
            sellerRatingFilter.value = 'any';
            locationFilter.value = 'any';
            filterAndDisplayListings();
        }

        // Switch between grid and list view
        function switchView(view) {
            currentView = view;
            
            if (view === 'grid') {
                gridViewBtn.classList.add('bg-indigo-50', 'dark:bg-indigo-900/20');
                listViewBtn.classList.remove('bg-indigo-50', 'dark:bg-indigo-900/20');
                listingsContainer.classList.remove('grid-cols-1');
                listingsContainer.classList.add('grid-cols-1', 'md:grid-cols-2', 'lg:grid-cols-3', 'xl:grid-cols-4');
            } else {
                listViewBtn.classList.add('bg-indigo-50', 'dark:bg-indigo-900/20');
                gridViewBtn.classList.remove('bg-indigo-50', 'dark:bg-indigo-900/20');
                listingsContainer.classList.remove('grid-cols-1', 'md:grid-cols-2', 'lg:grid-cols-3', 'xl:grid-cols-4');
                listingsContainer.classList.add('grid-cols-1');
            }
            
            displayListings();
        }

        // Handle search
        function handleSearch() {
            const searchTerm = searchInput.value.toLowerCase().trim();
            
            if (searchTerm.length === 0) {
                searchSuggestions.classList.add('hidden');
                filterAndDisplayListings();
                return;
            }
            
            // Filter listings by search term
            const searchResults = allListings.filter(listing => 
                listing.title.toLowerCase().includes(searchTerm) ||
                listing.description.toLowerCase().includes(searchTerm) ||
                (listing.tags && listing.tags.some(tag => tag.toLowerCase().includes(searchTerm)))
            );
            
            filteredListings = searchResults;
            displayedCount = 0;
            displayListings();
        }

        // Open create listing modal
        function openCreateListingModal() {
            if (!currentUser) {
                showToast('Please log in to create a listing', 'warning');
                return;
            }
            
            createListingModal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        // Close create listing modal
        function closeCreateListingModal() {
            createListingModal.classList.remove('active');
            document.body.style.overflow = 'auto';
            createListingForm.reset();
            imagePreview.innerHTML = '';
            selectedImages = [];
        }

        // Handle image selection
        function handleImageSelection(e) {
            const files = e.target.files;
            if (!files || files.length === 0) return;
            
            imagePreview.innerHTML = '';
            const fileArray = Array.from(files).slice(0, 8);
            
            fileArray.forEach(file => {
                if (!file.type.startsWith('image/')) return;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    const previewItem = document.createElement('div');
                    previewItem.className = 'image-preview-item';
                    
                    const img = document.createElement('img');
                    img.src = e.target.result;
                    
                    const removeBtn = document.createElement('div');
                    removeBtn.className = 'remove';
                    removeBtn.innerHTML = '<i class="fas fa-times"></i>';
                    removeBtn.addEventListener('click', function() {
                        previewItem.remove();
                    });
                    
                    previewItem.appendChild(img);
                    previewItem.appendChild(removeBtn);
                    imagePreview.appendChild(previewItem);
                };
                reader.readAsDataURL(file);
            });
        }

        // Handle create listing form submission
        async function handleCreateListing(e) {
            e.preventDefault();
            
            if (!currentUser) {
                showToast('Please log in to create a listing', 'warning');
                return;
            }
            
            const title = document.getElementById('listingTitle').value;
            const description = document.getElementById('listingDescription').value;
            const price = parseFloat(document.getElementById('listingPrice').value);
            const category = document.getElementById('listingCategory').value;
            const condition = document.querySelector('input[name="condition"]:checked').value;
            const tags = document.getElementById('listingTags').value
                ? document.getElementById('listingTags').value.split(',').map(tag => tag.trim()).filter(tag => tag)
                : [];
            
            if (!title || !description || isNaN(price)) {
                showToast('Please fill in all required fields', 'error');
                return;
            }
            
            // Set loading state
            createListingBtnText.textContent = 'Creating...';
            createListingSpinner.classList.remove('hidden');
            
            try {
                // Upload images if any
                let imageUrls = [];
                const files = listingImages.files;
                
                if (files && files.length > 0) {
                    for (const file of files) {
                        if (!file.type.startsWith('image/')) continue;
                        
                        const storageRef = storage.ref().child(`marketplace/${currentUser.uid}/${Date.now()}_${file.name}`);
                        const snapshot = await storageRef.put(file);
                        const url = await snapshot.ref.getDownloadURL();
                        imageUrls.push(url);
                    }
                }
                
                // Create listing in Firestore
                const listingData = {
                    title,
                    description,
                    price,
                    category,
                    condition,
                    tags,
                    images: imageUrls,
                    sellerId: currentUser.uid,
                    sellerName: userData.name,
                    sellerAvatar: userData.avatar,
                    sellerVerified: userData.verified || false,
                    status: 'active',
                    views: 0,
                    createdAt: new Date(),
                    updatedAt: new Date()
                };
                
                await db.collection('listings').add(listingData);
                
                showToast('Listing created successfully!', 'success');
                closeCreateListingModal();
                
                // Refresh listings
                loadMarketplaceData();
                
            } catch (error) {
                console.error('‚ùå Error creating listing:', error);
                showToast('Error creating listing', 'error');
            } finally {
                createListingBtnText.textContent = 'Create Listing';
                createListingSpinner.classList.add('hidden');
            }
        }

        // Toggle favorite
        async function toggleFavorite(listingId) {
            if (!currentUser) {
                showToast('Please log in to add favorites', 'warning');
                return;
            }
            
            try {
                const favoriteRef = db.collection('favorites')
                    .where('userId', '==', currentUser.uid)
                    .where('listingId', '==', listingId);
                
                const snapshot = await favoriteRef.get();
                
                if (snapshot.empty) {
                    await db.collection('favorites').add({
                        userId: currentUser.uid,
                        listingId: listingId,
                        addedAt: new Date()
                    });
                    showToast('Added to favorites', 'success');
                } else {
                    const doc = snapshot.docs[0];
                    await db.collection('favorites').doc(doc.id).delete();
                    showToast('Removed from favorites', 'info');
                }
            } catch (error) {
                console.error('‚ùå Error toggling favorite:', error);
                showToast('Error updating favorites', 'error');
            }
        }

        // View listing details
        function viewListing(listingId) {
            // In a real implementation, this would open a detailed view
            showToast('Listing details feature coming soon!', 'info');
        }

        // Contact seller
        function contactSeller(listingId) {
            showToast('Contact feature coming soon!', 'info');
        }

        // Add to cart
        async function addToCart(listingId) {
            if (!currentUser) {
                showToast('Please log in to add items to cart', 'warning');
                return;
            }
            
            try {
                const listingDoc = await db.collection('listings').doc(listingId).get();
                if (!listingDoc.exists) {
                    showToast('Listing not found', 'error');
                    return;
                }
                
                const listing = listingDoc.data();
                
                // Add to cart in Firestore
                await db.collection('cart').add({
                    userId: currentUser.uid,
                    listingId: listingId,
                    title: listing.title,
                    price: listing.price,
                    image: listing.images && listing.images.length > 0 ? listing.images[0] : '',
                    sellerId: listing.sellerId,
                    addedAt: new Date()
                });
                
                showToast('Added to cart!', 'success');
                loadCartCount();
                
            } catch (error) {
                console.error('‚ùå Error adding to cart:', error);
                showToast('Error adding to cart', 'error');
            }
        }

        // Load cart count
        async function loadCartCount() {
            if (!currentUser) return;
            
            try {
                const cartQuery = await db.collection('cart')
                    .where('userId', '==', currentUser.uid)
                    .get();
                
                const count = cartQuery.size;
                if (count > 0) {
                    cartCount.textContent = count;
                    cartCount.classList.remove('hidden');
                } else {
                    cartCount.classList.add('hidden');
                }
            } catch (error) {
                console.error('‚ùå Error loading cart count:', error);
            }
        }

        // Load notification count
        async function loadNotificationCount() {
            if (!currentUser) return;
            
            try {
                const notificationsQuery = await db.collection('notifications')
                    .where('userId', '==', currentUser.uid)
                    .where('read', '==', false)
                    .get();
                
                const count = notificationsQuery.size;
                if (count > 0) {
                    notificationCount.textContent = count;
                    notificationCount.classList.remove('hidden');
                } else {
                    notificationCount.classList.add('hidden');
                }
            } catch (error) {
                console.error('‚ùå Error loading notification count:', error);
            }
        }

        // Open cart modal
        async function openCartModal() {
            if (!currentUser) {
                showToast('Please log in to view cart', 'warning');
                return;
            }
            
            try {
                const cartQuery = await db.collection('cart')
                    .where('userId', '==', currentUser.uid)
                    .orderBy('addedAt', 'desc')
                    .get();
                
                if (cartQuery.empty) {
                    cartContent.innerHTML = `
                        <div class="text-center py-12">
                            <i class="fas fa-shopping-cart text-4xl text-gray-400 mb-4"></i>
                            <h3 class="text-xl font-bold text-gray-700 dark:text-gray-300 mb-2">Your cart is empty</h3>
                            <p class="text-gray-500 dark:text-gray-400">Add some items to get started</p>
                        </div>
                    `;
                } else {
                    let cartHTML = '<div class="space-y-4">';
                    let total = 0;
                    
                    cartQuery.forEach(doc => {
                        const item = doc.data();
                        total += item.price;
                        
                        cartHTML += `
                            <div class="flex items-center space-x-4 p-4 border border-gray-200 dark:border-slate-600 rounded-lg">
                                <img src="${item.image || 'https://images.unsplash.com/photo-1560472354-b33ff0c44a43?ixlib=rb-1.2.1&auto=format&fit=crop&w=100&q=80'}" 
                                     alt="${item.title}" 
                                     class="w-16 h-16 object-cover rounded">
                                <div class="flex-1">
                                    <h4 class="font-semibold text-gray-900 dark:text-white">${item.title}</h4>
                                    <p class="text-indigo-600 dark:text-indigo-400 font-bold">$${item.price.toFixed(2)}</p>
                                </div>
                                <button class="remove-from-cart text-red-500 hover:text-red-700" data-id="${doc.id}">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        `;
                    });
                    
                    cartHTML += `
                        <div class="border-t border-gray-200 dark:border-slate-600 pt-4">
                            <div class="flex justify-between items-center mb-4">
                                <span class="text-lg font-bold text-gray-900 dark:text-white">Total:</span>
                                <span class="text-lg font-bold text-indigo-600 dark:text-indigo-400">$${total.toFixed(2)}</span>
                            </div>
                            <button class="w-full bg-indigo-600 text-white py-3 rounded-lg font-semibold hover:bg-indigo-700 transition">
                                Checkout
                            </button>
                        </div>
                    </div>
                    `;
                    
                    cartContent.innerHTML = cartHTML;
                    
                    // Add event listeners for remove buttons
                    cartContent.querySelectorAll('.remove-from-cart').forEach(btn => {
                        btn.addEventListener('click', async (e) => {
                            const itemId = e.currentTarget.getAttribute('data-id');
                            await removeFromCart(itemId);
                        });
                    });
                }
                
                cartModal.classList.add('active');
                document.body.style.overflow = 'hidden';
                
            } catch (error) {
                console.error('‚ùå Error loading cart:', error);
                showToast('Error loading cart', 'error');
            }
        }

        // Close cart modal
        function closeCartModalFunc() {
            cartModal.classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        // Remove from cart
        async function removeFromCart(itemId) {
            try {
                await db.collection('cart').doc(itemId).delete();
                showToast('Item removed from cart', 'success');
                loadCartCount();
                openCartModal(); // Refresh cart modal
            } catch (error) {
                console.error('‚ùå Error removing from cart:', error);
                showToast('Error removing item from cart', 'error');
            }
        }

        // Open notifications modal
        async function openNotificationsModal() {
            if (!currentUser) {
                showToast('Please log in to view notifications', 'warning');
                return;
            }
            
            try {
                const notificationsQuery = await db.collection('notifications')
                    .where('userId', '==', currentUser.uid)
                    .orderBy('createdAt', 'desc')
                    .limit(10)
                    .get();
                
                if (notificationsQuery.empty) {
                    notificationsContent.innerHTML = `
                        <div class="text-center py-12">
                            <i class="far fa-bell text-4xl text-gray-400 mb-4"></i>
                            <h3 class="text-xl font-bold text-gray-700 dark:text-gray-300 mb-2">No notifications</h3>
                            <p class="text-gray-500 dark:text-gray-400">You're all caught up!</p>
                        </div>
                    `;
                } else {
                    let notificationsHTML = '<div class="space-y-4">';
                    
                    notificationsQuery.forEach(doc => {
                        const notification = doc.data();
                        const timeAgo = formatTimeAgo(notification.createdAt);
                        
                        notificationsHTML += `
                            <div class="p-4 border border-gray-200 dark:border-slate-600 rounded-lg ${notification.read ? 'bg-gray-50 dark:bg-slate-800' : 'bg-white dark:bg-slate-700'}">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <h4 class="font-semibold text-gray-900 dark:text-white">${notification.title}</h4>
                                        <p class="text-gray-600 dark:text-gray-400 mt-1">${notification.message}</p>
                                    </div>
                                    <span class="text-xs text-gray-500 dark:text-gray-400">${timeAgo}</span>
                                </div>
                            </div>
                        `;
                    });
                    
                    notificationsHTML += '</div>';
                    notificationsContent.innerHTML = notificationsHTML;
                }
                
                notificationsModal.classList.add('active');
                document.body.style.overflow = 'hidden';
                
            } catch (error) {
                console.error('‚ùå Error loading notifications:', error);
                showToast('Error loading notifications', 'error');
            }
        }

        // Close notifications modal
        function closeNotificationsModalFunc() {
            notificationsModal.classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        // Update user UI
        function updateUserUI() {
            if (userData) {
                userAvatar.src = userData.avatar || `https://ui-avatars.com/api/?name=${encodeURIComponent(userData.name || 'User')}&background=6366f1&color=fff&size=40`;
                userName.textContent = userData.name || 'User';
                userStatus.textContent = userData.status || 'Student';
            }
        }

        // Show toast notification
        function showToast(message, type = 'info') {
            notificationToastTitle.textContent = type.charAt(0).toUpperCase() + type.slice(1);
            notificationToastMessage.textContent = message;
            
            // Set color based on type
            if (type === 'error') {
                notificationToast.style.borderLeft = '4px solid #ef4444';
            } else if (type === 'success') {
                notificationToast.style.borderLeft = '4px solid #10b981';
            } else if (type === 'warning') {
                notificationToast.style.borderLeft = '4px solid #f59e0b';
            } else {
                notificationToast.style.borderLeft = '4px solid #3b82f6';
            }
            
            notificationToast.classList.add('show');
            
            // Auto hide after 5 seconds
            setTimeout(() => {
                notificationToast.classList.remove('show');
            }, 5000);
        }

        // Initialize carousel
        function initCarousel() {
            const carouselInner = document.querySelector('.carousel-inner');
            const carouselItems = document.querySelectorAll('.carousel-item');
            const prevButton = document.querySelector('.carousel-control.prev');
            const nextButton = document.querySelector('.carousel-control.next');
            
            let currentIndex = 0;
            const totalItems = carouselItems.length;
            
            function updateCarousel() {
                carouselInner.style.transform = `translateX(-${currentIndex * 100}%)`;
            }
            
            if (prevButton) {
                prevButton.addEventListener('click', function() {
                    currentIndex = (currentIndex - 1 + totalItems) % totalItems;
                    updateCarousel();
                });
            }
            
            if (nextButton) {
                nextButton.addEventListener('click', function() {
                    currentIndex = (currentIndex + 1) % totalItems;
                    updateCarousel();
                });
            }
            
            // Auto-advance carousel
            setInterval(function() {
                currentIndex = (currentIndex + 1) % totalItems;
                updateCarousel();
            }, 5000);
        }

        // Initialize theme
        function initTheme() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            setTheme(savedTheme);
        }

        // Toggle theme
        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme') || 'light';
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            setTheme(newTheme);
        }

        // Set theme
        function setTheme(theme) {
            document.documentElement.setAttribute('data-theme', theme);
            localStorage.setItem('theme', theme);
            
            if (theme === 'dark') {
                themeToggle.classList.add('active');
            } else {
                themeToggle.classList.remove('active');
            }
        }

        // Start flash sale timer
        function startFlashSaleTimer() {
            let timeLeft = 24 * 60 * 60; // 24 hours in seconds
            
            function updateTimer() {
                const hours = Math.floor(timeLeft / 3600);
                const minutes = Math.floor((timeLeft % 3600) / 60);
                const seconds = timeLeft % 60;
                
                flashSaleTimer.textContent = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                
                if (timeLeft > 0) {
                    timeLeft--;
                } else {
                    timeLeft = 24 * 60 * 60;
                }
            }
            
            updateTimer();
            setInterval(updateTimer, 1000);
        }

        // Format time ago
        function formatTimeAgo(timestamp) {
            const now = new Date();
            const time = timestamp.toDate();
            const diffMs = now - time;
            const diffMins = Math.floor(diffMs / (1000 * 60));
            const diffHrs = Math.floor(diffMs / (1000 * 60 * 60));
            const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));
            
            if (diffMins < 1) return 'Just now';
            if (diffMins < 60) return `${diffMins}m ago`;
            if (diffHrs < 24) return `${diffHrs}h ago`;
            if (diffDays < 7) return `${diffDays}d ago`;
            return time.toLocaleDateString();
        }

        // Debounce function for search
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // Contact information
        function showContactInfo() {
            showToast('Contact UniConnect: 0746676627 | nchagwadennis45@gmail.com', 'info');
        }
    </script>
</body>
</html>
[file content end]